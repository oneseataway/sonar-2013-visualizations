console.log("Box2D");var Box2D={};(function(b,f){if(!(Object.prototype.defineProperty instanceof Function)&&Object.prototype.__defineGetter__ instanceof Function&&Object.prototype.__defineSetter__ instanceof Function){Object.defineProperty=function(j,h,g){if(g.get instanceof Function){j.__defineGetter__(h,g.get)}if(g.set instanceof Function){j.__defineSetter__(h,g.set)}}}function c(){}b.inherit=function(g,h){var j=g;c.prototype=h.prototype;g.prototype=new c;g.prototype.constructor=j};b.generateCallback=function e(h,g){return function(){g.apply(h,arguments)}};b.NVector=function a(j){if(j===f){j=0}var h=new Array(j||0);for(var g=0;g<j;++g){h[g]=0}return h};b.is=function d(h,g){if(h===null){return false}if((g instanceof Function)&&(h instanceof g)){return true}if((h.constructor.__implements!=f)&&(h.constructor.__implements[g])){return true}return false};b.parseUInt=function(g){return Math.abs(parseInt(g))}})(Box2D);var Vector=Array;var Vector_a2j_Number=Box2D.NVector;if(typeof(Box2D)==="undefined"){Box2D={}}if(typeof(Box2D.Collision)==="undefined"){Box2D.Collision={}}if(typeof(Box2D.Collision.Shapes)==="undefined"){Box2D.Collision.Shapes={}}if(typeof(Box2D.Common)==="undefined"){Box2D.Common={}}if(typeof(Box2D.Common.Math)==="undefined"){Box2D.Common.Math={}}if(typeof(Box2D.Dynamics)==="undefined"){Box2D.Dynamics={}}if(typeof(Box2D.Dynamics.Contacts)==="undefined"){Box2D.Dynamics.Contacts={}}if(typeof(Box2D.Dynamics.Controllers)==="undefined"){Box2D.Dynamics.Controllers={}}if(typeof(Box2D.Dynamics.Joints)==="undefined"){Box2D.Dynamics.Joints={}}(function(){Box2D.Collision.IBroadPhase="Box2D.Collision.IBroadPhase";function af(){af.b2AABB.apply(this,arguments)}Box2D.Collision.b2AABB=af;function aC(){aC.b2Bound.apply(this,arguments)}Box2D.Collision.b2Bound=aC;function aR(){aR.b2BoundValues.apply(this,arguments);if(this.constructor===aR){this.b2BoundValues.apply(this,arguments)}}Box2D.Collision.b2BoundValues=aR;function E(){E.b2Collision.apply(this,arguments)}Box2D.Collision.b2Collision=E;function G(){G.b2ContactID.apply(this,arguments);if(this.constructor===G){this.b2ContactID.apply(this,arguments)}}Box2D.Collision.b2ContactID=G;function ak(){ak.b2ContactPoint.apply(this,arguments)}Box2D.Collision.b2ContactPoint=ak;function aH(){aH.b2Distance.apply(this,arguments)}Box2D.Collision.b2Distance=aH;function h(){h.b2DistanceInput.apply(this,arguments)}Box2D.Collision.b2DistanceInput=h;function q(){q.b2DistanceOutput.apply(this,arguments)}Box2D.Collision.b2DistanceOutput=q;function V(){V.b2DistanceProxy.apply(this,arguments)}Box2D.Collision.b2DistanceProxy=V;function n(){n.b2DynamicTree.apply(this,arguments);if(this.constructor===n){this.b2DynamicTree.apply(this,arguments)}}Box2D.Collision.b2DynamicTree=n;function aP(){aP.b2DynamicTreeBroadPhase.apply(this,arguments)}Box2D.Collision.b2DynamicTreeBroadPhase=aP;function aB(){aB.b2DynamicTreeNode.apply(this,arguments)}Box2D.Collision.b2DynamicTreeNode=aB;function T(){T.b2DynamicTreePair.apply(this,arguments)}Box2D.Collision.b2DynamicTreePair=T;function U(){U.b2Manifold.apply(this,arguments);if(this.constructor===U){this.b2Manifold.apply(this,arguments)}}Box2D.Collision.b2Manifold=U;function N(){N.b2ManifoldPoint.apply(this,arguments);if(this.constructor===N){this.b2ManifoldPoint.apply(this,arguments)}}Box2D.Collision.b2ManifoldPoint=N;function X(){X.b2Point.apply(this,arguments)}Box2D.Collision.b2Point=X;function ab(){ab.b2RayCastInput.apply(this,arguments);if(this.constructor===ab){this.b2RayCastInput.apply(this,arguments)}}Box2D.Collision.b2RayCastInput=ab;function o(){o.b2RayCastOutput.apply(this,arguments)}Box2D.Collision.b2RayCastOutput=o;function j(){j.b2Segment.apply(this,arguments)}Box2D.Collision.b2Segment=j;function aF(){aF.b2SeparationFunction.apply(this,arguments)}Box2D.Collision.b2SeparationFunction=aF;function aN(){aN.b2Simplex.apply(this,arguments);if(this.constructor===aN){this.b2Simplex.apply(this,arguments)}}Box2D.Collision.b2Simplex=aN;function C(){C.b2SimplexCache.apply(this,arguments)}Box2D.Collision.b2SimplexCache=C;function aV(){aV.b2SimplexVertex.apply(this,arguments)}Box2D.Collision.b2SimplexVertex=aV;function au(){au.b2TimeOfImpact.apply(this,arguments)}Box2D.Collision.b2TimeOfImpact=au;function aK(){aK.b2TOIInput.apply(this,arguments)}Box2D.Collision.b2TOIInput=aK;function aO(){aO.b2WorldManifold.apply(this,arguments);if(this.constructor===aO){this.b2WorldManifold.apply(this,arguments)}}Box2D.Collision.b2WorldManifold=aO;function aI(){aI.ClipVertex.apply(this,arguments)}Box2D.Collision.ClipVertex=aI;function ad(){ad.Features.apply(this,arguments)}Box2D.Collision.Features=ad;function aS(){aS.b2CircleShape.apply(this,arguments);if(this.constructor===aS){this.b2CircleShape.apply(this,arguments)}}Box2D.Collision.Shapes.b2CircleShape=aS;function e(){e.b2EdgeChainDef.apply(this,arguments);if(this.constructor===e){this.b2EdgeChainDef.apply(this,arguments)}}Box2D.Collision.Shapes.b2EdgeChainDef=e;function aM(){aM.b2EdgeShape.apply(this,arguments);if(this.constructor===aM){this.b2EdgeShape.apply(this,arguments)}}Box2D.Collision.Shapes.b2EdgeShape=aM;function aj(){aj.b2MassData.apply(this,arguments)}Box2D.Collision.Shapes.b2MassData=aj;function aL(){aL.b2PolygonShape.apply(this,arguments);if(this.constructor===aL){this.b2PolygonShape.apply(this,arguments)}}Box2D.Collision.Shapes.b2PolygonShape=aL;function ax(){ax.b2Shape.apply(this,arguments);if(this.constructor===ax){this.b2Shape.apply(this,arguments)}}Box2D.Collision.Shapes.b2Shape=ax;Box2D.Common.b2internal="Box2D.Common.b2internal";function aq(){aq.b2Color.apply(this,arguments);if(this.constructor===aq){this.b2Color.apply(this,arguments)}}Box2D.Common.b2Color=aq;function A(){A.b2Settings.apply(this,arguments)}Box2D.Common.b2Settings=A;function S(){S.b2Mat22.apply(this,arguments);if(this.constructor===S){this.b2Mat22.apply(this,arguments)}}Box2D.Common.Math.b2Mat22=S;function t(){t.b2Mat33.apply(this,arguments);if(this.constructor===t){this.b2Mat33.apply(this,arguments)}}Box2D.Common.Math.b2Mat33=t;function ae(){ae.b2Math.apply(this,arguments)}Box2D.Common.Math.b2Math=ae;function aw(){aw.b2Sweep.apply(this,arguments)}Box2D.Common.Math.b2Sweep=aw;function g(){g.b2Transform.apply(this,arguments);if(this.constructor===g){this.b2Transform.apply(this,arguments)}}Box2D.Common.Math.b2Transform=g;function av(){av.b2Vec2.apply(this,arguments);if(this.constructor===av){this.b2Vec2.apply(this,arguments)}}Box2D.Common.Math.b2Vec2=av;function at(){at.b2Vec3.apply(this,arguments);if(this.constructor===at){this.b2Vec3.apply(this,arguments)}}Box2D.Common.Math.b2Vec3=at;function I(){I.b2Body.apply(this,arguments);if(this.constructor===I){this.b2Body.apply(this,arguments)}}Box2D.Dynamics.b2Body=I;function p(){p.b2BodyDef.apply(this,arguments);if(this.constructor===p){this.b2BodyDef.apply(this,arguments)}}Box2D.Dynamics.b2BodyDef=p;function an(){an.b2ContactFilter.apply(this,arguments)}Box2D.Dynamics.b2ContactFilter=an;function al(){al.b2ContactImpulse.apply(this,arguments)}Box2D.Dynamics.b2ContactImpulse=al;function z(){z.b2ContactListener.apply(this,arguments)}Box2D.Dynamics.b2ContactListener=z;function D(){D.b2ContactManager.apply(this,arguments);if(this.constructor===D){this.b2ContactManager.apply(this,arguments)}}Box2D.Dynamics.b2ContactManager=D;function Q(){Q.b2DebugDraw.apply(this,arguments);if(this.constructor===Q){this.b2DebugDraw.apply(this,arguments)}}Box2D.Dynamics.b2DebugDraw=Q;function a(){a.b2PaperDraw.apply(this,arguments);if(this.constructor===a){this.b2PaperDraw.apply(this,arguments)}}Box2D.Dynamics.b2PaperDraw=a;function F(){F.b2DestructionListener.apply(this,arguments)}Box2D.Dynamics.b2DestructionListener=F;function aD(){aD.b2FilterData.apply(this,arguments)}Box2D.Dynamics.b2FilterData=aD;function aQ(){aQ.b2Fixture.apply(this,arguments);if(this.constructor===aQ){this.b2Fixture.apply(this,arguments)}}Box2D.Dynamics.b2Fixture=aQ;function b(){b.b2FixtureDef.apply(this,arguments);if(this.constructor===b){this.b2FixtureDef.apply(this,arguments)}}Box2D.Dynamics.b2FixtureDef=b;function aT(){aT.b2Island.apply(this,arguments);if(this.constructor===aT){this.b2Island.apply(this,arguments)}}Box2D.Dynamics.b2Island=aT;function w(){w.b2TimeStep.apply(this,arguments)}Box2D.Dynamics.b2TimeStep=w;function u(){u.b2World.apply(this,arguments);if(this.constructor===u){this.b2World.apply(this,arguments)}}Box2D.Dynamics.b2World=u;function f(){f.b2CircleContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2CircleContact=f;function v(){v.b2Contact.apply(this,arguments);if(this.constructor===v){this.b2Contact.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2Contact=v;function O(){O.b2ContactConstraint.apply(this,arguments);if(this.constructor===O){this.b2ContactConstraint.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2ContactConstraint=O;function W(){W.b2ContactConstraintPoint.apply(this,arguments)}Box2D.Dynamics.Contacts.b2ContactConstraintPoint=W;function c(){c.b2ContactEdge.apply(this,arguments)}Box2D.Dynamics.Contacts.b2ContactEdge=c;function aA(){aA.b2ContactFactory.apply(this,arguments);if(this.constructor===aA){this.b2ContactFactory.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2ContactFactory=aA;function m(){m.b2ContactRegister.apply(this,arguments)}Box2D.Dynamics.Contacts.b2ContactRegister=m;function x(){x.b2ContactResult.apply(this,arguments)}Box2D.Dynamics.Contacts.b2ContactResult=x;function Z(){Z.b2ContactSolver.apply(this,arguments);if(this.constructor===Z){this.b2ContactSolver.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2ContactSolver=Z;function aZ(){aZ.b2EdgeAndCircleContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2EdgeAndCircleContact=aZ;function s(){s.b2NullContact.apply(this,arguments);if(this.constructor===s){this.b2NullContact.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2NullContact=s;function az(){az.b2PolyAndCircleContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2PolyAndCircleContact=az;function B(){B.b2PolyAndEdgeContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2PolyAndEdgeContact=B;function Y(){Y.b2PolygonContact.apply(this,arguments)}Box2D.Dynamics.Contacts.b2PolygonContact=Y;function ay(){ay.b2PositionSolverManifold.apply(this,arguments);if(this.constructor===ay){this.b2PositionSolverManifold.apply(this,arguments)}}Box2D.Dynamics.Contacts.b2PositionSolverManifold=ay;function ac(){ac.b2BuoyancyController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2BuoyancyController=ac;function aE(){aE.b2ConstantAccelController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2ConstantAccelController=aE;function k(){k.b2ConstantForceController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2ConstantForceController=k;function ao(){ao.b2Controller.apply(this,arguments)}Box2D.Dynamics.Controllers.b2Controller=ao;function ah(){ah.b2ControllerEdge.apply(this,arguments)}Box2D.Dynamics.Controllers.b2ControllerEdge=ah;function P(){P.b2GravityController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2GravityController=P;function K(){K.b2TensorDampingController.apply(this,arguments)}Box2D.Dynamics.Controllers.b2TensorDampingController=K;function J(){J.b2DistanceJoint.apply(this,arguments);if(this.constructor===J){this.b2DistanceJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2DistanceJoint=J;function aJ(){aJ.b2DistanceJointDef.apply(this,arguments);if(this.constructor===aJ){this.b2DistanceJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2DistanceJointDef=aJ;function r(){r.b2FrictionJoint.apply(this,arguments);if(this.constructor===r){this.b2FrictionJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2FrictionJoint=r;function aY(){aY.b2FrictionJointDef.apply(this,arguments);if(this.constructor===aY){this.b2FrictionJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2FrictionJointDef=aY;function y(){y.b2GearJoint.apply(this,arguments);if(this.constructor===y){this.b2GearJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2GearJoint=y;function M(){M.b2GearJointDef.apply(this,arguments);if(this.constructor===M){this.b2GearJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2GearJointDef=M;function aX(){aX.b2Jacobian.apply(this,arguments)}Box2D.Dynamics.Joints.b2Jacobian=aX;function ai(){ai.b2Joint.apply(this,arguments);if(this.constructor===ai){this.b2Joint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2Joint=ai;function ar(){ar.b2JointDef.apply(this,arguments);if(this.constructor===ar){this.b2JointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2JointDef=ar;function ap(){ap.b2JointEdge.apply(this,arguments)}Box2D.Dynamics.Joints.b2JointEdge=ap;function l(){l.b2LineJoint.apply(this,arguments);if(this.constructor===l){this.b2LineJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2LineJoint=l;function aG(){aG.b2LineJointDef.apply(this,arguments);if(this.constructor===aG){this.b2LineJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2LineJointDef=aG;function aW(){aW.b2MouseJoint.apply(this,arguments);if(this.constructor===aW){this.b2MouseJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2MouseJoint=aW;function L(){L.b2MouseJointDef.apply(this,arguments);if(this.constructor===L){this.b2MouseJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2MouseJointDef=L;function aU(){aU.b2PrismaticJoint.apply(this,arguments);if(this.constructor===aU){this.b2PrismaticJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2PrismaticJoint=aU;function ag(){ag.b2PrismaticJointDef.apply(this,arguments);if(this.constructor===ag){this.b2PrismaticJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2PrismaticJointDef=ag;function a0(){a0.b2PulleyJoint.apply(this,arguments);if(this.constructor===a0){this.b2PulleyJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2PulleyJoint=a0;function aa(){aa.b2PulleyJointDef.apply(this,arguments);if(this.constructor===aa){this.b2PulleyJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2PulleyJointDef=aa;function d(){d.b2RevoluteJoint.apply(this,arguments);if(this.constructor===d){this.b2RevoluteJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2RevoluteJoint=d;function H(){H.b2RevoluteJointDef.apply(this,arguments);if(this.constructor===H){this.b2RevoluteJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2RevoluteJointDef=H;function am(){am.b2WeldJoint.apply(this,arguments);if(this.constructor===am){this.b2WeldJoint.apply(this,arguments)}}Box2D.Dynamics.Joints.b2WeldJoint=am;function R(){R.b2WeldJointDef.apply(this,arguments);if(this.constructor===R){this.b2WeldJointDef.apply(this,arguments)}}Box2D.Dynamics.Joints.b2WeldJointDef=R})();Box2D.postDefs=[];(function(){var x=Box2D.Collision.Shapes.b2CircleShape,P=Box2D.Collision.Shapes.b2EdgeChainDef,U=Box2D.Collision.Shapes.b2EdgeShape,B=Box2D.Collision.Shapes.b2MassData,n=Box2D.Collision.Shapes.b2PolygonShape,j=Box2D.Collision.Shapes.b2Shape,o=Box2D.Common.b2Color,C=Box2D.Common.b2internal,c=Box2D.Common.b2Settings,u=Box2D.Common.Math.b2Mat22,h=Box2D.Common.Math.b2Mat33,m=Box2D.Common.Math.b2Math,p=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,G=Box2D.Common.Math.b2Vec2,E=Box2D.Common.Math.b2Vec3,O=Box2D.Collision.b2AABB,b=Box2D.Collision.b2Bound,D=Box2D.Collision.b2BoundValues,q=Box2D.Collision.b2Collision,I=Box2D.Collision.b2ContactID,s=Box2D.Collision.b2ContactPoint,y=Box2D.Collision.b2Distance,d=Box2D.Collision.b2DistanceInput,z=Box2D.Collision.b2DistanceOutput,S=Box2D.Collision.b2DistanceProxy,w=Box2D.Collision.b2DynamicTree,L=Box2D.Collision.b2DynamicTreeBroadPhase,T=Box2D.Collision.b2DynamicTreeNode,A=Box2D.Collision.b2DynamicTreePair,J=Box2D.Collision.b2Manifold,R=Box2D.Collision.b2ManifoldPoint,r=Box2D.Collision.b2Point,l=Box2D.Collision.b2RayCastInput,v=Box2D.Collision.b2RayCastOutput,K=Box2D.Collision.b2Segment,N=Box2D.Collision.b2SeparationFunction,t=Box2D.Collision.b2Simplex,g=Box2D.Collision.b2SimplexCache,f=Box2D.Collision.b2SimplexVertex,M=Box2D.Collision.b2TimeOfImpact,Q=Box2D.Collision.b2TOIInput,a=Box2D.Collision.b2WorldManifold,k=Box2D.Collision.ClipVertex,H=Box2D.Collision.Features,F=Box2D.Collision.IBroadPhase;O.b2AABB=function(){this.lowerBound=new G();this.upperBound=new G()};O.prototype.IsValid=function(){var W=this.upperBound.x-this.lowerBound.x;var V=this.upperBound.y-this.lowerBound.y;var X=W>=0&&V>=0;X=X&&this.lowerBound.IsValid()&&this.upperBound.IsValid();return X};O.prototype.GetCenter=function(){return new G((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)};O.prototype.GetExtents=function(){return new G((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)};O.prototype.Contains=function(W){var V=true;V=V&&this.lowerBound.x<=W.lowerBound.x;V=V&&this.lowerBound.y<=W.lowerBound.y;V=V&&W.upperBound.x<=this.upperBound.x;V=V&&W.upperBound.y<=this.upperBound.y;return V};O.prototype.RayCast=function(Y,aj){var V=(-Number.MAX_VALUE);var af=Number.MAX_VALUE;var X=aj.p1.x;var W=aj.p1.y;var aa=aj.p2.x-aj.p1.x;var Z=aj.p2.y-aj.p1.y;var ah=Math.abs(aa);var ae=Math.abs(Z);var ai=Y.normal;var ac=0;var ag=0;var ad=0;var ab=0;var ak=0;if(ah<Number.MIN_VALUE){if(X<this.lowerBound.x||this.upperBound.x<X){return false}}else{ac=1/aa;ag=(this.lowerBound.x-X)*ac;ad=(this.upperBound.x-X)*ac;ak=(-1);if(ag>ad){ab=ag;ag=ad;ad=ab;ak=1}if(ag>V){ai.x=ak;ai.y=0;V=ag}af=Math.min(af,ad);if(V>af){return false}}if(ae<Number.MIN_VALUE){if(W<this.lowerBound.y||this.upperBound.y<W){return false}}else{ac=1/Z;ag=(this.lowerBound.y-W)*ac;ad=(this.upperBound.y-W)*ac;ak=(-1);if(ag>ad){ab=ag;ag=ad;ad=ab;ak=1}if(ag>V){ai.y=ak;ai.x=0;V=ag}af=Math.min(af,ad);if(V>af){return false}}Y.fraction=V;return true};O.prototype.TestOverlap=function(V){var X=V.lowerBound.x-this.upperBound.x;var W=V.lowerBound.y-this.upperBound.y;var Z=this.lowerBound.x-V.upperBound.x;var Y=this.lowerBound.y-V.upperBound.y;if(X>0||W>0){return false}if(Z>0||Y>0){return false}return true};O.Combine=function(X,V){var W=new O();W.Combine(X,V);return W};O.prototype.Combine=function(W,V){this.lowerBound.x=Math.min(W.lowerBound.x,V.lowerBound.x);this.lowerBound.y=Math.min(W.lowerBound.y,V.lowerBound.y);this.upperBound.x=Math.max(W.upperBound.x,V.upperBound.x);this.upperBound.y=Math.max(W.upperBound.y,V.upperBound.y)};b.b2Bound=function(){};b.prototype.IsLower=function(){return(this.value&1)==0};b.prototype.IsUpper=function(){return(this.value&1)==1};b.prototype.Swap=function(W){var Y=this.value;var X=this.proxy;var V=this.stabbingCount;this.value=W.value;this.proxy=W.proxy;this.stabbingCount=W.stabbingCount;W.value=Y;W.proxy=X;W.stabbingCount=V};D.b2BoundValues=function(){};D.prototype.b2BoundValues=function(){this.lowerValues=new Vector_a2j_Number();this.lowerValues[0]=0;this.lowerValues[1]=0;this.upperValues=new Vector_a2j_Number();this.upperValues[0]=0;this.upperValues[1]=0};q.b2Collision=function(){};q.ClipSegmentToLine=function(ad,Y,ab,W){if(W===undefined){W=0}var X;var Z=0;X=Y[0];var af=X.v;X=Y[1];var ae=X.v;var ac=ab.x*af.x+ab.y*af.y-W;var aa=ab.x*ae.x+ab.y*ae.y-W;if(ac<=0){ad[Z++].Set(Y[0])}if(aa<=0){ad[Z++].Set(Y[1])}if(ac*aa<0){var ag=ac/(ac-aa);X=ad[Z];var ah=X.v;ah.x=af.x+ag*(ae.x-af.x);ah.y=af.y+ag*(ae.y-af.y);X=ad[Z];var V;if(ac>0){V=Y[0];X.id=V.id}else{V=Y[1];X.id=V.id}++Z}return Z};q.EdgeSeparation=function(ao,X,ap,am,V){if(ap===undefined){ap=0}var ad=parseInt(ao.m_vertexCount);var aa=ao.m_vertices;var au=ao.m_normals;var ac=parseInt(am.m_vertexCount);var Y=am.m_vertices;var ak;var ab;ak=X.R;ab=au[ap];var ag=(ak.col1.x*ab.x+ak.col2.x*ab.y);var af=(ak.col1.y*ab.x+ak.col2.y*ab.y);ak=V.R;var aq=(ak.col1.x*ag+ak.col1.y*af);var an=(ak.col2.x*ag+ak.col2.y*af);var ae=0;var al=Number.MAX_VALUE;for(var at=0;at<ac;++at){ab=Y[at];var ar=ab.x*aq+ab.y*an;if(ar<al){al=ar;ae=at}}ab=aa[ap];ak=X.R;var Z=X.position.x+(ak.col1.x*ab.x+ak.col2.x*ab.y);var W=X.position.y+(ak.col1.y*ab.x+ak.col2.y*ab.y);ab=Y[ae];ak=V.R;var aj=V.position.x+(ak.col1.x*ab.x+ak.col2.x*ab.y);var ah=V.position.y+(ak.col1.y*ab.x+ak.col2.y*ab.y);aj-=Z;ah-=W;var ai=aj*ag+ah*af;return ai};q.FindMaxSeparation=function(ap,ak,X,aj,W){var ag=parseInt(ak.m_vertexCount);var at=ak.m_normals;var Y;var ai;ai=W.R;Y=aj.m_centroid;var ab=W.position.x+(ai.col1.x*Y.x+ai.col2.x*Y.y);var aa=W.position.y+(ai.col1.y*Y.x+ai.col2.y*Y.y);ai=X.R;Y=ak.m_centroid;ab-=X.position.x+(ai.col1.x*Y.x+ai.col2.x*Y.y);aa-=X.position.y+(ai.col1.y*Y.x+ai.col2.y*Y.y);var ad=(ab*X.R.col1.x+aa*X.R.col1.y);var ac=(ab*X.R.col2.x+aa*X.R.col2.y);var af=0;var V=(-Number.MAX_VALUE);for(var ao=0;ao<ag;++ao){Y=at[ao];var am=(Y.x*ad+Y.y*ac);if(am>V){V=am;af=ao}}var al=q.EdgeSeparation(ak,X,af,aj,W);var ae=parseInt(af-1>=0?af-1:ag-1);var aq=q.EdgeSeparation(ak,X,ae,aj,W);var an=parseInt(af+1<ag?af+1:0);var ar=q.EdgeSeparation(ak,X,an,aj,W);var Z=0;var ah=0;var au=0;if(aq>al&&aq>ar){au=(-1);Z=ae;ah=aq}else{if(ar>al){au=1;Z=an;ah=ar}else{ap[0]=af;return al}}while(true){if(au==(-1)){af=Z-1>=0?Z-1:ag-1}else{af=Z+1<ag?Z+1:0}al=q.EdgeSeparation(ak,X,af,aj,W);if(al>ah){Z=af;ah=al}else{break}}ap[0]=Z;return ah};q.FindIncidentEdge=function(ar,ag,W,ah,ae,V){if(ah===undefined){ah=0}var aa=parseInt(ag.m_vertexCount);var aq=ag.m_normals;var Z=parseInt(ae.m_vertexCount);var X=ae.m_vertices;var ap=ae.m_normals;var ac;var Y;ac=W.R;Y=aq[ah];var ai=(ac.col1.x*Y.x+ac.col2.x*Y.y);var af=(ac.col1.y*Y.x+ac.col2.y*Y.y);ac=V.R;var aj=(ac.col1.x*ai+ac.col1.y*af);af=(ac.col2.x*ai+ac.col2.y*af);ai=aj;var ab=0;var ad=Number.MAX_VALUE;for(var ao=0;ao<Z;++ao){Y=ap[ao];var ak=(ai*Y.x+af*Y.y);if(ak<ad){ad=ak;ab=ao}}var al;var an=parseInt(ab);var am=parseInt(an+1<Z?an+1:0);al=ar[0];Y=X[an];ac=V.R;al.v.x=V.position.x+(ac.col1.x*Y.x+ac.col2.x*Y.y);al.v.y=V.position.y+(ac.col1.y*Y.x+ac.col2.y*Y.y);al.id.features.referenceEdge=ah;al.id.features.incidentEdge=an;al.id.features.incidentVertex=0;al=ar[1];Y=X[am];ac=V.R;al.v.x=V.position.x+(ac.col1.x*Y.x+ac.col2.x*Y.y);al.v.y=V.position.y+(ac.col1.y*Y.x+ac.col2.y*Y.y);al.id.features.referenceEdge=ah;al.id.features.incidentEdge=am;al.id.features.incidentVertex=1};q.MakeClipPointVector=function(){var V=new Vector(2);V[0]=new k();V[1]=new k();return V};q.CollidePolygons=function(at,ad,Z,ac,Y){var an;at.m_pointCount=0;var af=ad.m_radius+ac.m_radius;var aK=0;q.s_edgeAO[0]=aK;var aF=q.FindMaxSeparation(q.s_edgeAO,ad,Z,ac,Y);aK=q.s_edgeAO[0];if(aF>af){return}var aJ=0;q.s_edgeBO[0]=aJ;var aD=q.FindMaxSeparation(q.s_edgeBO,ac,Y,ad,Z);aJ=q.s_edgeBO[0];if(aD>af){return}var am;var al;var ak;var ai;var V=0;var aO=0;var X=0.98;var aL=0.001;var aI;if(aD>X*aF+aL){am=ac;al=ad;ak=Y;ai=Z;V=aJ;at.m_type=J.e_faceB;aO=1}else{am=ad;al=ac;ak=Z;ai=Y;V=aK;at.m_type=J.e_faceA;aO=0}var W=q.s_incidentEdge;q.FindIncidentEdge(W,am,ak,V,al,ai);var az=parseInt(am.m_vertexCount);var ap=am.m_vertices;var ah=ap[V];var ag;if(V+1<az){ag=ap[parseInt(V+1)]}else{ag=ap[0]}var ay=q.s_localTangent;ay.Set(ag.x-ah.x,ag.y-ah.y);ay.Normalize();var ar=q.s_localNormal;ar.x=ay.y;ar.y=(-ay.x);var aB=q.s_planePoint;aB.Set(0.5*(ah.x+ag.x),0.5*(ah.y+ag.y));var aC=q.s_tangent;aI=ak.R;aC.x=(aI.col1.x*ay.x+aI.col2.x*ay.y);aC.y=(aI.col1.y*ay.x+aI.col2.y*ay.y);var ae=q.s_tangent2;ae.x=(-aC.x);ae.y=(-aC.y);var aE=q.s_normal;aE.x=aC.y;aE.y=(-aC.x);var aH=q.s_v11;var aG=q.s_v12;aH.x=ak.position.x+(aI.col1.x*ah.x+aI.col2.x*ah.y);aH.y=ak.position.y+(aI.col1.y*ah.x+aI.col2.y*ah.y);aG.x=ak.position.x+(aI.col1.x*ag.x+aI.col2.x*ag.y);aG.y=ak.position.y+(aI.col1.y*ag.x+aI.col2.y*ag.y);var aA=aE.x*aH.x+aE.y*aH.y;var ax=(-aC.x*aH.x)-aC.y*aH.y+af;var aw=aC.x*aG.x+aC.y*aG.y+af;var av=q.s_clipPoints1;var au=q.s_clipPoints2;var aN=0;aN=q.ClipSegmentToLine(av,W,ae,ax);if(aN<2){return}aN=q.ClipSegmentToLine(au,av,aC,aw);if(aN<2){return}at.m_localPlaneNormal.SetV(ar);at.m_localPoint.SetV(aB);var ao=0;for(var aM=0;aM<c.b2_maxManifoldPoints;++aM){an=au[aM];var aj=aE.x*an.v.x+aE.y*an.v.y-aA;if(aj<=af){var aq=at.m_points[ao];aI=ai.R;var ab=an.v.x-ai.position.x;var aa=an.v.y-ai.position.y;aq.m_localPoint.x=(ab*aI.col1.x+aa*aI.col1.y);aq.m_localPoint.y=(ab*aI.col2.x+aa*aI.col2.y);aq.m_id.Set(an.id);aq.m_id.features.flip=aO;++ao}}at.m_pointCount=ao};q.CollideCircles=function(aa,ac,ae,Z,ad){aa.m_pointCount=0;var ah;var aj;ah=ae.R;aj=ac.m_p;var af=ae.position.x+(ah.col1.x*aj.x+ah.col2.x*aj.y);var ab=ae.position.y+(ah.col1.y*aj.x+ah.col2.y*aj.y);ah=ad.R;aj=Z.m_p;var W=ad.position.x+(ah.col1.x*aj.x+ah.col2.x*aj.y);var V=ad.position.y+(ah.col1.y*aj.x+ah.col2.y*aj.y);var Y=W-af;var X=V-ab;var ai=Y*Y+X*X;var ag=ac.m_radius+Z.m_radius;if(ai>ag*ag){return}aa.m_type=J.e_circles;aa.m_localPoint.SetV(ac.m_p);aa.m_localPlaneNormal.SetZero();aa.m_pointCount=1;aa.m_points[0].m_localPoint.SetV(Z.m_p);aa.m_points[0].m_id.key=0};q.CollidePolygonAndCircle=function(au,an,Y,ag,X){au.m_pointCount=0;var af;var ad=0;var ac=0;var aC=0;var aB=0;var ab;var al;al=X.R;ab=ag.m_p;var az=X.position.x+(al.col1.x*ab.x+al.col2.x*ab.y);var ay=X.position.y+(al.col1.y*ab.x+al.col2.y*ab.y);ad=az-Y.position.x;ac=ay-Y.position.y;al=Y.R;var ar=(ad*al.col1.x+ac*al.col1.y);var ap=(ad*al.col2.x+ac*al.col2.y);var at=0;var aA=0;var ak=(-Number.MAX_VALUE);var ae=an.m_radius+ag.m_radius;var am=parseInt(an.m_vertexCount);var ah=an.m_vertices;var aq=an.m_normals;for(var aw=0;aw<am;++aw){ab=ah[aw];ad=ar-ab.x;ac=ap-ab.y;ab=aq[aw];var ao=ab.x*ad+ab.y*ac;if(ao>ae){return}if(ao>ak){ak=ao;aA=aw}}var W=parseInt(aA);var V=parseInt(W+1<am?W+1:0);var aa=ah[W];var Z=ah[V];if(ak<Number.MIN_VALUE){au.m_pointCount=1;au.m_type=J.e_faceA;au.m_localPlaneNormal.SetV(aq[aA]);au.m_localPoint.x=0.5*(aa.x+Z.x);au.m_localPoint.y=0.5*(aa.y+Z.y);au.m_points[0].m_localPoint.SetV(ag.m_p);au.m_points[0].m_id.key=0;return}var ax=(ar-aa.x)*(Z.x-aa.x)+(ap-aa.y)*(Z.y-aa.y);var av=(ar-Z.x)*(aa.x-Z.x)+(ap-Z.y)*(aa.y-Z.y);if(ax<=0){if((ar-aa.x)*(ar-aa.x)+(ap-aa.y)*(ap-aa.y)>ae*ae){return}au.m_pointCount=1;au.m_type=J.e_faceA;au.m_localPlaneNormal.x=ar-aa.x;au.m_localPlaneNormal.y=ap-aa.y;au.m_localPlaneNormal.Normalize();au.m_localPoint.SetV(aa);au.m_points[0].m_localPoint.SetV(ag.m_p);au.m_points[0].m_id.key=0}else{if(av<=0){if((ar-Z.x)*(ar-Z.x)+(ap-Z.y)*(ap-Z.y)>ae*ae){return}au.m_pointCount=1;au.m_type=J.e_faceA;au.m_localPlaneNormal.x=ar-Z.x;au.m_localPlaneNormal.y=ap-Z.y;au.m_localPlaneNormal.Normalize();au.m_localPoint.SetV(Z);au.m_points[0].m_localPoint.SetV(ag.m_p);au.m_points[0].m_id.key=0}else{var aj=0.5*(aa.x+Z.x);var ai=0.5*(aa.y+Z.y);ak=(ar-aj)*aq[W].x+(ap-ai)*aq[W].y;if(ak>ae){return}au.m_pointCount=1;au.m_type=J.e_faceA;au.m_localPlaneNormal.x=aq[W].x;au.m_localPlaneNormal.y=aq[W].y;au.m_localPlaneNormal.Normalize();au.m_localPoint.Set(aj,ai);au.m_points[0].m_localPoint.SetV(ag.m_p);au.m_points[0].m_id.key=0}}};q.TestOverlap=function(W,V){var ab=V.lowerBound;var Z=W.upperBound;var Y=ab.x-Z.x;var X=ab.y-Z.y;ab=W.lowerBound;Z=V.upperBound;var ac=ab.x-Z.x;var aa=ab.y-Z.y;if(Y>0||X>0){return false}if(ac>0||aa>0){return false}return true};Box2D.postDefs.push(function(){Box2D.Collision.b2Collision.s_incidentEdge=q.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints1=q.MakeClipPointVector();Box2D.Collision.b2Collision.s_clipPoints2=q.MakeClipPointVector();Box2D.Collision.b2Collision.s_edgeAO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_edgeBO=new Vector_a2j_Number(1);Box2D.Collision.b2Collision.s_localTangent=new G();Box2D.Collision.b2Collision.s_localNormal=new G();Box2D.Collision.b2Collision.s_planePoint=new G();Box2D.Collision.b2Collision.s_normal=new G();Box2D.Collision.b2Collision.s_tangent=new G();Box2D.Collision.b2Collision.s_tangent2=new G();Box2D.Collision.b2Collision.s_v11=new G();Box2D.Collision.b2Collision.s_v12=new G();Box2D.Collision.b2Collision.b2CollidePolyTempVec=new G();Box2D.Collision.b2Collision.b2_nullFeature=255});I.b2ContactID=function(){this.features=new H()};I.prototype.b2ContactID=function(){this.features._m_id=this};I.prototype.Set=function(V){this.key=V._key};I.prototype.Copy=function(){var V=new I();V.key=this.key;return V};Object.defineProperty(I.prototype,"key",{enumerable:false,configurable:true,get:function(){return this._key}});Object.defineProperty(I.prototype,"key",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._key=V;this.features._referenceEdge=this._key&255;this.features._incidentEdge=((this._key&65280)>>8)&255;this.features._incidentVertex=((this._key&16711680)>>16)&255;this.features._flip=((this._key&4278190080)>>24)&255}});s.b2ContactPoint=function(){this.position=new G();this.velocity=new G();this.normal=new G();this.id=new I()};y.b2Distance=function(){};y.Distance=function(ab,aj,ah){++y.b2_gjkCalls;var ar=ah.proxyA;var ap=ah.proxyB;var ag=ah.transformA;var af=ah.transformB;var ae=y.s_simplex;ae.ReadCache(aj,ar,ag,ap,af);var Z=ae.m_vertices;var ad=20;var am=y.s_saveA;var al=y.s_saveB;var ai=0;var Y=ae.GetClosestPoint();var X=Y.LengthSquared();var W=X;var ao=0;var ak;var an=0;while(an<ad){ai=ae.m_count;for(ao=0;ao<ai;ao++){am[ao]=Z[ao].indexA;al[ao]=Z[ao].indexB}switch(ae.m_count){case 1:break;case 2:ae.Solve2();break;case 3:ae.Solve3();break;default:c.b2Assert(false)}if(ae.m_count==3){break}ak=ae.GetClosestPoint();W=ak.LengthSquared();if(W>X){}X=W;var at=ae.GetSearchDirection();if(at.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE){break}var aq=Z[ae.m_count];aq.indexA=ar.GetSupport(m.MulTMV(ag.R,at.GetNegative()));aq.wA=m.MulX(ag,ar.GetVertex(aq.indexA));aq.indexB=ap.GetSupport(m.MulTMV(af.R,at));aq.wB=m.MulX(af,ap.GetVertex(aq.indexB));aq.w=m.SubtractVV(aq.wB,aq.wA);++an;++y.b2_gjkIters;var V=false;for(ao=0;ao<ai;ao++){if(aq.indexA==am[ao]&&aq.indexB==al[ao]){V=true;break}}if(V){break}++ae.m_count}y.b2_gjkMaxIters=m.Max(y.b2_gjkMaxIters,an);ae.GetWitnessPoints(ab.pointA,ab.pointB);ab.distance=m.SubtractVV(ab.pointA,ab.pointB).Length();ab.iterations=an;ae.WriteCache(aj);if(ah.useRadii){var ac=ar.m_radius;var aa=ap.m_radius;if(ab.distance>ac+aa&&ab.distance>Number.MIN_VALUE){ab.distance-=ac+aa;var au=m.SubtractVV(ab.pointB,ab.pointA);au.Normalize();ab.pointA.x+=ac*au.x;ab.pointA.y+=ac*au.y;ab.pointB.x-=aa*au.x;ab.pointB.y-=aa*au.y}else{ak=new G();ak.x=0.5*(ab.pointA.x+ab.pointB.x);ak.y=0.5*(ab.pointA.y+ab.pointB.y);ab.pointA.x=ab.pointB.x=ak.x;ab.pointA.y=ab.pointB.y=ak.y;ab.distance=0}}};Box2D.postDefs.push(function(){Box2D.Collision.b2Distance.s_simplex=new t();Box2D.Collision.b2Distance.s_saveA=new Vector_a2j_Number(3);Box2D.Collision.b2Distance.s_saveB=new Vector_a2j_Number(3)});d.b2DistanceInput=function(){};z.b2DistanceOutput=function(){this.pointA=new G();this.pointB=new G()};S.b2DistanceProxy=function(){};S.prototype.Set=function(V){switch(V.GetType()){case j.e_circleShape:var X=(V instanceof x?V:null);this.m_vertices=new Vector(1,true);this.m_vertices[0]=X.m_p;this.m_count=1;this.m_radius=X.m_radius;break;case j.e_polygonShape:var W=(V instanceof n?V:null);this.m_vertices=W.m_vertices;this.m_count=W.m_vertexCount;this.m_radius=W.m_radius;break;default:c.b2Assert(false)}};S.prototype.GetSupport=function(Z){var W=0;var Y=this.m_vertices[0].x*Z.x+this.m_vertices[0].y*Z.y;for(var V=1;V<this.m_count;++V){var X=this.m_vertices[V].x*Z.x+this.m_vertices[V].y*Z.y;if(X>Y){W=V;Y=X}}return W};S.prototype.GetSupportVertex=function(Z){var W=0;var Y=this.m_vertices[0].x*Z.x+this.m_vertices[0].y*Z.y;for(var V=1;V<this.m_count;++V){var X=this.m_vertices[V].x*Z.x+this.m_vertices[V].y*Z.y;if(X>Y){W=V;Y=X}}return this.m_vertices[W]};S.prototype.GetVertexCount=function(){return this.m_count};S.prototype.GetVertex=function(V){if(V===undefined){V=0}c.b2Assert(0<=V&&V<this.m_count);return this.m_vertices[V]};w.b2DynamicTree=function(){};w.prototype.b2DynamicTree=function(){this.m_root=null;this.m_freeList=null;this.m_path=0;this.m_insertionCount=0};w.prototype.CreateProxy=function(Y,W){var Z=this.AllocateNode();var X=c.b2_aabbExtension;var V=c.b2_aabbExtension;Z.aabb.lowerBound.x=Y.lowerBound.x-X;Z.aabb.lowerBound.y=Y.lowerBound.y-V;Z.aabb.upperBound.x=Y.upperBound.x+X;Z.aabb.upperBound.y=Y.upperBound.y+V;Z.userData=W;this.InsertLeaf(Z);return Z};w.prototype.DestroyProxy=function(V){this.RemoveLeaf(V);this.FreeNode(V)};w.prototype.MoveProxy=function(Z,X,Y){c.b2Assert(Z.IsLeaf());if(Z.aabb.Contains(X)){return false}this.RemoveLeaf(Z);var W=c.b2_aabbExtension+c.b2_aabbMultiplier*(Y.x>0?Y.x:(-Y.x));var V=c.b2_aabbExtension+c.b2_aabbMultiplier*(Y.y>0?Y.y:(-Y.y));Z.aabb.lowerBound.x=X.lowerBound.x-W;Z.aabb.lowerBound.y=X.lowerBound.y-V;Z.aabb.upperBound.x=X.upperBound.x+W;Z.aabb.upperBound.y=X.upperBound.y+V;this.InsertLeaf(Z);return true};w.prototype.Rebalance=function(X){if(X===undefined){X=0}if(this.m_root==null){return}for(var V=0;V<X;V++){var W=this.m_root;var Y=0;while(W.IsLeaf()==false){W=(this.m_path>>Y)&1?W.child2:W.child1;Y=(Y+1)&31}++this.m_path;this.RemoveLeaf(W);this.InsertLeaf(W)}};w.prototype.GetFatAABB=function(V){return V.aabb};w.prototype.GetUserData=function(V){return V.userData};w.prototype.Query=function(aa,W){if(this.m_root==null){return}var V=new Vector();var Z=0;V[Z++]=this.m_root;while(Z>0){var Y=V[--Z];if(Y.aabb.TestOverlap(W)){if(Y.IsLeaf()){var X=aa(Y);if(!X){return}}else{V[Z++]=Y.child1;V[Z++]=Y.child2}}}};w.prototype.RayCast=function(Z,ae){if(this.m_root==null){return}var Y=ae.p1;var W=ae.p2;var af=m.SubtractVV(Y,W);af.Normalize();var ad=m.CrossFV(1,af);var al=m.AbsV(ad);var ai=ae.maxFraction;var X=new O();var ah=0;var ag=0;ah=Y.x+ai*(W.x-Y.x);ag=Y.y+ai*(W.y-Y.y);X.lowerBound.x=Math.min(Y.x,ah);X.lowerBound.y=Math.min(Y.y,ag);X.upperBound.x=Math.max(Y.x,ah);X.upperBound.y=Math.max(Y.y,ag);var aa=new Vector();var ab=0;aa[ab++]=this.m_root;while(ab>0){var aj=aa[--ab];if(aj.aabb.TestOverlap(X)==false){continue}var am=aj.aabb.GetCenter();var ak=aj.aabb.GetExtents();var ac=Math.abs(ad.x*(Y.x-am.x)+ad.y*(Y.y-am.y))-al.x*ak.x-al.y*ak.y;if(ac>0){continue}if(aj.IsLeaf()){var V=new l();V.p1=ae.p1;V.p2=ae.p2;V.maxFraction=ae.maxFraction;ai=Z(V,aj);if(ai==0){return}if(ai>0){ah=Y.x+ai*(W.x-Y.x);ag=Y.y+ai*(W.y-Y.y);X.lowerBound.x=Math.min(Y.x,ah);X.lowerBound.y=Math.min(Y.y,ag);X.upperBound.x=Math.max(Y.x,ah);X.upperBound.y=Math.max(Y.y,ag)}}else{aa[ab++]=aj.child1;aa[ab++]=aj.child2}}};w.prototype.AllocateNode=function(){if(this.m_freeList){var V=this.m_freeList;this.m_freeList=V.parent;V.parent=null;V.child1=null;V.child2=null;return V}return new T()};w.prototype.FreeNode=function(V){V.parent=this.m_freeList;this.m_freeList=V};w.prototype.InsertLeaf=function(aa){++this.m_insertionCount;if(this.m_root==null){this.m_root=aa;this.m_root.parent=null;return}var V=aa.aabb.GetCenter();var ab=this.m_root;if(ab.IsLeaf()==false){do{var Z=ab.child1;var Y=ab.child2;var X=Math.abs((Z.aabb.lowerBound.x+Z.aabb.upperBound.x)/2-V.x)+Math.abs((Z.aabb.lowerBound.y+Z.aabb.upperBound.y)/2-V.y);var W=Math.abs((Y.aabb.lowerBound.x+Y.aabb.upperBound.x)/2-V.x)+Math.abs((Y.aabb.lowerBound.y+Y.aabb.upperBound.y)/2-V.y);if(X<W){ab=Z}else{ab=Y}}while(ab.IsLeaf()==false)}var ad=ab.parent;var ac=this.AllocateNode();ac.parent=ad;ac.userData=null;ac.aabb.Combine(aa.aabb,ab.aabb);if(ad){if(ab.parent.child1==ab){ad.child1=ac}else{ad.child2=ac}ac.child1=ab;ac.child2=aa;ab.parent=ac;aa.parent=ac;do{if(ad.aabb.Contains(ac.aabb)){break}ad.aabb.Combine(ad.child1.aabb,ad.child2.aabb);ac=ad;ad=ad.parent}while(ad)}else{ac.child1=ab;ac.child2=aa;ab.parent=ac;aa.parent=ac;this.m_root=ac}};w.prototype.RemoveLeaf=function(X){if(X==this.m_root){this.m_root=null;return}var W=X.parent;var Y=W.parent;var Z;if(W.child1==X){Z=W.child2}else{Z=W.child1}if(Y){if(Y.child1==W){Y.child1=Z}else{Y.child2=Z}Z.parent=Y;this.FreeNode(W);while(Y){var V=Y.aabb;Y.aabb=O.Combine(Y.child1.aabb,Y.child2.aabb);if(V.Contains(Y.aabb)){break}Y=Y.parent}}else{this.m_root=Z;Z.parent=null;this.FreeNode(W)}};L.b2DynamicTreeBroadPhase=function(){this.m_tree=new w();this.m_moveBuffer=new Vector();this.m_pairBuffer=new Vector();this.m_pairCount=0};L.prototype.CreateProxy=function(W,V){var X=this.m_tree.CreateProxy(W,V);++this.m_proxyCount;this.BufferMove(X);return X};L.prototype.DestroyProxy=function(V){this.UnBufferMove(V);--this.m_proxyCount;this.m_tree.DestroyProxy(V)};L.prototype.MoveProxy=function(Y,W,X){var V=this.m_tree.MoveProxy(Y,W,X);if(V){this.BufferMove(Y)}};L.prototype.TestOverlap=function(W,V){var Y=this.m_tree.GetFatAABB(W);var X=this.m_tree.GetFatAABB(V);return Y.TestOverlap(X)};L.prototype.GetUserData=function(V){return this.m_tree.GetUserData(V)};L.prototype.GetFatAABB=function(V){return this.m_tree.GetFatAABB(V)};L.prototype.GetProxyCount=function(){return this.m_proxyCount};L.prototype.UpdatePairs=function(ae){var ad=this;ad.m_pairCount=0;var ac=0,Y;for(ac=0;ac<ad.m_moveBuffer.length;++ac){Y=ad.m_moveBuffer[ac];function V(af){if(af==Y){return true}if(ad.m_pairCount==ad.m_pairBuffer.length){ad.m_pairBuffer[ad.m_pairCount]=new A()}var ag=ad.m_pairBuffer[ad.m_pairCount];ag.proxyA=af<Y?af:Y;ag.proxyB=af>=Y?af:Y;++ad.m_pairCount;return true}var aa=ad.m_tree.GetFatAABB(Y);ad.m_tree.Query(V,aa)}ad.m_moveBuffer.length=0;for(var ac=0;ac<ad.m_pairCount;){var W=ad.m_pairBuffer[ac];var Z=ad.m_tree.GetUserData(W.proxyA);var X=ad.m_tree.GetUserData(W.proxyB);ae(Z,X);++ac;while(ac<ad.m_pairCount){var ab=ad.m_pairBuffer[ac];if(ab.proxyA!=W.proxyA||ab.proxyB!=W.proxyB){break}++ac}}};L.prototype.Query=function(W,V){this.m_tree.Query(W,V)};L.prototype.RayCast=function(W,V){this.m_tree.RayCast(W,V)};L.prototype.Validate=function(){};L.prototype.Rebalance=function(V){if(V===undefined){V=0}this.m_tree.Rebalance(V)};L.prototype.BufferMove=function(V){this.m_moveBuffer[this.m_moveBuffer.length]=V};L.prototype.UnBufferMove=function(W){var V=parseInt(this.m_moveBuffer.indexOf(W));this.m_moveBuffer.splice(V,1)};L.prototype.ComparePairs=function(W,V){return 0};L.__implements={};L.__implements[F]=true;T.b2DynamicTreeNode=function(){this.aabb=new O()};T.prototype.IsLeaf=function(){return this.child1==null};A.b2DynamicTreePair=function(){};J.b2Manifold=function(){this.m_pointCount=0};J.prototype.b2Manifold=function(){this.m_points=new Vector(c.b2_maxManifoldPoints);for(var V=0;V<c.b2_maxManifoldPoints;V++){this.m_points[V]=new R()}this.m_localPlaneNormal=new G();this.m_localPoint=new G()};J.prototype.Reset=function(){for(var V=0;V<c.b2_maxManifoldPoints;V++){((this.m_points[V] instanceof R?this.m_points[V]:null)).Reset()}this.m_localPlaneNormal.SetZero();this.m_localPoint.SetZero();this.m_type=0;this.m_pointCount=0};J.prototype.Set=function(V){this.m_pointCount=V.m_pointCount;for(var W=0;W<c.b2_maxManifoldPoints;W++){((this.m_points[W] instanceof R?this.m_points[W]:null)).Set(V.m_points[W])}this.m_localPlaneNormal.SetV(V.m_localPlaneNormal);this.m_localPoint.SetV(V.m_localPoint);this.m_type=V.m_type};J.prototype.Copy=function(){var V=new J();V.Set(this);return V};Box2D.postDefs.push(function(){Box2D.Collision.b2Manifold.e_circles=1;Box2D.Collision.b2Manifold.e_faceA=2;Box2D.Collision.b2Manifold.e_faceB=4});R.b2ManifoldPoint=function(){this.m_localPoint=new G();this.m_id=new I()};R.prototype.b2ManifoldPoint=function(){this.Reset()};R.prototype.Reset=function(){this.m_localPoint.SetZero();this.m_normalImpulse=0;this.m_tangentImpulse=0;this.m_id.key=0};R.prototype.Set=function(V){this.m_localPoint.SetV(V.m_localPoint);this.m_normalImpulse=V.m_normalImpulse;this.m_tangentImpulse=V.m_tangentImpulse;this.m_id.Set(V.m_id)};r.b2Point=function(){this.p=new G()};r.prototype.Support=function(X,W,V){if(W===undefined){W=0}if(V===undefined){V=0}return this.p};r.prototype.GetFirstVertex=function(V){return this.p};l.b2RayCastInput=function(){this.p1=new G();this.p2=new G()};l.prototype.b2RayCastInput=function(X,W,V){if(X===undefined){X=null}if(W===undefined){W=null}if(V===undefined){V=1}if(X){this.p1.SetV(X)}if(W){this.p2.SetV(W)}this.maxFraction=V};v.b2RayCastOutput=function(){this.normal=new G()};K.b2Segment=function(){this.p1=new G();this.p2=new G()};K.prototype.TestSegment=function(ad,al,X,ah){if(ah===undefined){ah=0}var ae=X.p1;var ak=X.p2.x-ae.x;var ai=X.p2.y-ae.y;var Z=this.p2.x-this.p1.x;var Y=this.p2.y-this.p1.y;var ag=Y;var af=(-Z);var am=100*Number.MIN_VALUE;var W=(-(ak*ag+ai*af));if(W>am){var ac=ae.x-this.p1.x;var ab=ae.y-this.p1.y;var aj=(ac*ag+ab*af);if(0<=aj&&aj<=ah*W){var V=(-ak*ab)+ai*ac;if((-am*W)<=V&&V<=W*(1+am)){aj/=W;var aa=Math.sqrt(ag*ag+af*af);ag/=aa;af/=aa;ad[0]=aj;al.Set(ag,af);return true}}}return false};K.prototype.Extend=function(V){this.ExtendForward(V);this.ExtendBackward(V)};K.prototype.ExtendForward=function(X){var W=this.p2.x-this.p1.x;var V=this.p2.y-this.p1.y;var Y=Math.min(W>0?(X.upperBound.x-this.p1.x)/W:W<0?(X.lowerBound.x-this.p1.x)/W:Number.POSITIVE_INFINITY,V>0?(X.upperBound.y-this.p1.y)/V:V<0?(X.lowerBound.y-this.p1.y)/V:Number.POSITIVE_INFINITY);this.p2.x=this.p1.x+W*Y;this.p2.y=this.p1.y+V*Y};K.prototype.ExtendBackward=function(X){var W=(-this.p2.x)+this.p1.x;var V=(-this.p2.y)+this.p1.y;var Y=Math.min(W>0?(X.upperBound.x-this.p2.x)/W:W<0?(X.lowerBound.x-this.p2.x)/W:Number.POSITIVE_INFINITY,V>0?(X.upperBound.y-this.p2.y)/V:V<0?(X.lowerBound.y-this.p2.y)/V:Number.POSITIVE_INFINITY);this.p1.x=this.p2.x+W*Y;this.p1.y=this.p2.y+V*Y};N.b2SeparationFunction=function(){this.m_localPoint=new G();this.m_axis=new G()};N.prototype.Initialize=function(am,aw,ah,av,ag){this.m_proxyA=aw;this.m_proxyB=av;var ab=parseInt(am.count);c.b2Assert(0<ab&&ab<3);var aj;var aa;var Z;var ai;var ap;var ao;var aD=0;var aC=0;var ae=0;var ac=0;var Y=0;var X=0;var af;var W;var al=0;var ad=0;if(ab==1){this.m_type=N.e_points;aj=this.m_proxyA.GetVertex(am.indexA[0]);ai=this.m_proxyB.GetVertex(am.indexB[0]);W=aj;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=ai;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);this.m_axis.x=ae-aD;this.m_axis.y=ac-aC;this.m_axis.Normalize()}else{if(am.indexB[0]==am.indexB[1]){this.m_type=N.e_faceA;aa=this.m_proxyA.GetVertex(am.indexA[0]);Z=this.m_proxyA.GetVertex(am.indexA[1]);ai=this.m_proxyB.GetVertex(am.indexB[0]);this.m_localPoint.x=0.5*(aa.x+Z.x);this.m_localPoint.y=0.5*(aa.y+Z.y);this.m_axis=m.CrossVF(m.SubtractVV(Z,aa),1);this.m_axis.Normalize();W=this.m_axis;af=ah.R;Y=af.col1.x*W.x+af.col2.x*W.y;X=af.col1.y*W.x+af.col2.y*W.y;W=this.m_localPoint;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=ai;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);al=(ae-aD)*Y+(ac-aC)*X;if(al<0){this.m_axis.NegativeSelf()}}else{if(am.indexA[0]==am.indexA[0]){this.m_type=N.e_faceB;ap=this.m_proxyB.GetVertex(am.indexB[0]);ao=this.m_proxyB.GetVertex(am.indexB[1]);aj=this.m_proxyA.GetVertex(am.indexA[0]);this.m_localPoint.x=0.5*(ap.x+ao.x);this.m_localPoint.y=0.5*(ap.y+ao.y);this.m_axis=m.CrossVF(m.SubtractVV(ao,ap),1);this.m_axis.Normalize();W=this.m_axis;af=ag.R;Y=af.col1.x*W.x+af.col2.x*W.y;X=af.col1.y*W.x+af.col2.y*W.y;W=this.m_localPoint;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=aj;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);al=(aD-ae)*Y+(aC-ac)*X;if(al<0){this.m_axis.NegativeSelf()}}else{aa=this.m_proxyA.GetVertex(am.indexA[0]);Z=this.m_proxyA.GetVertex(am.indexA[1]);ap=this.m_proxyB.GetVertex(am.indexB[0]);ao=this.m_proxyB.GetVertex(am.indexB[1]);var au=m.MulX(ah,aj);var ar=m.MulMV(ah.R,m.SubtractVV(Z,aa));var at=m.MulX(ag,ai);var aq=m.MulMV(ag.R,m.SubtractVV(ao,ap));var aB=ar.x*ar.x+ar.y*ar.y;var ay=aq.x*aq.x+aq.y*aq.y;var an=m.SubtractVV(aq,ar);var az=ar.x*an.x+ar.y*an.y;var ax=aq.x*an.x+aq.y*an.y;var aA=ar.x*aq.x+ar.y*aq.y;var V=aB*ay-aA*aA;al=0;if(V!=0){al=m.Clamp((aA*ax-az*ay)/V,0,1)}var ak=(aA*al+ax)/ay;if(ak<0){ak=0;al=m.Clamp((aA-az)/aB,0,1)}aj=new G();aj.x=aa.x+al*(Z.x-aa.x);aj.y=aa.y+al*(Z.y-aa.y);ai=new G();ai.x=ap.x+al*(ao.x-ap.x);ai.y=ap.y+al*(ao.y-ap.y);if(al==0||al==1){this.m_type=N.e_faceB;this.m_axis=m.CrossVF(m.SubtractVV(ao,ap),1);this.m_axis.Normalize();this.m_localPoint=ai;W=this.m_axis;af=ag.R;Y=af.col1.x*W.x+af.col2.x*W.y;X=af.col1.y*W.x+af.col2.y*W.y;W=this.m_localPoint;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=aj;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);ad=(aD-ae)*Y+(aC-ac)*X;if(al<0){this.m_axis.NegativeSelf()}}else{this.m_type=N.e_faceA;this.m_axis=m.CrossVF(m.SubtractVV(Z,aa),1);this.m_localPoint=aj;W=this.m_axis;af=ah.R;Y=af.col1.x*W.x+af.col2.x*W.y;X=af.col1.y*W.x+af.col2.y*W.y;W=this.m_localPoint;af=ah.R;aD=ah.position.x+(af.col1.x*W.x+af.col2.x*W.y);aC=ah.position.y+(af.col1.y*W.x+af.col2.y*W.y);W=ai;af=ag.R;ae=ag.position.x+(af.col1.x*W.x+af.col2.x*W.y);ac=ag.position.y+(af.col1.y*W.x+af.col2.y*W.y);ad=(ae-aD)*Y+(ac-aC)*X;if(al<0){this.m_axis.NegativeSelf()}}}}}};N.prototype.Evaluate=function(ad,ac){var X;var W;var aa;var Z;var V;var ae;var Y=0;var ab;switch(this.m_type){case N.e_points:X=m.MulTMV(ad.R,this.m_axis);W=m.MulTMV(ac.R,this.m_axis.GetNegative());aa=this.m_proxyA.GetSupportVertex(X);Z=this.m_proxyB.GetSupportVertex(W);V=m.MulX(ad,aa);ae=m.MulX(ac,Z);Y=(ae.x-V.x)*this.m_axis.x+(ae.y-V.y)*this.m_axis.y;return Y;case N.e_faceA:ab=m.MulMV(ad.R,this.m_axis);V=m.MulX(ad,this.m_localPoint);W=m.MulTMV(ac.R,ab.GetNegative());Z=this.m_proxyB.GetSupportVertex(W);ae=m.MulX(ac,Z);Y=(ae.x-V.x)*ab.x+(ae.y-V.y)*ab.y;return Y;case N.e_faceB:ab=m.MulMV(ac.R,this.m_axis);ae=m.MulX(ac,this.m_localPoint);X=m.MulTMV(ad.R,ab.GetNegative());aa=this.m_proxyA.GetSupportVertex(X);V=m.MulX(ad,aa);Y=(V.x-ae.x)*ab.x+(V.y-ae.y)*ab.y;return Y;default:c.b2Assert(false);return 0}};Box2D.postDefs.push(function(){Box2D.Collision.b2SeparationFunction.e_points=1;Box2D.Collision.b2SeparationFunction.e_faceA=2;Box2D.Collision.b2SeparationFunction.e_faceB=4});t.b2Simplex=function(){this.m_v1=new f();this.m_v2=new f();this.m_v3=new f();this.m_vertices=new Vector(3)};t.prototype.b2Simplex=function(){this.m_vertices[0]=this.m_v1;this.m_vertices[1]=this.m_v2;this.m_vertices[2]=this.m_v3};t.prototype.ReadCache=function(V,ad,af,ac,ae){c.b2Assert(0<=V.count&&V.count<=3);var W;var X;this.m_count=V.count;var ab=this.m_vertices;for(var Y=0;Y<this.m_count;Y++){var ag=ab[Y];ag.indexA=V.indexA[Y];ag.indexB=V.indexB[Y];W=ad.GetVertex(ag.indexA);X=ac.GetVertex(ag.indexB);ag.wA=m.MulX(af,W);ag.wB=m.MulX(ae,X);ag.w=m.SubtractVV(ag.wB,ag.wA);ag.a=0}if(this.m_count>1){var aa=V.metric;var Z=this.GetMetric();if(Z<0.5*aa||2*aa<Z||Z<Number.MIN_VALUE){this.m_count=0}}if(this.m_count==0){ag=ab[0];ag.indexA=0;ag.indexB=0;W=ad.GetVertex(0);X=ac.GetVertex(0);ag.wA=m.MulX(af,W);ag.wB=m.MulX(ae,X);ag.w=m.SubtractVV(ag.wB,ag.wA);this.m_count=1}};t.prototype.WriteCache=function(V){V.metric=this.GetMetric();V.count=Box2D.parseUInt(this.m_count);var W=this.m_vertices;for(var X=0;X<this.m_count;X++){V.indexA[X]=Box2D.parseUInt(W[X].indexA);V.indexB[X]=Box2D.parseUInt(W[X].indexB)}};t.prototype.GetSearchDirection=function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var V=m.SubtractVV(this.m_v2.w,this.m_v1.w);var W=m.CrossVV(V,this.m_v1.w.GetNegative());if(W>0){return m.CrossFV(1,V)}else{return m.CrossVF(V,1)}default:c.b2Assert(false);return new G()}};t.prototype.GetClosestPoint=function(){switch(this.m_count){case 0:c.b2Assert(false);return new G();case 1:return this.m_v1.w;case 2:return new G(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:c.b2Assert(false);return new G()}};t.prototype.GetWitnessPoints=function(W,V){switch(this.m_count){case 0:c.b2Assert(false);break;case 1:W.SetV(this.m_v1.wA);V.SetV(this.m_v1.wB);break;case 2:W.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x;W.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y;V.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x;V.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:V.x=W.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x;V.y=W.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:c.b2Assert(false);break}};t.prototype.GetMetric=function(){switch(this.m_count){case 0:c.b2Assert(false);return 0;case 1:return 0;case 2:return m.SubtractVV(this.m_v1.w,this.m_v2.w).Length();case 3:return m.CrossVV(m.SubtractVV(this.m_v2.w,this.m_v1.w),m.SubtractVV(this.m_v3.w,this.m_v1.w));default:c.b2Assert(false);return 0}};t.prototype.Solve2=function(){var W=this.m_v1.w;var V=this.m_v2.w;var Y=m.SubtractVV(V,W);var Z=(-(W.x*Y.x+W.y*Y.y));if(Z<=0){this.m_v1.a=1;this.m_count=1;return}var aa=(V.x*Y.x+V.y*Y.y);if(aa<=0){this.m_v2.a=1;this.m_count=1;this.m_v1.Set(this.m_v2);return}var X=1/(aa+Z);this.m_v1.a=aa*X;this.m_v2.a=Z*X;this.m_count=2};t.prototype.Solve3=function(){var aj=this.m_v1.w;var ah=this.m_v2.w;var af=this.m_v3.w;var ak=m.SubtractVV(ah,aj);var Y=m.Dot(aj,ak);var aa=m.Dot(ah,ak);var av=aa;var au=(-Y);var ai=m.SubtractVV(af,aj);var X=m.Dot(aj,ai);var am=m.Dot(af,ai);var an=am;var al=(-X);var ar=m.SubtractVV(af,ah);var aq=m.Dot(ah,ar);var at=m.Dot(af,ar);var ap=at;var ao=(-aq);var ae=m.CrossVV(ak,ai);var ad=ae*m.CrossVV(ah,af);var ac=ae*m.CrossVV(af,aj);var Z=ae*m.CrossVV(aj,ah);if(au<=0&&al<=0){this.m_v1.a=1;this.m_count=1;return}if(av>0&&au>0&&Z<=0){var W=1/(av+au);this.m_v1.a=av*W;this.m_v2.a=au*W;this.m_count=2;return}if(an>0&&al>0&&ac<=0){var V=1/(an+al);this.m_v1.a=an*V;this.m_v3.a=al*V;this.m_count=2;this.m_v2.Set(this.m_v3);return}if(av<=0&&ao<=0){this.m_v2.a=1;this.m_count=1;this.m_v1.Set(this.m_v2);return}if(an<=0&&ap<=0){this.m_v3.a=1;this.m_count=1;this.m_v1.Set(this.m_v3);return}if(ap>0&&ao>0&&ad<=0){var ag=1/(ap+ao);this.m_v2.a=ap*ag;this.m_v3.a=ao*ag;this.m_count=2;this.m_v1.Set(this.m_v3);return}var ab=1/(ad+ac+Z);this.m_v1.a=ad*ab;this.m_v2.a=ac*ab;this.m_v3.a=Z*ab;this.m_count=3};g.b2SimplexCache=function(){this.indexA=new Vector_a2j_Number(3);this.indexB=new Vector_a2j_Number(3)};f.b2SimplexVertex=function(){};f.prototype.Set=function(V){this.wA.SetV(V.wA);this.wB.SetV(V.wB);this.w.SetV(V.w);this.a=V.a;this.indexA=V.indexA;this.indexB=V.indexB};M.b2TimeOfImpact=function(){};M.TimeOfImpact=function(ac){++M.b2_toiCalls;var al=ac.proxyA;var aj=ac.proxyB;var X=ac.sweepA;var W=ac.sweepB;c.b2Assert(X.t0==W.t0);c.b2Assert(1-X.t0>Number.MIN_VALUE);var Y=al.m_radius+aj.m_radius;var ai=ac.tolerance;var Z=0;var ad=1000;var ah=0;var ao=0;M.s_cache.count=0;M.s_distanceInput.useRadii=false;for(;;){X.GetTransform(M.s_xfA,Z);W.GetTransform(M.s_xfB,Z);M.s_distanceInput.proxyA=al;M.s_distanceInput.proxyB=aj;M.s_distanceInput.transformA=M.s_xfA;M.s_distanceInput.transformB=M.s_xfB;y.Distance(M.s_distanceOutput,M.s_cache,M.s_distanceInput);if(M.s_distanceOutput.distance<=0){Z=1;break}M.s_fcn.Initialize(M.s_cache,al,M.s_xfA,aj,M.s_xfB);var aa=M.s_fcn.Evaluate(M.s_xfA,M.s_xfB);if(aa<=0){Z=1;break}if(ah==0){if(aa>Y){ao=m.Max(Y-ai,0.75*Y)}else{ao=m.Max(aa-ai,0.02*Y)}}if(aa-ao<0.5*ai){if(ah==0){Z=1;break}break}var V=Z;var am=Z;var ak=1;var ag=aa;X.GetTransform(M.s_xfA,ak);W.GetTransform(M.s_xfB,ak);var af=M.s_fcn.Evaluate(M.s_xfA,M.s_xfB);if(af>=ao){Z=1;break}var ae=0;for(;;){var ab=0;if(ae&1){ab=am+(ao-ag)*(ak-am)/(af-ag)}else{ab=0.5*(am+ak)}X.GetTransform(M.s_xfA,ab);W.GetTransform(M.s_xfB,ab);var an=M.s_fcn.Evaluate(M.s_xfA,M.s_xfB);if(m.Abs(an-ao)<0.025*ai){V=ab;break}if(an>ao){am=ab;ag=an}else{ak=ab;af=an}++ae;++M.b2_toiRootIters;if(ae==50){break}}M.b2_toiMaxRootIters=m.Max(M.b2_toiMaxRootIters,ae);if(V<(1+100*Number.MIN_VALUE)*Z){break}Z=V;ah++;++M.b2_toiIters;if(ah==ad){break}}M.b2_toiMaxIters=m.Max(M.b2_toiMaxIters,ah);return Z};Box2D.postDefs.push(function(){Box2D.Collision.b2TimeOfImpact.b2_toiCalls=0;Box2D.Collision.b2TimeOfImpact.b2_toiIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiRootIters=0;Box2D.Collision.b2TimeOfImpact.b2_toiMaxRootIters=0;Box2D.Collision.b2TimeOfImpact.s_cache=new g();Box2D.Collision.b2TimeOfImpact.s_distanceInput=new d();Box2D.Collision.b2TimeOfImpact.s_xfA=new e();Box2D.Collision.b2TimeOfImpact.s_xfB=new e();Box2D.Collision.b2TimeOfImpact.s_fcn=new N();Box2D.Collision.b2TimeOfImpact.s_distanceOutput=new z()});Q.b2TOIInput=function(){this.proxyA=new S();this.proxyB=new S();this.sweepA=new p();this.sweepB=new p()};a.b2WorldManifold=function(){this.m_normal=new G()};a.prototype.b2WorldManifold=function(){this.m_points=new Vector(c.b2_maxManifoldPoints);for(var V=0;V<c.b2_maxManifoldPoints;V++){this.m_points[V]=new G()}};a.prototype.Initialize=function(ah,aj,am,ai,al){if(am===undefined){am=0}if(al===undefined){al=0}if(ah.m_pointCount==0){return}var ak=0;var X;var ag;var ab=0;var Z=0;var W=0;var av=0;var ap=0;var ao=0;switch(ah.m_type){case J.e_circles:ag=aj.R;X=ah.m_localPoint;var au=aj.position.x+ag.col1.x*X.x+ag.col2.x*X.y;var ar=aj.position.y+ag.col1.y*X.x+ag.col2.y*X.y;ag=ai.R;X=ah.m_points[0].m_localPoint;var ae=ai.position.x+ag.col1.x*X.x+ag.col2.x*X.y;var ac=ai.position.y+ag.col1.y*X.x+ag.col2.y*X.y;var aa=ae-au;var Y=ac-ar;var aq=aa*aa+Y*Y;if(aq>Number.MIN_VALUE*Number.MIN_VALUE){var an=Math.sqrt(aq);this.m_normal.x=aa/an;this.m_normal.y=Y/an}else{this.m_normal.x=1;this.m_normal.y=0}var V=au+am*this.m_normal.x;var at=ar+am*this.m_normal.y;var af=ae-al*this.m_normal.x;var ad=ac-al*this.m_normal.y;this.m_points[0].x=0.5*(V+af);this.m_points[0].y=0.5*(at+ad);break;case J.e_faceA:ag=aj.R;X=ah.m_localPlaneNormal;ab=ag.col1.x*X.x+ag.col2.x*X.y;Z=ag.col1.y*X.x+ag.col2.y*X.y;ag=aj.R;X=ah.m_localPoint;W=aj.position.x+ag.col1.x*X.x+ag.col2.x*X.y;av=aj.position.y+ag.col1.y*X.x+ag.col2.y*X.y;this.m_normal.x=ab;this.m_normal.y=Z;for(ak=0;ak<ah.m_pointCount;ak++){ag=ai.R;X=ah.m_points[ak].m_localPoint;ap=ai.position.x+ag.col1.x*X.x+ag.col2.x*X.y;ao=ai.position.y+ag.col1.y*X.x+ag.col2.y*X.y;this.m_points[ak].x=ap+0.5*(am-(ap-W)*ab-(ao-av)*Z-al)*ab;this.m_points[ak].y=ao+0.5*(am-(ap-W)*ab-(ao-av)*Z-al)*Z}break;case J.e_faceB:ag=ai.R;X=ah.m_localPlaneNormal;ab=ag.col1.x*X.x+ag.col2.x*X.y;Z=ag.col1.y*X.x+ag.col2.y*X.y;ag=ai.R;X=ah.m_localPoint;W=ai.position.x+ag.col1.x*X.x+ag.col2.x*X.y;av=ai.position.y+ag.col1.y*X.x+ag.col2.y*X.y;this.m_normal.x=(-ab);this.m_normal.y=(-Z);for(ak=0;ak<ah.m_pointCount;ak++){ag=aj.R;X=ah.m_points[ak].m_localPoint;ap=aj.position.x+ag.col1.x*X.x+ag.col2.x*X.y;ao=aj.position.y+ag.col1.y*X.x+ag.col2.y*X.y;this.m_points[ak].x=ap+0.5*(al-(ap-W)*ab-(ao-av)*Z-am)*ab;this.m_points[ak].y=ao+0.5*(al-(ap-W)*ab-(ao-av)*Z-am)*Z}break}};k.ClipVertex=function(){this.v=new G();this.id=new I()};k.prototype.Set=function(V){this.v.SetV(V.v);this.id.Set(V.id)};H.Features=function(){};Object.defineProperty(H.prototype,"referenceEdge",{enumerable:false,configurable:true,get:function(){return this._referenceEdge}});Object.defineProperty(H.prototype,"referenceEdge",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._referenceEdge=V;this._m_id._key=(this._m_id._key&4294967040)|(this._referenceEdge&255)}});Object.defineProperty(H.prototype,"incidentEdge",{enumerable:false,configurable:true,get:function(){return this._incidentEdge}});Object.defineProperty(H.prototype,"incidentEdge",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._incidentEdge=V;this._m_id._key=(this._m_id._key&4294902015)|((this._incidentEdge<<8)&65280)}});Object.defineProperty(H.prototype,"incidentVertex",{enumerable:false,configurable:true,get:function(){return this._incidentVertex}});Object.defineProperty(H.prototype,"incidentVertex",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._incidentVertex=V;this._m_id._key=(this._m_id._key&4278255615)|((this._incidentVertex<<16)&16711680)}});Object.defineProperty(H.prototype,"flip",{enumerable:false,configurable:true,get:function(){return this._flip}});Object.defineProperty(H.prototype,"flip",{enumerable:false,configurable:true,set:function(V){if(V===undefined){V=0}this._flip=V;this._m_id._key=(this._m_id._key&16777215)|((this._flip<<24)&4278190080)}})})();(function(){var u=Box2D.Common.b2Color,O=Box2D.Common.b2internal,c=Box2D.Common.b2Settings,G=Box2D.Collision.Shapes.b2CircleShape,ac=Box2D.Collision.Shapes.b2EdgeChainDef,ai=Box2D.Collision.Shapes.b2EdgeShape,M=Box2D.Collision.Shapes.b2MassData,s=Box2D.Collision.Shapes.b2PolygonShape,l=Box2D.Collision.Shapes.b2Shape,D=Box2D.Common.Math.b2Mat22,k=Box2D.Common.Math.b2Mat33,r=Box2D.Common.Math.b2Math,v=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,S=Box2D.Common.Math.b2Vec2,Q=Box2D.Common.Math.b2Vec3,m=Box2D.Dynamics.b2Body,C=Box2D.Dynamics.b2BodyDef,Z=Box2D.Dynamics.b2ContactFilter,B=Box2D.Dynamics.b2ContactImpulse,I=Box2D.Dynamics.b2ContactListener,N=Box2D.Dynamics.b2ContactManager,p=Box2D.Dynamics.b2DebugDraw,ad=Box2D.Dynamics.b2PaperDraw,f=Box2D.Dynamics.b2DestructionListener,x=Box2D.Dynamics.b2FilterData,aj=Box2D.Dynamics.b2Fixture,t=Box2D.Dynamics.b2FixtureDef,j=Box2D.Dynamics.b2Island,L=Box2D.Dynamics.b2TimeStep,q=Box2D.Dynamics.b2World,ab=Box2D.Collision.b2AABB,b=Box2D.Collision.b2Bound,P=Box2D.Collision.b2BoundValues,w=Box2D.Collision.b2Collision,V=Box2D.Collision.b2ContactID,z=Box2D.Collision.b2ContactPoint,H=Box2D.Collision.b2Distance,d=Box2D.Collision.b2DistanceInput,K=Box2D.Collision.b2DistanceOutput,ag=Box2D.Collision.b2DistanceProxy,F=Box2D.Collision.b2DynamicTree,X=Box2D.Collision.b2DynamicTreeBroadPhase,ah=Box2D.Collision.b2DynamicTreeNode,J=Box2D.Collision.b2DynamicTreePair,U=Box2D.Collision.b2Manifold,af=Box2D.Collision.b2ManifoldPoint,y=Box2D.Collision.b2Point,o=Box2D.Collision.b2RayCastInput,E=Box2D.Collision.b2RayCastOutput,W=Box2D.Collision.b2Segment,aa=Box2D.Collision.b2SeparationFunction,A=Box2D.Collision.b2Simplex,h=Box2D.Collision.b2SimplexCache,g=Box2D.Collision.b2SimplexVertex,Y=Box2D.Collision.b2TimeOfImpact,ae=Box2D.Collision.b2TOIInput,a=Box2D.Collision.b2WorldManifold,n=Box2D.Collision.ClipVertex,T=Box2D.Collision.Features,R=Box2D.Collision.IBroadPhase;Box2D.inherit(G,Box2D.Collision.Shapes.b2Shape);G.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;G.b2CircleShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.m_p=new S()};G.prototype.Copy=function(){var ak=new G();ak.Set(this);return ak};G.prototype.Set=function(ak){this.__super.Set.call(this,ak);if(Box2D.is(ak,G)){var al=(ak instanceof G?ak:null);this.m_p.SetV(al.m_p)}};G.prototype.TestPoint=function(am,ao){var an=am.R;var al=am.position.x+(an.col1.x*this.m_p.x+an.col2.x*this.m_p.y);var ak=am.position.y+(an.col1.y*this.m_p.x+an.col2.y*this.m_p.y);al=ao.x-al;ak=ao.y-ak;return(al*al+ak*ak)<=this.m_radius*this.m_radius};G.prototype.RayCast=function(an,ay,am){var av=am.R;var at=am.position.x+(av.col1.x*this.m_p.x+av.col2.x*this.m_p.y);var ar=am.position.y+(av.col1.y*this.m_p.x+av.col2.y*this.m_p.y);var al=ay.p1.x-at;var ak=ay.p1.y-ar;var aw=(al*al+ak*ak)-this.m_radius*this.m_radius;var aq=ay.p2.x-ay.p1.x;var ap=ay.p2.y-ay.p1.y;var au=(al*aq+ak*ap);var ao=(aq*aq+ap*ap);var az=au*au-ao*aw;if(az<0||ao<Number.MIN_VALUE){return false}var ax=(-(au+Math.sqrt(az)));if(0<=ax&&ax<=ay.maxFraction*ao){ax/=ao;an.fraction=ax;an.normal.x=al+ax*aq;an.normal.y=ak+ax*ap;an.normal.Normalize();return true}return false};G.prototype.ComputeAABB=function(ak,an){var ao=an.R;var am=an.position.x+(ao.col1.x*this.m_p.x+ao.col2.x*this.m_p.y);var al=an.position.y+(ao.col1.y*this.m_p.x+ao.col2.y*this.m_p.y);ak.lowerBound.Set(am-this.m_radius,al-this.m_radius);ak.upperBound.Set(am+this.m_radius,al+this.m_radius)};G.prototype.ComputeMass=function(al,ak){if(ak===undefined){ak=0}al.mass=ak*c.b2_pi*this.m_radius*this.m_radius;al.center.SetV(this.m_p);al.I=al.mass*(0.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))};G.prototype.ComputeSubmergedArea=function(ar,aq,au,at){if(aq===undefined){aq=0}var al=r.MulX(au,this.m_p);var ap=(-(r.Dot(ar,al)-aq));if(ap<(-this.m_radius)+Number.MIN_VALUE){return 0}if(ap>this.m_radius){at.SetV(al);return Math.PI*this.m_radius*this.m_radius}var an=this.m_radius*this.m_radius;var ao=ap*ap;var ak=an*(Math.asin(ap/this.m_radius)+Math.PI/2)+ap*Math.sqrt(an-ao);var am=(-2/3*Math.pow(an-ao,1.5)/ak);at.x=al.x+ar.x*am;at.y=al.y+ar.y*am;return ak};G.prototype.GetLocalPosition=function(){return this.m_p};G.prototype.SetLocalPosition=function(ak){this.m_p.SetV(ak)};G.prototype.GetRadius=function(){return this.m_radius};G.prototype.SetRadius=function(ak){if(ak===undefined){ak=0}this.m_radius=ak};G.prototype.b2CircleShape=function(ak){if(ak===undefined){ak=0}this.__super.b2Shape.call(this);this.m_type=l.e_circleShape;this.m_radius=ak};ac.b2EdgeChainDef=function(){};ac.prototype.b2EdgeChainDef=function(){this.vertexCount=0;this.isALoop=true;this.vertices=[]};Box2D.inherit(ai,Box2D.Collision.Shapes.b2Shape);ai.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;ai.b2EdgeShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments);this.s_supportVec=new S();this.m_v1=new S();this.m_v2=new S();this.m_coreV1=new S();this.m_coreV2=new S();this.m_normal=new S();this.m_direction=new S();this.m_cornerDir1=new S();this.m_cornerDir2=new S()};ai.prototype.TestPoint=function(ak,al){return false};ai.prototype.RayCast=function(an,ax,am){var at;var aq=ax.p2.x-ax.p1.x;var ao=ax.p2.y-ax.p1.y;at=am.R;var aw=am.position.x+(at.col1.x*this.m_v1.x+at.col2.x*this.m_v1.y);var au=am.position.y+(at.col1.y*this.m_v1.x+at.col2.y*this.m_v1.y);var aB=am.position.y+(at.col1.y*this.m_v2.x+at.col2.y*this.m_v2.y)-au;var az=(-(am.position.x+(at.col1.x*this.m_v2.x+at.col2.x*this.m_v2.y)-aw));var ar=100*Number.MIN_VALUE;var ap=(-(aq*aB+ao*az));if(ap>ar){var al=ax.p1.x-aw;var ak=ax.p1.y-au;var av=(al*aB+ak*az);if(0<=av&&av<=ax.maxFraction*ap){var ay=(-aq*ak)+ao*al;if((-ar*ap)<=ay&&ay<=ap*(1+ar)){av/=ap;an.fraction=av;var aA=Math.sqrt(aB*aB+az*az);an.normal.x=aB/aA;an.normal.y=az/aA;return true}}}return false};ai.prototype.ComputeAABB=function(am,an){var ao=an.R;var aq=an.position.x+(ao.col1.x*this.m_v1.x+ao.col2.x*this.m_v1.y);var ap=an.position.y+(ao.col1.y*this.m_v1.x+ao.col2.y*this.m_v1.y);var al=an.position.x+(ao.col1.x*this.m_v2.x+ao.col2.x*this.m_v2.y);var ak=an.position.y+(ao.col1.y*this.m_v2.x+ao.col2.y*this.m_v2.y);if(aq<al){am.lowerBound.x=aq;am.upperBound.x=al}else{am.lowerBound.x=al;am.upperBound.x=aq}if(ap<ak){am.lowerBound.y=ap;am.upperBound.y=ak}else{am.lowerBound.y=ak;am.upperBound.y=ap}};ai.prototype.ComputeMass=function(al,ak){if(ak===undefined){ak=0}al.mass=0;al.center.SetV(this.m_v1);al.I=0};ai.prototype.ComputeSubmergedArea=function(an,am,ar,ao){if(am===undefined){am=0}var at=new S(an.x*am,an.y*am);var aq=r.MulX(ar,this.m_v1);var ap=r.MulX(ar,this.m_v2);var al=r.Dot(an,aq)-am;var ak=r.Dot(an,ap)-am;if(al>0){if(ak>0){return 0}else{aq.x=(-ak/(al-ak)*aq.x)+al/(al-ak)*ap.x;aq.y=(-ak/(al-ak)*aq.y)+al/(al-ak)*ap.y}}else{if(ak>0){ap.x=(-ak/(al-ak)*aq.x)+al/(al-ak)*ap.x;ap.y=(-ak/(al-ak)*aq.y)+al/(al-ak)*ap.y}else{}}ao.x=(at.x+aq.x+ap.x)/3;ao.y=(at.y+aq.y+ap.y)/3;return 0.5*((aq.x-at.x)*(ap.y-at.y)-(aq.y-at.y)*(ap.x-at.x))};ai.prototype.GetLength=function(){return this.m_length};ai.prototype.GetVertex1=function(){return this.m_v1};ai.prototype.GetVertex2=function(){return this.m_v2};ai.prototype.GetCoreVertex1=function(){return this.m_coreV1};ai.prototype.GetCoreVertex2=function(){return this.m_coreV2};ai.prototype.GetNormalVector=function(){return this.m_normal};ai.prototype.GetDirectionVector=function(){return this.m_direction};ai.prototype.GetCorner1Vector=function(){return this.m_cornerDir1};ai.prototype.GetCorner2Vector=function(){return this.m_cornerDir2};ai.prototype.Corner1IsConvex=function(){return this.m_cornerConvex1};ai.prototype.Corner2IsConvex=function(){return this.m_cornerConvex2};ai.prototype.GetFirstVertex=function(al){var ak=al.R;return new S(al.position.x+(ak.col1.x*this.m_coreV1.x+ak.col2.x*this.m_coreV1.y),al.position.y+(ak.col1.y*this.m_coreV1.x+ak.col2.y*this.m_coreV1.y))};ai.prototype.GetNextEdge=function(){return this.m_nextEdge};ai.prototype.GetPrevEdge=function(){return this.m_prevEdge};ai.prototype.Support=function(ap,an,al){if(an===undefined){an=0}if(al===undefined){al=0}var ao=ap.R;var ar=ap.position.x+(ao.col1.x*this.m_coreV1.x+ao.col2.x*this.m_coreV1.y);var aq=ap.position.y+(ao.col1.y*this.m_coreV1.x+ao.col2.y*this.m_coreV1.y);var am=ap.position.x+(ao.col1.x*this.m_coreV2.x+ao.col2.x*this.m_coreV2.y);var ak=ap.position.y+(ao.col1.y*this.m_coreV2.x+ao.col2.y*this.m_coreV2.y);if((ar*an+aq*al)>(am*an+ak*al)){this.s_supportVec.x=ar;this.s_supportVec.y=aq}else{this.s_supportVec.x=am;this.s_supportVec.y=ak}return this.s_supportVec};ai.prototype.b2EdgeShape=function(al,ak){this.__super.b2Shape.call(this);this.m_type=l.e_edgeShape;this.m_prevEdge=null;this.m_nextEdge=null;this.m_v1=al;this.m_v2=ak;this.m_direction.Set(this.m_v2.x-this.m_v1.x,this.m_v2.y-this.m_v1.y);this.m_length=this.m_direction.Normalize();this.m_normal.Set(this.m_direction.y,(-this.m_direction.x));this.m_coreV1.Set((-c.b2_toiSlop*(this.m_normal.x-this.m_direction.x))+this.m_v1.x,(-c.b2_toiSlop*(this.m_normal.y-this.m_direction.y))+this.m_v1.y);this.m_coreV2.Set((-c.b2_toiSlop*(this.m_normal.x+this.m_direction.x))+this.m_v2.x,(-c.b2_toiSlop*(this.m_normal.y+this.m_direction.y))+this.m_v2.y);this.m_cornerDir1=this.m_normal;this.m_cornerDir2.Set((-this.m_normal.x),(-this.m_normal.y))};ai.prototype.SetPrevEdge=function(an,ak,am,al){this.m_prevEdge=an;this.m_coreV1=ak;this.m_cornerDir1=am;this.m_cornerConvex1=al};ai.prototype.SetNextEdge=function(an,ak,am,al){this.m_nextEdge=an;this.m_coreV2=ak;this.m_cornerDir2=am;this.m_cornerConvex2=al};M.b2MassData=function(){this.mass=0;this.center=new S(0,0);this.I=0};Box2D.inherit(s,Box2D.Collision.Shapes.b2Shape);s.prototype.__super=Box2D.Collision.Shapes.b2Shape.prototype;s.b2PolygonShape=function(){Box2D.Collision.Shapes.b2Shape.b2Shape.apply(this,arguments)};s.prototype.Copy=function(){var ak=new s();ak.Set(this);return ak};s.prototype.Set=function(ak){this.__super.Set.call(this,ak);if(Box2D.is(ak,s)){var am=(ak instanceof s?ak:null);this.m_centroid.SetV(am.m_centroid);this.m_vertexCount=am.m_vertexCount;this.Reserve(this.m_vertexCount);for(var al=0;al<this.m_vertexCount;al++){this.m_vertices[al].SetV(am.m_vertices[al]);this.m_normals[al].SetV(am.m_normals[al])}}};s.prototype.SetAsArray=function(al,ao){if(ao===undefined){ao=0}var ak=new Vector();var an=0,am;for(an=0;an<al.length;++an){am=al[an];ak.push(am)}this.SetAsVector(ak,ao)};s.AsArray=function(al,am){if(am===undefined){am=0}var ak=new s();ak.SetAsArray(al,am);return ak};s.prototype.SetAsVector=function(ak,an){if(an===undefined){an=0}if(an==0){an=ak.length}c.b2Assert(2<=an);this.m_vertexCount=an;this.Reserve(an);var al=0;for(al=0;al<this.m_vertexCount;al++){this.m_vertices[al].SetV(ak[al])}for(al=0;al<this.m_vertexCount;++al){var ap=parseInt(al);var am=parseInt(al+1<this.m_vertexCount?al+1:0);var ao=r.SubtractVV(this.m_vertices[am],this.m_vertices[ap]);c.b2Assert(ao.LengthSquared()>Number.MIN_VALUE);this.m_normals[al].SetV(r.CrossVF(ao,1));this.m_normals[al].Normalize()}this.m_centroid=s.ComputeCentroid(this.m_vertices,this.m_vertexCount)};s.AsVector=function(al,am){if(am===undefined){am=0}var ak=new s();ak.SetAsVector(al,am);return ak};s.prototype.SetAsBox=function(al,ak){if(al===undefined){al=0}if(ak===undefined){ak=0}this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set((-al),(-ak));this.m_vertices[1].Set(al,(-ak));this.m_vertices[2].Set(al,ak);this.m_vertices[3].Set((-al),ak);this.m_normals[0].Set(0,(-1));this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set((-1),0);this.m_centroid.SetZero()};s.AsBox=function(am,al){if(am===undefined){am=0}if(al===undefined){al=0}var ak=new s();ak.SetAsBox(am,al);return ak};s.prototype.SetAsOrientedBox=function(ap,ao,ak,an){if(ap===undefined){ap=0}if(ao===undefined){ao=0}if(ak===undefined){ak=null}if(an===undefined){an=0}this.m_vertexCount=4;this.Reserve(4);this.m_vertices[0].Set((-ap),(-ao));this.m_vertices[1].Set(ap,(-ao));this.m_vertices[2].Set(ap,ao);this.m_vertices[3].Set((-ap),ao);this.m_normals[0].Set(0,(-1));this.m_normals[1].Set(1,0);this.m_normals[2].Set(0,1);this.m_normals[3].Set((-1),0);this.m_centroid=ak;var am=new e();am.position=ak;am.R.Set(an);for(var al=0;al<this.m_vertexCount;++al){this.m_vertices[al]=r.MulX(am,this.m_vertices[al]);this.m_normals[al]=r.MulMV(am.R,this.m_normals[al])}};s.AsOrientedBox=function(ao,an,al,am){if(ao===undefined){ao=0}if(an===undefined){an=0}if(al===undefined){al=null}if(am===undefined){am=0}var ak=new s();ak.SetAsOrientedBox(ao,an,al,am);return ak};s.prototype.SetAsEdge=function(al,ak){this.m_vertexCount=2;this.Reserve(2);this.m_vertices[0].SetV(al);this.m_vertices[1].SetV(ak);this.m_centroid.x=0.5*(al.x+ak.x);this.m_centroid.y=0.5*(al.y+ak.y);this.m_normals[0]=r.CrossVF(r.SubtractVV(ak,al),1);this.m_normals[0].Normalize();this.m_normals[1].x=(-this.m_normals[0].x);this.m_normals[1].y=(-this.m_normals[0].y)};s.AsEdge=function(am,al){var ak=new s();ak.SetAsEdge(am,al);return ak};s.prototype.TestPoint=function(ar,al){var au;var ap=ar.R;var at=al.x-ar.position.x;var aq=al.y-ar.position.y;var an=(at*ap.col1.x+aq*ap.col1.y);var am=(at*ap.col2.x+aq*ap.col2.y);for(var ao=0;ao<this.m_vertexCount;++ao){au=this.m_vertices[ao];at=an-au.x;aq=am-au.y;au=this.m_normals[ao];var ak=(au.x*at+au.y*aq);if(ak>0){return false}}return true};s.prototype.RayCast=function(ar,au,av){var aC=0;var aB=au.maxFraction;var ax=0;var aw=0;var at;var an;ax=au.p1.x-av.position.x;aw=au.p1.y-av.position.y;at=av.R;var az=(ax*at.col1.x+aw*at.col1.y);var ay=(ax*at.col2.x+aw*at.col2.y);ax=au.p2.x-av.position.x;aw=au.p2.y-av.position.y;at=av.R;var am=(ax*at.col1.x+aw*at.col1.y);var al=(ax*at.col2.x+aw*at.col2.y);var ap=am-az;var ao=al-ay;var aq=parseInt((-1));for(var aA=0;aA<this.m_vertexCount;++aA){an=this.m_vertices[aA];ax=an.x-az;aw=an.y-ay;an=this.m_normals[aA];var aD=(an.x*ax+an.y*aw);var ak=(an.x*ap+an.y*ao);if(ak==0){if(aD<0){return false}}else{if(ak<0&&aD<aC*ak){aC=aD/ak;aq=aA}else{if(ak>0&&aD<aB*ak){aB=aD/ak}}}if(aB<aC-Number.MIN_VALUE){return false}}if(aq>=0){ar.fraction=aC;at=av.R;an=this.m_normals[aq];ar.normal.x=(at.col1.x*an.x+at.col2.x*an.y);ar.normal.y=(at.col1.y*an.x+at.col2.y*an.y);return true}return false};s.prototype.ComputeAABB=function(ap,ar){var aq=ar.R;var av=this.m_vertices[0];var au=ar.position.x+(aq.col1.x*av.x+aq.col2.x*av.y);var at=ar.position.y+(aq.col1.y*av.x+aq.col2.y*av.y);var an=au;var am=at;for(var ao=1;ao<this.m_vertexCount;++ao){av=this.m_vertices[ao];var al=ar.position.x+(aq.col1.x*av.x+aq.col2.x*av.y);var ak=ar.position.y+(aq.col1.y*av.x+aq.col2.y*av.y);au=au<al?au:al;at=at<ak?at:ak;an=an>al?an:al;am=am>ak?am:ak}ap.lowerBound.x=au-this.m_radius;ap.lowerBound.y=at-this.m_radius;ap.upperBound.x=an+this.m_radius;ap.upperBound.y=am+this.m_radius};s.prototype.ComputeMass=function(aw,at){if(at===undefined){at=0}if(this.m_vertexCount==2){aw.center.x=0.5*(this.m_vertices[0].x+this.m_vertices[1].x);aw.center.y=0.5*(this.m_vertices[0].y+this.m_vertices[1].y);aw.mass=0;aw.I=0;return}var au=0;var ar=0;var aI=0;var av=0;var aG=0;var aF=0;var aq=1/3;for(var aH=0;aH<this.m_vertexCount;++aH){var an=this.m_vertices[aH];var am=aH+1<this.m_vertexCount?this.m_vertices[parseInt(aH+1)]:this.m_vertices[0];var aE=an.x-aG;var aC=an.y-aF;var al=am.x-aG;var aK=am.y-aF;var az=aE*aK-aC*al;var ap=0.5*az;aI+=ap;au+=ap*aq*(aG+an.x+am.x);ar+=ap*aq*(aF+an.y+am.y);var aA=aG;var ay=aF;var aD=aE;var ak=aC;var aB=al;var aJ=aK;var ao=aq*(0.25*(aD*aD+aB*aD+aB*aB)+(aA*aD+aA*aB))+0.5*aA*aA;var ax=aq*(0.25*(ak*ak+aJ*ak+aJ*aJ)+(ay*ak+ay*aJ))+0.5*ay*ay;av+=az*(ao+ax)}aw.mass=at*aI;au*=1/aI;ar*=1/aI;aw.center.Set(au,ar);aw.I=at*av};s.prototype.ComputeSubmergedArea=function(aI,av,aB,aF){if(av===undefined){av=0}var az=r.MulTMV(aB.R,aI);var an=av-r.Dot(aI,aB.position);var ax=new Vector_a2j_Number();var aw=0;var ao=parseInt((-1));var al=parseInt((-1));var au=false;var aD=0;for(aD=0;aD<this.m_vertexCount;++aD){ax[aD]=r.Dot(az,this.m_vertices[aD])-an;var aq=ax[aD]<(-Number.MIN_VALUE);if(aD>0){if(aq){if(!au){ao=aD-1;aw++}}else{if(au){al=aD-1;aw++}}}au=aq}switch(aw){case 0:if(au){var aH=new M();this.ComputeMass(aH,1);aF.SetV(r.MulX(aB,aH.center));return aH.mass}else{return 0}break;case 1:if(ao==(-1)){ao=this.m_vertexCount-1}else{al=this.m_vertexCount-1}break}var ay=parseInt((ao+1)%this.m_vertexCount);var aA=parseInt((al+1)%this.m_vertexCount);var aC=(0-ax[ao])/(ax[ay]-ax[ao]);var aJ=(0-ax[al])/(ax[aA]-ax[al]);var ar=new S(this.m_vertices[ao].x*(1-aC)+this.m_vertices[ay].x*aC,this.m_vertices[ao].y*(1-aC)+this.m_vertices[ay].y*aC);var ap=new S(this.m_vertices[al].x*(1-aJ)+this.m_vertices[aA].x*aJ,this.m_vertices[al].y*(1-aJ)+this.m_vertices[aA].y*aJ);var aE=0;var aG=new S();var am=this.m_vertices[ay];var ak;aD=ay;while(aD!=aA){aD=(aD+1)%this.m_vertexCount;if(aD==aA){ak=ap}else{ak=this.m_vertices[aD]}var at=0.5*((am.x-ar.x)*(ak.y-ar.y)-(am.y-ar.y)*(ak.x-ar.x));aE+=at;aG.x+=at*(ar.x+am.x+ak.x)/3;aG.y+=at*(ar.y+am.y+ak.y)/3;am=ak}aG.Multiply(1/aE);aF.SetV(r.MulX(aB,aG));return aE};s.prototype.GetVertexCount=function(){return this.m_vertexCount};s.prototype.GetVertices=function(){return this.m_vertices};s.prototype.GetNormals=function(){return this.m_normals};s.prototype.GetSupport=function(ao){var al=0;var an=this.m_vertices[0].x*ao.x+this.m_vertices[0].y*ao.y;for(var ak=1;ak<this.m_vertexCount;++ak){var am=this.m_vertices[ak].x*ao.x+this.m_vertices[ak].y*ao.y;if(am>an){al=ak;an=am}}return al};s.prototype.GetSupportVertex=function(ao){var al=0;var an=this.m_vertices[0].x*ao.x+this.m_vertices[0].y*ao.y;for(var ak=1;ak<this.m_vertexCount;++ak){var am=this.m_vertices[ak].x*ao.x+this.m_vertices[ak].y*ao.y;if(am>an){al=ak;an=am}}return this.m_vertices[al]};s.prototype.Validate=function(){return false};s.prototype.b2PolygonShape=function(){this.__super.b2Shape.call(this);this.m_type=l.e_polygonShape;this.m_centroid=new S();this.m_vertices=new Vector();this.m_normals=new Vector()};s.prototype.Reserve=function(al){if(al===undefined){al=0}for(var ak=parseInt(this.m_vertices.length);ak<al;ak++){this.m_vertices[ak]=new S();this.m_normals[ak]=new S()}};s.ComputeCentroid=function(aA,at){if(at===undefined){at=0}var av=new S();var an=0;var ar=0;var aq=0;var ao=1/3;for(var ap=0;ap<at;++ap){var az=aA[ap];var ax=ap+1<at?aA[parseInt(ap+1)]:aA[0];var am=az.x-ar;var al=az.y-aq;var aw=ax.x-ar;var au=ax.y-aq;var ak=(am*au-al*aw);var ay=0.5*ak;an+=ay;av.x+=ay*ao*(ar+az.x+ax.x);av.y+=ay*ao*(aq+az.y+ax.y)}av.x*=1/an;av.y*=1/an;return av};s.ComputeOBB=function(az,aC,at){if(at===undefined){at=0}var aE=0;var ax=new Vector(at+1);for(aE=0;aE<at;++aE){ax[aE]=aC[aE]}ax[at]=ax[0];var ar=Number.MAX_VALUE;for(aE=1;aE<=at;++aE){var aB=ax[parseInt(aE-1)];var aA=ax[aE].x-aB.x;var ay=ax[aE].y-aB.y;var ao=Math.sqrt(aA*aA+ay*ay);aA/=ao;ay/=ao;var al=(-ay);var ak=aA;var aq=Number.MAX_VALUE;var ap=Number.MAX_VALUE;var aJ=(-Number.MAX_VALUE);var aI=(-Number.MAX_VALUE);for(var aD=0;aD<at;++aD){var an=ax[aD].x-aB.x;var am=ax[aD].y-aB.y;var aH=(aA*an+ay*am);var aG=(al*an+ak*am);if(aH<aq){aq=aH}if(aG<ap){ap=aG}if(aH>aJ){aJ=aH}if(aG>aI){aI=aG}}var aF=(aJ-aq)*(aI-ap);if(aF<0.95*ar){ar=aF;az.R.col1.x=aA;az.R.col1.y=ay;az.R.col2.x=al;az.R.col2.y=ak;var av=0.5*(aq+aJ);var au=0.5*(ap+aI);var aw=az.R;az.center.x=aB.x+(aw.col1.x*av+aw.col2.x*au);az.center.y=aB.y+(aw.col1.y*av+aw.col2.y*au);az.extents.x=0.5*(aJ-aq);az.extents.y=0.5*(aI-ap)}}};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2PolygonShape.s_mat=new D()});l.b2Shape=function(){};l.prototype.Copy=function(){return null};l.prototype.Set=function(ak){this.m_radius=ak.m_radius};l.prototype.GetType=function(){return this.m_type};l.prototype.TestPoint=function(ak,al){return false};l.prototype.RayCast=function(al,ak,am){return false};l.prototype.ComputeAABB=function(ak,al){};l.prototype.ComputeMass=function(al,ak){if(ak===undefined){ak=0}};l.prototype.ComputeSubmergedArea=function(al,am,ak,an){if(am===undefined){am=0}return 0};l.TestOverlap=function(al,aq,ak,ap){var ao=new d();ao.proxyA=new ag();ao.proxyA.Set(al);ao.proxyB=new ag();ao.proxyB.Set(ak);ao.transformA=aq;ao.transformB=ap;ao.useRadii=true;var an=new h();an.count=0;var am=new K();H.Distance(am,an,ao);return am.distance<10*Number.MIN_VALUE};l.prototype.b2Shape=function(){this.m_type=l.e_unknownShape;this.m_radius=c.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Collision.Shapes.b2Shape.e_unknownShape=parseInt((-1));Box2D.Collision.Shapes.b2Shape.e_circleShape=0;Box2D.Collision.Shapes.b2Shape.e_polygonShape=1;Box2D.Collision.Shapes.b2Shape.e_edgeShape=2;Box2D.Collision.Shapes.b2Shape.e_shapeTypeCount=3;Box2D.Collision.Shapes.b2Shape.e_hitCollide=1;Box2D.Collision.Shapes.b2Shape.e_missCollide=0;Box2D.Collision.Shapes.b2Shape.e_startsInsideCollide=parseInt((-1))})})();(function(){var g=Box2D.Common.b2Color,d=Box2D.Common.b2internal,k=Box2D.Common.b2Settings,a=Box2D.Common.Math.b2Mat22,h=Box2D.Common.Math.b2Mat33,j=Box2D.Common.Math.b2Math,c=Box2D.Common.Math.b2Sweep,b=Box2D.Common.Math.b2Transform,f=Box2D.Common.Math.b2Vec2,e=Box2D.Common.Math.b2Vec3;g.b2Color=function(){this._r=0;this._g=0;this._b=0};g.prototype.b2Color=function(m,l,n){if(m===undefined){m=0}if(l===undefined){l=0}if(n===undefined){n=0}this._r=Box2D.parseUInt(255*j.Clamp(m,0,1));this._g=Box2D.parseUInt(255*j.Clamp(l,0,1));this._b=Box2D.parseUInt(255*j.Clamp(n,0,1))};g.prototype.Set=function(m,l,n){if(m===undefined){m=0}if(l===undefined){l=0}if(n===undefined){n=0}this._r=Box2D.parseUInt(255*j.Clamp(m,0,1));this._g=Box2D.parseUInt(255*j.Clamp(l,0,1));this._b=Box2D.parseUInt(255*j.Clamp(n,0,1))};Object.defineProperty(g.prototype,"r",{enumerable:false,configurable:true,set:function(l){if(l===undefined){l=0}this._r=Box2D.parseUInt(255*j.Clamp(l,0,1))}});Object.defineProperty(g.prototype,"g",{enumerable:false,configurable:true,set:function(l){if(l===undefined){l=0}this._g=Box2D.parseUInt(255*j.Clamp(l,0,1))}});Object.defineProperty(g.prototype,"b",{enumerable:false,configurable:true,set:function(l){if(l===undefined){l=0}this._b=Box2D.parseUInt(255*j.Clamp(l,0,1))}});Object.defineProperty(g.prototype,"color",{enumerable:false,configurable:true,get:function(){return(this._r<<16)|(this._g<<8)|(this._b)}});k.b2Settings=function(){};k.b2MixFriction=function(m,l){if(m===undefined){m=0}if(l===undefined){l=0}return Math.sqrt(m*l)};k.b2MixRestitution=function(l,m){if(l===undefined){l=0}if(m===undefined){m=0}return l>m?l:m};k.b2Assert=function(l){if(!l){throw"Assertion Failed"}};Box2D.postDefs.push(function(){Box2D.Common.b2Settings.VERSION="2.1alpha";Box2D.Common.b2Settings.USHRT_MAX=65535;Box2D.Common.b2Settings.b2_pi=Math.PI;Box2D.Common.b2Settings.b2_maxManifoldPoints=2;Box2D.Common.b2Settings.b2_aabbExtension=0.1;Box2D.Common.b2Settings.b2_aabbMultiplier=2;Box2D.Common.b2Settings.b2_polygonRadius=2*k.b2_linearSlop;Box2D.Common.b2Settings.b2_linearSlop=0.005;Box2D.Common.b2Settings.b2_angularSlop=2/180*k.b2_pi;Box2D.Common.b2Settings.b2_toiSlop=8*k.b2_linearSlop;Box2D.Common.b2Settings.b2_maxTOIContactsPerIsland=32;Box2D.Common.b2Settings.b2_maxTOIJointsPerIsland=32;Box2D.Common.b2Settings.b2_velocityThreshold=1;Box2D.Common.b2Settings.b2_maxLinearCorrection=0.2;Box2D.Common.b2Settings.b2_maxAngularCorrection=8/180*k.b2_pi;Box2D.Common.b2Settings.b2_maxTranslation=2;Box2D.Common.b2Settings.b2_maxTranslationSquared=k.b2_maxTranslation*k.b2_maxTranslation;Box2D.Common.b2Settings.b2_maxRotation=0.5*k.b2_pi;Box2D.Common.b2Settings.b2_maxRotationSquared=k.b2_maxRotation*k.b2_maxRotation;Box2D.Common.b2Settings.b2_contactBaumgarte=0.2;Box2D.Common.b2Settings.b2_timeToSleep=0.5;Box2D.Common.b2Settings.b2_linearSleepTolerance=0.01;Box2D.Common.b2Settings.b2_angularSleepTolerance=2/180*k.b2_pi})})();(function(){var a=Box2D.Collision.b2AABB,h=Box2D.Common.b2Color,e=Box2D.Common.b2internal,l=Box2D.Common.b2Settings,c=Box2D.Common.Math.b2Mat22,j=Box2D.Common.Math.b2Mat33,k=Box2D.Common.Math.b2Math,d=Box2D.Common.Math.b2Sweep,b=Box2D.Common.Math.b2Transform,g=Box2D.Common.Math.b2Vec2,f=Box2D.Common.Math.b2Vec3;c.b2Mat22=function(){this.col1=new g();this.col2=new g()};c.prototype.b2Mat22=function(){this.SetIdentity()};c.FromAngle=function(n){if(n===undefined){n=0}var m=new c();m.Set(n);return m};c.FromVV=function(o,n){var m=new c();m.SetVV(o,n);return m};c.prototype.Set=function(n){if(n===undefined){n=0}var o=Math.cos(n);var m=Math.sin(n);this.col1.x=o;this.col2.x=(-m);this.col1.y=m;this.col2.y=o};c.prototype.SetVV=function(n,m){this.col1.SetV(n);this.col2.SetV(m)};c.prototype.Copy=function(){var m=new c();m.SetM(this);return m};c.prototype.SetM=function(n){this.col1.SetV(n.col1);this.col2.SetV(n.col2)};c.prototype.AddM=function(n){this.col1.x+=n.col1.x;this.col1.y+=n.col1.y;this.col2.x+=n.col2.x;this.col2.y+=n.col2.y};c.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col1.y=0;this.col2.y=1};c.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col1.y=0;this.col2.y=0};c.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)};c.prototype.GetInverse=function(o){var n=this.col1.x;var m=this.col2.x;var r=this.col1.y;var q=this.col2.y;var p=n*q-m*r;if(p!=0){p=1/p}o.col1.x=p*q;o.col2.x=(-p*m);o.col1.y=(-p*r);o.col2.y=p*n;return o};c.prototype.Solve=function(q,t,s){if(t===undefined){t=0}if(s===undefined){s=0}var n=this.col1.x;var m=this.col2.x;var p=this.col1.y;var o=this.col2.y;var r=n*o-m*p;if(r!=0){r=1/r}q.x=r*(o*t-m*s);q.y=r*(n*s-p*t);return q};c.prototype.Abs=function(){this.col1.Abs();this.col2.Abs()};j.b2Mat33=function(){this.col1=new f();this.col2=new f();this.col3=new f()};j.prototype.b2Mat33=function(o,n,m){if(o===undefined){o=null}if(n===undefined){n=null}if(m===undefined){m=null}if(!o&&!n&&!m){this.col1.SetZero();this.col2.SetZero();this.col3.SetZero()}else{this.col1.SetV(o);this.col2.SetV(n);this.col3.SetV(m)}};j.prototype.SetVVV=function(o,n,m){this.col1.SetV(o);this.col2.SetV(n);this.col3.SetV(m)};j.prototype.Copy=function(){return new j(this.col1,this.col2,this.col3)};j.prototype.SetM=function(n){this.col1.SetV(n.col1);this.col2.SetV(n.col2);this.col3.SetV(n.col3)};j.prototype.AddM=function(n){this.col1.x+=n.col1.x;this.col1.y+=n.col1.y;this.col1.z+=n.col1.z;this.col2.x+=n.col2.x;this.col2.y+=n.col2.y;this.col2.z+=n.col2.z;this.col3.x+=n.col3.x;this.col3.y+=n.col3.y;this.col3.z+=n.col3.z};j.prototype.SetIdentity=function(){this.col1.x=1;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=1;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=1};j.prototype.SetZero=function(){this.col1.x=0;this.col2.x=0;this.col3.x=0;this.col1.y=0;this.col2.y=0;this.col3.y=0;this.col1.z=0;this.col2.z=0;this.col3.z=0};j.prototype.Solve22=function(q,t,s){if(t===undefined){t=0}if(s===undefined){s=0}var n=this.col1.x;var m=this.col2.x;var p=this.col1.y;var o=this.col2.y;var r=n*o-m*p;if(r!=0){r=1/r}q.x=r*(o*t-m*s);q.y=r*(n*s-p*t);return q};j.prototype.Solve33=function(r,n,m,z){if(n===undefined){n=0}if(m===undefined){m=0}if(z===undefined){z=0}var y=this.col1.x;var v=this.col1.y;var q=this.col1.z;var x=this.col2.x;var t=this.col2.y;var p=this.col2.z;var w=this.col3.x;var s=this.col3.y;var o=this.col3.z;var u=y*(t*o-p*s)+v*(p*w-x*o)+q*(x*s-t*w);if(u!=0){u=1/u}r.x=u*(n*(t*o-p*s)+m*(p*w-x*o)+z*(x*s-t*w));r.y=u*(y*(m*o-z*s)+v*(z*w-n*o)+q*(n*s-m*w));r.z=u*(y*(t*z-p*m)+v*(p*n-x*z)+q*(x*m-t*n));return r};k.b2Math=function(){};k.IsValid=function(m){if(m===undefined){m=0}return isFinite(m)};k.Dot=function(n,m){return n.x*m.x+n.y*m.y};k.CrossVV=function(n,m){return n.x*m.y-n.y*m.x};k.CrossVF=function(m,o){if(o===undefined){o=0}var n=new g(o*m.y,(-o*m.x));return n};k.CrossFV=function(o,m){if(o===undefined){o=0}var n=new g((-o*m.y),o*m.x);return n};k.MulMV=function(m,n){var o=new g(m.col1.x*n.x+m.col2.x*n.y,m.col1.y*n.x+m.col2.y*n.y);return o};k.MulTMV=function(m,n){var o=new g(k.Dot(n,m.col1),k.Dot(n,m.col2));return o};k.MulX=function(o,n){var m=k.MulMV(o.R,n);m.x+=o.position.x;m.y+=o.position.y;return m};k.MulXT=function(p,o){var n=k.SubtractVV(o,p.position);var m=(n.x*p.R.col1.x+n.y*p.R.col1.y);n.y=(n.x*p.R.col2.x+n.y*p.R.col2.y);n.x=m;return n};k.AddVV=function(n,m){var o=new g(n.x+m.x,n.y+m.y);return o};k.SubtractVV=function(n,m){var o=new g(n.x-m.x,n.y-m.y);return o};k.Distance=function(n,m){var p=n.x-m.x;var o=n.y-m.y;return Math.sqrt(p*p+o*o)};k.DistanceSquared=function(n,m){var p=n.x-m.x;var o=n.y-m.y;return(p*p+o*o)};k.MulFV=function(o,m){if(o===undefined){o=0}var n=new g(o*m.x,o*m.y);return n};k.AddMM=function(m,o){var n=c.FromVV(k.AddVV(m.col1,o.col1),k.AddVV(m.col2,o.col2));return n};k.MulMM=function(m,o){var n=c.FromVV(k.MulMV(m,o.col1),k.MulMV(m,o.col2));return n};k.MulTMM=function(m,q){var o=new g(k.Dot(m.col1,q.col1),k.Dot(m.col2,q.col1));var n=new g(k.Dot(m.col1,q.col2),k.Dot(m.col2,q.col2));var p=c.FromVV(o,n);return p};k.Abs=function(m){if(m===undefined){m=0}return m>0?m:(-m)};k.AbsV=function(n){var m=new g(k.Abs(n.x),k.Abs(n.y));return m};k.AbsM=function(m){var n=c.FromVV(k.AbsV(m.col1),k.AbsV(m.col2));return n};k.Min=function(n,m){if(n===undefined){n=0}if(m===undefined){m=0}return n<m?n:m};k.MinV=function(n,m){var o=new g(k.Min(n.x,m.x),k.Min(n.y,m.y));return o};k.Max=function(n,m){if(n===undefined){n=0}if(m===undefined){m=0}return n>m?n:m};k.MaxV=function(n,m){var o=new g(k.Max(n.x,m.x),k.Max(n.y,m.y));return o};k.Clamp=function(n,m,o){if(n===undefined){n=0}if(m===undefined){m=0}if(o===undefined){o=0}return n<m?m:n>o?o:n};k.ClampV=function(n,m,o){return k.MaxV(m,k.MinV(n,o))};k.Swap=function(n,m){var o=n[0];n[0]=m[0];m[0]=o};k.Random=function(){return Math.random()*2-1};k.RandomRange=function(n,m){if(n===undefined){n=0}if(m===undefined){m=0}var o=Math.random();o=(m-n)*o+n;return o};k.NextPowerOfTwo=function(m){if(m===undefined){m=0}m|=(m>>1)&2147483647;m|=(m>>2)&1073741823;m|=(m>>4)&268435455;m|=(m>>8)&16777215;m|=(m>>16)&65535;return m+1};k.IsPowerOfTwo=function(n){if(n===undefined){n=0}var m=n>0&&(n&(n-1))==0;return m};Box2D.postDefs.push(function(){Box2D.Common.Math.b2Math.b2Vec2_zero=new g(0,0);Box2D.Common.Math.b2Math.b2Mat22_identity=c.FromVV(new g(1,0),new g(0,1));Box2D.Common.Math.b2Math.b2Transform_identity=new b(k.b2Vec2_zero,k.b2Mat22_identity)});d.b2Sweep=function(){this.localCenter=new g();this.c0=new g;this.c=new g()};d.prototype.Set=function(m){this.localCenter.SetV(m.localCenter);this.c0.SetV(m.c0);this.c.SetV(m.c);this.a0=m.a0;this.a=m.a;this.t0=m.t0};d.prototype.Copy=function(){var m=new d();m.localCenter.SetV(this.localCenter);m.c0.SetV(this.c0);m.c.SetV(this.c);m.a0=this.a0;m.a=this.a;m.t0=this.t0;return m};d.prototype.GetTransform=function(n,o){if(o===undefined){o=0}n.position.x=(1-o)*this.c0.x+o*this.c.x;n.position.y=(1-o)*this.c0.y+o*this.c.y;var p=(1-o)*this.a0+o*this.a;n.R.Set(p);var m=n.R;n.position.x-=(m.col1.x*this.localCenter.x+m.col2.x*this.localCenter.y);n.position.y-=(m.col1.y*this.localCenter.x+m.col2.y*this.localCenter.y)};d.prototype.Advance=function(m){if(m===undefined){m=0}if(this.t0<m&&1-this.t0>Number.MIN_VALUE){var n=(m-this.t0)/(1-this.t0);this.c0.x=(1-n)*this.c0.x+n*this.c.x;this.c0.y=(1-n)*this.c0.y+n*this.c.y;this.a0=(1-n)*this.a0+n*this.a;this.t0=m}};b.b2Transform=function(){this.position=new g;this.R=new c()};b.prototype.b2Transform=function(n,m){if(n===undefined){n=null}if(m===undefined){m=null}if(n){this.position.SetV(n);this.R.SetM(m)}};b.prototype.Initialize=function(n,m){this.position.SetV(n);this.R.SetM(m)};b.prototype.SetIdentity=function(){this.position.SetZero();this.R.SetIdentity()};b.prototype.Set=function(m){this.position.SetV(m.position);this.R.SetM(m.R)};b.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)};g.b2Vec2=function(){};g.prototype.b2Vec2=function(m,n){if(m===undefined){m=0}if(n===undefined){n=0}this.x=m;this.y=n};g.prototype.SetZero=function(){this.x=0;this.y=0};g.prototype.Set=function(m,n){if(m===undefined){m=0}if(n===undefined){n=0}this.x=m;this.y=n};g.prototype.SetV=function(m){this.x=m.x;this.y=m.y};g.prototype.GetNegative=function(){return new g((-this.x),(-this.y))};g.prototype.NegativeSelf=function(){this.x=(-this.x);this.y=(-this.y)};g.Make=function(m,n){if(m===undefined){m=0}if(n===undefined){n=0}return new g(m,n)};g.prototype.Copy=function(){return new g(this.x,this.y)};g.prototype.Add=function(m){this.x+=m.x;this.y+=m.y};g.prototype.Subtract=function(m){this.x-=m.x;this.y-=m.y};g.prototype.Multiply=function(m){if(m===undefined){m=0}this.x*=m;this.y*=m};g.prototype.MulM=function(n){var m=this.x;this.x=n.col1.x*m+n.col2.x*this.y;this.y=n.col1.y*m+n.col2.y*this.y};g.prototype.MulTM=function(n){var m=k.Dot(this,n.col1);this.y=k.Dot(this,n.col2);this.x=m};g.prototype.CrossVF=function(n){if(n===undefined){n=0}var m=this.x;this.x=n*this.y;this.y=(-n*m)};g.prototype.CrossFV=function(n){if(n===undefined){n=0}var m=this.x;this.x=(-n*this.y);this.y=n*m};g.prototype.MinV=function(m){this.x=this.x<m.x?this.x:m.x;this.y=this.y<m.y?this.y:m.y};g.prototype.MaxV=function(m){this.x=this.x>m.x?this.x:m.x;this.y=this.y>m.y?this.y:m.y};g.prototype.Abs=function(){if(this.x<0){this.x=(-this.x)}if(this.y<0){this.y=(-this.y)}};g.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};g.prototype.LengthSquared=function(){return(this.x*this.x+this.y*this.y)};g.prototype.Normalize=function(){var n=Math.sqrt(this.x*this.x+this.y*this.y);if(n<Number.MIN_VALUE){return 0}var m=1/n;this.x*=m;this.y*=m;return n};g.prototype.IsValid=function(){return k.IsValid(this.x)&&k.IsValid(this.y)};f.b2Vec3=function(){};f.prototype.b2Vec3=function(m,o,n){if(m===undefined){m=0}if(o===undefined){o=0}if(n===undefined){n=0}this.x=m;this.y=o;this.z=n};f.prototype.SetZero=function(){this.x=this.y=this.z=0};f.prototype.Set=function(m,o,n){if(m===undefined){m=0}if(o===undefined){o=0}if(n===undefined){n=0}this.x=m;this.y=o;this.z=n};f.prototype.SetV=function(m){this.x=m.x;this.y=m.y;this.z=m.z};f.prototype.GetNegative=function(){return new f((-this.x),(-this.y),(-this.z))};f.prototype.NegativeSelf=function(){this.x=(-this.x);this.y=(-this.y);this.z=(-this.z)};f.prototype.Copy=function(){return new f(this.x,this.y,this.z)};f.prototype.Add=function(m){this.x+=m.x;this.y+=m.y;this.z+=m.z};f.prototype.Subtract=function(m){this.x-=m.x;this.y-=m.y;this.z-=m.z};f.prototype.Multiply=function(m){if(m===undefined){m=0}this.x*=m;this.y*=m;this.z*=m}})();(function(){var ad=Box2D.Dynamics.Controllers.b2ControllerEdge,P=Box2D.Common.Math.b2Mat22,s=Box2D.Common.Math.b2Mat33,aa=Box2D.Common.Math.b2Math,ar=Box2D.Common.Math.b2Sweep,g=Box2D.Common.Math.b2Transform,aq=Box2D.Common.Math.b2Vec2,ao=Box2D.Common.Math.b2Vec3,am=Box2D.Common.b2Color,aN=Box2D.Common.b2internal,z=Box2D.Common.b2Settings,ab=Box2D.Collision.b2AABB,az=Box2D.Collision.b2Bound,aO=Box2D.Collision.b2BoundValues,D=Box2D.Collision.b2Collision,F=Box2D.Collision.b2ContactID,ag=Box2D.Collision.b2ContactPoint,aD=Box2D.Collision.b2Distance,h=Box2D.Collision.b2DistanceInput,p=Box2D.Collision.b2DistanceOutput,S=Box2D.Collision.b2DistanceProxy,m=Box2D.Collision.b2DynamicTree,aL=Box2D.Collision.b2DynamicTreeBroadPhase,ay=Box2D.Collision.b2DynamicTreeNode,Q=Box2D.Collision.b2DynamicTreePair,R=Box2D.Collision.b2Manifold,L=Box2D.Collision.b2ManifoldPoint,U=Box2D.Collision.b2Point,Y=Box2D.Collision.b2RayCastInput,n=Box2D.Collision.b2RayCastOutput,j=Box2D.Collision.b2Segment,aB=Box2D.Collision.b2SeparationFunction,aJ=Box2D.Collision.b2Simplex,B=Box2D.Collision.b2SimplexCache,aS=Box2D.Collision.b2SimplexVertex,ap=Box2D.Collision.b2TimeOfImpact,aG=Box2D.Collision.b2TOIInput,aK=Box2D.Collision.b2WorldManifold,aE=Box2D.Collision.ClipVertex,Z=Box2D.Collision.Features,ax=Box2D.Collision.IBroadPhase,aP=Box2D.Collision.Shapes.b2CircleShape,e=Box2D.Collision.Shapes.b2EdgeChainDef,aI=Box2D.Collision.Shapes.b2EdgeShape,af=Box2D.Collision.Shapes.b2MassData,aH=Box2D.Collision.Shapes.b2PolygonShape,at=Box2D.Collision.Shapes.b2Shape,H=Box2D.Dynamics.b2Body,o=Box2D.Dynamics.b2BodyDef,aj=Box2D.Dynamics.b2ContactFilter,ah=Box2D.Dynamics.b2ContactImpulse,y=Box2D.Dynamics.b2ContactListener,C=Box2D.Dynamics.b2ContactManager,N=Box2D.Dynamics.b2DebugDraw,a=Box2D.Dynamics.b2PaperDraw,E=Box2D.Dynamics.b2DestructionListener,aA=Box2D.Dynamics.b2FilterData,aM=Box2D.Dynamics.b2Fixture,b=Box2D.Dynamics.b2FixtureDef,aQ=Box2D.Dynamics.b2Island,v=Box2D.Dynamics.b2TimeStep,t=Box2D.Dynamics.b2World,f=Box2D.Dynamics.Contacts.b2CircleContact,u=Box2D.Dynamics.Contacts.b2Contact,M=Box2D.Dynamics.Contacts.b2ContactConstraint,T=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,c=Box2D.Dynamics.Contacts.b2ContactEdge,aw=Box2D.Dynamics.Contacts.b2ContactFactory,l=Box2D.Dynamics.Contacts.b2ContactRegister,w=Box2D.Dynamics.Contacts.b2ContactResult,W=Box2D.Dynamics.Contacts.b2ContactSolver,aW=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,r=Box2D.Dynamics.Contacts.b2NullContact,av=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,A=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,V=Box2D.Dynamics.Contacts.b2PolygonContact,au=Box2D.Dynamics.Contacts.b2PositionSolverManifold,ak=Box2D.Dynamics.Controllers.b2Controller,I=Box2D.Dynamics.Joints.b2DistanceJoint,aF=Box2D.Dynamics.Joints.b2DistanceJointDef,q=Box2D.Dynamics.Joints.b2FrictionJoint,aV=Box2D.Dynamics.Joints.b2FrictionJointDef,x=Box2D.Dynamics.Joints.b2GearJoint,K=Box2D.Dynamics.Joints.b2GearJointDef,aU=Box2D.Dynamics.Joints.b2Jacobian,ae=Box2D.Dynamics.Joints.b2Joint,an=Box2D.Dynamics.Joints.b2JointDef,al=Box2D.Dynamics.Joints.b2JointEdge,k=Box2D.Dynamics.Joints.b2LineJoint,aC=Box2D.Dynamics.Joints.b2LineJointDef,aT=Box2D.Dynamics.Joints.b2MouseJoint,J=Box2D.Dynamics.Joints.b2MouseJointDef,aR=Box2D.Dynamics.Joints.b2PrismaticJoint,ac=Box2D.Dynamics.Joints.b2PrismaticJointDef,aX=Box2D.Dynamics.Joints.b2PulleyJoint,X=Box2D.Dynamics.Joints.b2PulleyJointDef,d=Box2D.Dynamics.Joints.b2RevoluteJoint,G=Box2D.Dynamics.Joints.b2RevoluteJointDef,ai=Box2D.Dynamics.Joints.b2WeldJoint,O=Box2D.Dynamics.Joints.b2WeldJointDef;H.b2Body=function(){this.m_xf=new g();this.m_sweep=new ar();this.m_linearVelocity=new aq();this.m_force=new aq()};H.prototype.connectEdges=function(a2,a1,a5){if(a5===undefined){a5=0}var a4=Math.atan2(a1.GetDirectionVector().y,a1.GetDirectionVector().x);var aZ=Math.tan((a4-a5)*0.5);var aY=aa.MulFV(aZ,a1.GetDirectionVector());aY=aa.SubtractVV(aY,a1.GetNormalVector());aY=aa.MulFV(z.b2_toiSlop,aY);aY=aa.AddVV(aY,a1.GetVertex1());var a3=aa.AddVV(a2.GetDirectionVector(),a1.GetDirectionVector());a3.Normalize();var a0=aa.Dot(a2.GetDirectionVector(),a1.GetNormalVector())>0;a2.SetNextEdge(a1,aY,a3,a0);a1.SetPrevEdge(a2,aY,a3,a0);return a4};H.prototype.CreateFixture=function(a0){if(this.m_world.IsLocked()==true){return null}var aZ=new aM();aZ.Create(this,this.m_xf,a0);if(this.m_flags&H.e_activeFlag){var aY=this.m_world.m_contactManager.m_broadPhase;aZ.CreateProxy(aY,this.m_xf)}aZ.m_next=this.m_fixtureList;this.m_fixtureList=aZ;++this.m_fixtureCount;aZ.m_body=this;if(aZ.m_density>0){this.ResetMassData()}this.m_world.m_flags|=t.e_newFixture;return aZ};H.prototype.CreateFixture2=function(aZ,aY){if(aY===undefined){aY=0}var a0=new b();a0.shape=aZ;a0.density=aY;return this.CreateFixture(a0)};H.prototype.DestroyFixture=function(aZ){if(this.m_world.IsLocked()==true){return}var a0=this.m_fixtureList;var a1=null;var a6=false;while(a0!=null){if(a0==aZ){if(a1){a1.m_next=aZ.m_next}else{this.m_fixtureList=aZ.m_next}a6=true;break}a1=a0;a0=a0.m_next}var aY=this.m_contactList;while(aY){var a5=aY.contact;aY=aY.next;var a4=a5.GetFixtureA();var a3=a5.GetFixtureB();if(aZ==a4||aZ==a3){this.m_world.m_contactManager.Destroy(a5)}}if(this.m_flags&H.e_activeFlag){var a2=this.m_world.m_contactManager.m_broadPhase;aZ.DestroyProxy(a2)}else{}aZ.Destroy();aZ.m_body=null;aZ.m_next=null;--this.m_fixtureCount;this.ResetMassData()};H.prototype.SetPositionAndAngle=function(aZ,a3){if(a3===undefined){a3=0}var a2;if(this.m_world.IsLocked()==true){return}this.m_xf.R.Set(a3);this.m_xf.position.SetV(aZ);var a1=this.m_xf.R;var a0=this.m_sweep.localCenter;this.m_sweep.c.x=(a1.col1.x*a0.x+a1.col2.x*a0.y);this.m_sweep.c.y=(a1.col1.y*a0.x+a1.col2.y*a0.y);this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_sweep.a0=this.m_sweep.a=a3;var aY=this.m_world.m_contactManager.m_broadPhase;for(a2=this.m_fixtureList;a2;a2=a2.m_next){a2.Synchronize(aY,this.m_xf,this.m_xf)}this.m_world.m_contactManager.FindNewContacts()};H.prototype.SetTransform=function(aY){this.SetPositionAndAngle(aY.position,aY.GetAngle())};H.prototype.GetTransform=function(){return this.m_xf};H.prototype.GetPosition=function(){return this.m_xf.position};H.prototype.SetPosition=function(aY){this.SetPositionAndAngle(aY,this.GetAngle())};H.prototype.GetAngle=function(){return this.m_sweep.a};H.prototype.SetAngle=function(aY){if(aY===undefined){aY=0}this.SetPositionAndAngle(this.GetPosition(),aY)};H.prototype.GetWorldCenter=function(){return this.m_sweep.c};H.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter};H.prototype.SetLinearVelocity=function(aY){if(this.m_type==H.b2_staticBody){return}this.m_linearVelocity.SetV(aY)};H.prototype.GetLinearVelocity=function(){return this.m_linearVelocity};H.prototype.SetAngularVelocity=function(aY){if(aY===undefined){aY=0}if(this.m_type==H.b2_staticBody){return}this.m_angularVelocity=aY};H.prototype.GetAngularVelocity=function(){return this.m_angularVelocity};H.prototype.GetDefinition=function(){var aY=new o();aY.type=this.GetType();aY.allowSleep=(this.m_flags&H.e_allowSleepFlag)==H.e_allowSleepFlag;aY.angle=this.GetAngle();aY.angularDamping=this.m_angularDamping;aY.angularVelocity=this.m_angularVelocity;aY.fixedRotation=(this.m_flags&H.e_fixedRotationFlag)==H.e_fixedRotationFlag;aY.bullet=(this.m_flags&H.e_bulletFlag)==H.e_bulletFlag;aY.awake=(this.m_flags&H.e_awakeFlag)==H.e_awakeFlag;aY.linearDamping=this.m_linearDamping;aY.linearVelocity.SetV(this.GetLinearVelocity());aY.position=this.GetPosition();aY.userData=this.GetUserData();return aY};H.prototype.ApplyForce=function(aZ,aY){if(this.m_type!=H.b2_dynamicBody){return}if(this.IsAwake()==false){this.SetAwake(true)}this.m_force.x+=aZ.x;this.m_force.y+=aZ.y;this.m_torque+=((aY.x-this.m_sweep.c.x)*aZ.y-(aY.y-this.m_sweep.c.y)*aZ.x)};H.prototype.ApplyTorque=function(aY){if(aY===undefined){aY=0}if(this.m_type!=H.b2_dynamicBody){return}if(this.IsAwake()==false){this.SetAwake(true)}this.m_torque+=aY};H.prototype.ApplyImpulse=function(aZ,aY){if(this.m_type!=H.b2_dynamicBody){return}if(this.IsAwake()==false){this.SetAwake(true)}this.m_linearVelocity.x+=this.m_invMass*aZ.x;this.m_linearVelocity.y+=this.m_invMass*aZ.y;this.m_angularVelocity+=this.m_invI*((aY.x-this.m_sweep.c.x)*aZ.y-(aY.y-this.m_sweep.c.y)*aZ.x)};H.prototype.Split=function(a9){var a8=this.GetLinearVelocity().Copy();var a2=this.GetAngularVelocity();var a0=this.GetWorldCenter();var aZ=this;var ba=this.m_world.CreateBody(this.GetDefinition());var a3;for(var a7=aZ.m_fixtureList;a7;){if(a9(a7)){var a6=a7.m_next;if(a3){a3.m_next=a6}else{aZ.m_fixtureList=a6}aZ.m_fixtureCount--;a7.m_next=ba.m_fixtureList;ba.m_fixtureList=a7;ba.m_fixtureCount++;a7.m_body=ba;a7=a6}else{a3=a7;a7=a7.m_next}}aZ.ResetMassData();ba.ResetMassData();var a1=aZ.GetWorldCenter();var aY=ba.GetWorldCenter();var a5=aa.AddVV(a8,aa.CrossFV(a2,aa.SubtractVV(a1,a0)));var a4=aa.AddVV(a8,aa.CrossFV(a2,aa.SubtractVV(aY,a0)));aZ.SetLinearVelocity(a5);ba.SetLinearVelocity(a4);aZ.SetAngularVelocity(a2);ba.SetAngularVelocity(a2);aZ.SynchronizeFixtures();ba.SynchronizeFixtures();return ba};H.prototype.Merge=function(a5){var a4;for(a4=a5.m_fixtureList;a4;){var a3=a4.m_next;a5.m_fixtureCount--;a4.m_next=this.m_fixtureList;this.m_fixtureList=a4;this.m_fixtureCount++;a4.m_body=a8;a4=a3}aY.m_fixtureCount=0;var aY=this;var a8=a5;var a0=aY.GetWorldCenter();var aZ=a8.GetWorldCenter();var a2=aY.GetLinearVelocity().Copy();var a1=a8.GetLinearVelocity().Copy();var a7=aY.GetAngularVelocity();var a6=a8.GetAngularVelocity();aY.ResetMassData();this.SynchronizeFixtures()};H.prototype.GetMass=function(){return this.m_mass};H.prototype.GetInertia=function(){return this.m_I};H.prototype.GetMassData=function(aY){aY.mass=this.m_mass;aY.I=this.m_I;aY.center.SetV(this.m_sweep.localCenter)};H.prototype.SetMassData=function(aY){z.b2Assert(this.m_world.IsLocked()==false);if(this.m_world.IsLocked()==true){return}if(this.m_type!=H.b2_dynamicBody){return}this.m_invMass=0;this.m_I=0;this.m_invI=0;this.m_mass=aY.mass;if(this.m_mass<=0){this.m_mass=1}this.m_invMass=1/this.m_mass;if(aY.I>0&&(this.m_flags&H.e_fixedRotationFlag)==0){this.m_I=aY.I-this.m_mass*(aY.center.x*aY.center.x+aY.center.y*aY.center.y);this.m_invI=1/this.m_I}var aZ=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(aY.center);this.m_sweep.c0.SetV(aa.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*(-(this.m_sweep.c.y-aZ.y));this.m_linearVelocity.y+=this.m_angularVelocity*(+(this.m_sweep.c.x-aZ.x))};H.prototype.ResetMassData=function(){this.m_mass=0;this.m_invMass=0;this.m_I=0;this.m_invI=0;this.m_sweep.localCenter.SetZero();if(this.m_type==H.b2_staticBody||this.m_type==H.b2_kinematicBody){return}var aY=aq.Make(0,0);for(var a0=this.m_fixtureList;a0;a0=a0.m_next){if(a0.m_density==0){continue}var aZ=a0.GetMassData();this.m_mass+=aZ.mass;aY.x+=aZ.center.x*aZ.mass;aY.y+=aZ.center.y*aZ.mass;this.m_I+=aZ.I}if(this.m_mass>0){this.m_invMass=1/this.m_mass;aY.x*=this.m_invMass;aY.y*=this.m_invMass}else{this.m_mass=1;this.m_invMass=1}if(this.m_I>0&&(this.m_flags&H.e_fixedRotationFlag)==0){this.m_I-=this.m_mass*(aY.x*aY.x+aY.y*aY.y);this.m_I*=this.m_inertiaScale;z.b2Assert(this.m_I>0);this.m_invI=1/this.m_I}else{this.m_I=0;this.m_invI=0}var a1=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(aY);this.m_sweep.c0.SetV(aa.MulX(this.m_xf,this.m_sweep.localCenter));this.m_sweep.c.SetV(this.m_sweep.c0);this.m_linearVelocity.x+=this.m_angularVelocity*(-(this.m_sweep.c.y-a1.y));this.m_linearVelocity.y+=this.m_angularVelocity*(+(this.m_sweep.c.x-a1.x))};H.prototype.GetWorldPoint=function(a0){var aY=this.m_xf.R;var aZ=new aq(aY.col1.x*a0.x+aY.col2.x*a0.y,aY.col1.y*a0.x+aY.col2.y*a0.y);aZ.x+=this.m_xf.position.x;aZ.y+=this.m_xf.position.y;return aZ};H.prototype.GetWorldVector=function(aY){return aa.MulMV(this.m_xf.R,aY)};H.prototype.GetLocalPoint=function(aY){return aa.MulXT(this.m_xf,aY)};H.prototype.GetLocalVector=function(aY){return aa.MulTMV(this.m_xf.R,aY)};H.prototype.GetLinearVelocityFromWorldPoint=function(aY){return new aq(this.m_linearVelocity.x-this.m_angularVelocity*(aY.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(aY.x-this.m_sweep.c.x))};H.prototype.GetLinearVelocityFromLocalPoint=function(a0){var aY=this.m_xf.R;var aZ=new aq(aY.col1.x*a0.x+aY.col2.x*a0.y,aY.col1.y*a0.x+aY.col2.y*a0.y);aZ.x+=this.m_xf.position.x;aZ.y+=this.m_xf.position.y;return new aq(this.m_linearVelocity.x-this.m_angularVelocity*(aZ.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(aZ.x-this.m_sweep.c.x))};H.prototype.GetLinearDamping=function(){return this.m_linearDamping};H.prototype.SetLinearDamping=function(aY){if(aY===undefined){aY=0}this.m_linearDamping=aY};H.prototype.GetAngularDamping=function(){return this.m_angularDamping};H.prototype.SetAngularDamping=function(aY){if(aY===undefined){aY=0}this.m_angularDamping=aY};H.prototype.SetType=function(aY){if(aY===undefined){aY=0}if(this.m_type==aY){return}this.m_type=aY;this.ResetMassData();if(this.m_type==H.b2_staticBody){this.m_linearVelocity.SetZero();this.m_angularVelocity=0}this.SetAwake(true);this.m_force.SetZero();this.m_torque=0;for(var aZ=this.m_contactList;aZ;aZ=aZ.next){aZ.contact.FlagForFiltering()}};H.prototype.GetType=function(){return this.m_type};H.prototype.SetBullet=function(aY){if(aY){this.m_flags|=H.e_bulletFlag}else{this.m_flags&=~H.e_bulletFlag}};H.prototype.IsBullet=function(){return(this.m_flags&H.e_bulletFlag)==H.e_bulletFlag};H.prototype.SetSleepingAllowed=function(aY){if(aY){this.m_flags|=H.e_allowSleepFlag}else{this.m_flags&=~H.e_allowSleepFlag;this.SetAwake(true)}};H.prototype.SetAwake=function(aY){if(aY){this.m_flags|=H.e_awakeFlag;this.m_sleepTime=0}else{this.m_flags&=~H.e_awakeFlag;this.m_sleepTime=0;this.m_linearVelocity.SetZero();this.m_angularVelocity=0;this.m_force.SetZero();this.m_torque=0}};H.prototype.IsAwake=function(){return(this.m_flags&H.e_awakeFlag)==H.e_awakeFlag};H.prototype.SetFixedRotation=function(aY){if(aY){this.m_flags|=H.e_fixedRotationFlag}else{this.m_flags&=~H.e_fixedRotationFlag}this.ResetMassData()};H.prototype.IsFixedRotation=function(){return(this.m_flags&H.e_fixedRotationFlag)==H.e_fixedRotationFlag};H.prototype.SetActive=function(aZ){if(aZ==this.IsActive()){return}var aY;var a0;if(aZ){this.m_flags|=H.e_activeFlag;aY=this.m_world.m_contactManager.m_broadPhase;for(a0=this.m_fixtureList;a0;a0=a0.m_next){a0.CreateProxy(aY,this.m_xf)}}else{this.m_flags&=~H.e_activeFlag;aY=this.m_world.m_contactManager.m_broadPhase;for(a0=this.m_fixtureList;a0;a0=a0.m_next){a0.DestroyProxy(aY)}var a1=this.m_contactList;while(a1){var a2=a1;a1=a1.next;this.m_world.m_contactManager.Destroy(a2.contact)}this.m_contactList=null}};H.prototype.IsActive=function(){return(this.m_flags&H.e_activeFlag)==H.e_activeFlag};H.prototype.IsSleepingAllowed=function(){return(this.m_flags&H.e_allowSleepFlag)==H.e_allowSleepFlag};H.prototype.GetFixtureList=function(){return this.m_fixtureList};H.prototype.GetJointList=function(){return this.m_jointList};H.prototype.GetControllerList=function(){return this.m_controllerList};H.prototype.GetContactList=function(){return this.m_contactList};H.prototype.GetNext=function(){return this.m_next};H.prototype.GetUserData=function(){return this.m_userData};H.prototype.SetUserData=function(aY){this.m_userData=aY};H.prototype.GetWorld=function(){return this.m_world};H.prototype.b2Body=function(a1,a0){this.m_flags=0;if(a1.bullet){this.m_flags|=H.e_bulletFlag}if(a1.fixedRotation){this.m_flags|=H.e_fixedRotationFlag}if(a1.allowSleep){this.m_flags|=H.e_allowSleepFlag}if(a1.awake){this.m_flags|=H.e_awakeFlag}if(a1.active){this.m_flags|=H.e_activeFlag}this.m_world=a0;this.m_xf.position.SetV(a1.position);this.m_xf.R.Set(a1.angle);this.m_sweep.localCenter.SetZero();this.m_sweep.t0=1;this.m_sweep.a0=this.m_sweep.a=a1.angle;var aZ=this.m_xf.R;var aY=this.m_sweep.localCenter;this.m_sweep.c.x=(aZ.col1.x*aY.x+aZ.col2.x*aY.y);this.m_sweep.c.y=(aZ.col1.y*aY.x+aZ.col2.y*aY.y);this.m_sweep.c.x+=this.m_xf.position.x;this.m_sweep.c.y+=this.m_xf.position.y;this.m_sweep.c0.SetV(this.m_sweep.c);this.m_jointList=null;this.m_controllerList=null;this.m_contactList=null;this.m_controllerCount=0;this.m_prev=null;this.m_next=null;this.m_linearVelocity.SetV(a1.linearVelocity);this.m_angularVelocity=a1.angularVelocity;this.m_linearDamping=a1.linearDamping;this.m_angularDamping=a1.angularDamping;this.m_force.Set(0,0);this.m_torque=0;this.m_sleepTime=0;this.m_type=a1.type;if(this.m_type==H.b2_dynamicBody){this.m_mass=1;this.m_invMass=1}else{this.m_mass=0;this.m_invMass=0}this.m_I=0;this.m_invI=0;this.m_inertiaScale=a1.inertiaScale;this.m_userData=a1.userData;this.m_fixtureList=null;this.m_fixtureCount=0};H.prototype.SynchronizeFixtures=function(){var a1=H.s_xf1;a1.R.Set(this.m_sweep.a0);var a0=a1.R;var aZ=this.m_sweep.localCenter;a1.position.x=this.m_sweep.c0.x-(a0.col1.x*aZ.x+a0.col2.x*aZ.y);a1.position.y=this.m_sweep.c0.y-(a0.col1.y*aZ.x+a0.col2.y*aZ.y);var a2;var aY=this.m_world.m_contactManager.m_broadPhase;for(a2=this.m_fixtureList;a2;a2=a2.m_next){a2.Synchronize(aY,a1,this.m_xf)}};H.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var aZ=this.m_xf.R;var aY=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(aZ.col1.x*aY.x+aZ.col2.x*aY.y);this.m_xf.position.y=this.m_sweep.c.y-(aZ.col1.y*aY.x+aZ.col2.y*aY.y)};H.prototype.ShouldCollide=function(aY){if(this.m_type!=H.b2_dynamicBody&&aY.m_type!=H.b2_dynamicBody){return false}for(var aZ=this.m_jointList;aZ;aZ=aZ.next){if(aZ.other==aY){if(aZ.joint.m_collideConnected==false){return false}}}return true};H.prototype.Advance=function(aY){if(aY===undefined){aY=0}this.m_sweep.Advance(aY);this.m_sweep.c.SetV(this.m_sweep.c0);this.m_sweep.a=this.m_sweep.a0;this.SynchronizeTransform()};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Body.s_xf1=new g();Box2D.Dynamics.b2Body.e_islandFlag=1;Box2D.Dynamics.b2Body.e_awakeFlag=2;Box2D.Dynamics.b2Body.e_allowSleepFlag=4;Box2D.Dynamics.b2Body.e_bulletFlag=8;Box2D.Dynamics.b2Body.e_fixedRotationFlag=16;Box2D.Dynamics.b2Body.e_activeFlag=32;Box2D.Dynamics.b2Body.b2_staticBody=0;Box2D.Dynamics.b2Body.b2_kinematicBody=1;Box2D.Dynamics.b2Body.b2_dynamicBody=2});o.b2BodyDef=function(){this.position=new aq();this.linearVelocity=new aq()};o.prototype.b2BodyDef=function(){this.userData=null;this.position.Set(0,0);this.angle=0;this.linearVelocity.Set(0,0);this.angularVelocity=0;this.linearDamping=0;this.angularDamping=0;this.allowSleep=true;this.awake=true;this.fixedRotation=false;this.bullet=false;this.type=H.b2_staticBody;this.active=true;this.inertiaScale=1};aj.b2ContactFilter=function(){};aj.prototype.ShouldCollide=function(aY,a2){var a0=aY.GetFilterData();var aZ=a2.GetFilterData();if(a0.groupIndex==aZ.groupIndex&&a0.groupIndex!=0){return a0.groupIndex>0}var a1=(a0.maskBits&aZ.categoryBits)!=0&&(a0.categoryBits&aZ.maskBits)!=0;return a1};aj.prototype.RayCollide=function(aY,aZ){if(!aY){return true}return this.ShouldCollide((aY instanceof aM?aY:null),aZ)};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactFilter.b2_defaultFilter=new aj()});ah.b2ContactImpulse=function(){this.normalImpulses=new Vector_a2j_Number(z.b2_maxManifoldPoints);this.tangentImpulses=new Vector_a2j_Number(z.b2_maxManifoldPoints)};y.b2ContactListener=function(){};y.prototype.BeginContact=function(aY){};y.prototype.EndContact=function(aY){};y.prototype.PreSolve=function(aY,aZ){};y.prototype.PostSolve=function(aY,aZ){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactListener.b2_defaultListener=new y()});C.b2ContactManager=function(){};C.prototype.b2ContactManager=function(){this.m_world=null;this.m_contactCount=0;this.m_contactFilter=aj.b2_defaultFilter;this.m_contactListener=y.b2_defaultListener;this.m_contactFactory=new aw(this.m_allocator);this.m_broadPhase=new aL()};C.prototype.AddPair=function(a0,aY){var a4=(a0 instanceof aM?a0:null);var a3=(aY instanceof aM?aY:null);var a2=a4.GetBody();var a1=a3.GetBody();if(a2==a1){return}var aZ=a1.GetContactList();while(aZ){if(aZ.other==a2){var a7=aZ.contact.GetFixtureA();var a5=aZ.contact.GetFixtureB();if(a7==a4&&a5==a3){return}if(a7==a3&&a5==a4){return}}aZ=aZ.next}if(a1.ShouldCollide(a2)==false){return}if(this.m_contactFilter.ShouldCollide(a4,a3)==false){return}var a6=this.m_contactFactory.Create(a4,a3);a4=a6.GetFixtureA();a3=a6.GetFixtureB();a2=a4.m_body;a1=a3.m_body;a6.m_prev=null;a6.m_next=this.m_world.m_contactList;if(this.m_world.m_contactList!=null){this.m_world.m_contactList.m_prev=a6}this.m_world.m_contactList=a6;a6.m_nodeA.contact=a6;a6.m_nodeA.other=a1;a6.m_nodeA.prev=null;a6.m_nodeA.next=a2.m_contactList;if(a2.m_contactList!=null){a2.m_contactList.prev=a6.m_nodeA}a2.m_contactList=a6.m_nodeA;a6.m_nodeB.contact=a6;a6.m_nodeB.other=a2;a6.m_nodeB.prev=null;a6.m_nodeB.next=a1.m_contactList;if(a1.m_contactList!=null){a1.m_contactList.prev=a6.m_nodeB}a1.m_contactList=a6.m_nodeB;++this.m_world.m_contactCount;return};C.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(Box2D.generateCallback(this,this.AddPair))};C.prototype.Destroy=function(a2){var aY=a2.GetFixtureA();var a1=a2.GetFixtureB();var a0=aY.GetBody();var aZ=a1.GetBody();if(a2.IsTouching()){this.m_contactListener.EndContact(a2)}if(a2.m_prev){a2.m_prev.m_next=a2.m_next}if(a2.m_next){a2.m_next.m_prev=a2.m_prev}if(a2==this.m_world.m_contactList){this.m_world.m_contactList=a2.m_next}if(a2.m_nodeA.prev){a2.m_nodeA.prev.next=a2.m_nodeA.next}if(a2.m_nodeA.next){a2.m_nodeA.next.prev=a2.m_nodeA.prev}if(a2.m_nodeA==a0.m_contactList){a0.m_contactList=a2.m_nodeA.next}if(a2.m_nodeB.prev){a2.m_nodeB.prev.next=a2.m_nodeB.next}if(a2.m_nodeB.next){a2.m_nodeB.next.prev=a2.m_nodeB.prev}if(a2.m_nodeB==aZ.m_contactList){aZ.m_contactList=a2.m_nodeB.next}this.m_contactFactory.Destroy(a2);--this.m_contactCount};C.prototype.Collide=function(){var a4=this.m_world.m_contactList;while(a4){var a2=a4.GetFixtureA();var a0=a4.GetFixtureB();var aZ=a2.GetBody();var aY=a0.GetBody();if(aZ.IsAwake()==false&&aY.IsAwake()==false){a4=a4.GetNext();continue}if(a4.m_flags&u.e_filterFlag){if(aY.ShouldCollide(aZ)==false){var a6=a4;a4=a6.GetNext();this.Destroy(a6);continue}if(this.m_contactFilter.ShouldCollide(a2,a0)==false){a6=a4;a4=a6.GetNext();this.Destroy(a6);continue}a4.m_flags&=~u.e_filterFlag}var a3=a2.m_proxy;var a1=a0.m_proxy;var a5=this.m_broadPhase.TestOverlap(a3,a1);if(a5==false){a6=a4;a4=a6.GetNext();this.Destroy(a6);continue}a4.Update(this.m_contactListener);a4=a4.GetNext()}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2ContactManager.s_evalCP=new ag()});N.b2DebugDraw=function(){};N.prototype.b2DebugDraw=function(){};N.prototype.SetFlags=function(aY){if(aY===undefined){aY=0}};N.prototype.GetFlags=function(){};N.prototype.AppendFlags=function(aY){if(aY===undefined){aY=0}};N.prototype.ClearFlags=function(aY){if(aY===undefined){aY=0}};N.prototype.SetSprite=function(aY){};N.prototype.GetSprite=function(){};N.prototype.SetDrawScale=function(aY){if(aY===undefined){aY=0}};N.prototype.GetDrawScale=function(){};N.prototype.SetLineThickness=function(aY){if(aY===undefined){aY=0}};N.prototype.GetLineThickness=function(){};N.prototype.SetAlpha=function(aY){if(aY===undefined){aY=0}};N.prototype.GetAlpha=function(){};N.prototype.SetFillAlpha=function(aY){if(aY===undefined){aY=0}};N.prototype.GetFillAlpha=function(){};N.prototype.SetXFormScale=function(aY){if(aY===undefined){aY=0}};N.prototype.GetXFormScale=function(){};N.prototype.DrawPolygon=function(aZ,a0,aY){if(a0===undefined){a0=0}};N.prototype.DrawSolidPolygon=function(aZ,a0,aY){if(a0===undefined){a0=0}};N.prototype.DrawCircle=function(aZ,aY,a0){if(aY===undefined){aY=0}};N.prototype.DrawSolidCircle=function(aZ,aY,a1,a0){if(aY===undefined){aY=0}};N.prototype.DrawSegment=function(a0,aZ,aY){};N.prototype.DrawTransform=function(aY){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2DebugDraw.e_shapeBit=1;Box2D.Dynamics.b2DebugDraw.e_jointBit=2;Box2D.Dynamics.b2DebugDraw.e_aabbBit=4;Box2D.Dynamics.b2DebugDraw.e_pairBit=8;Box2D.Dynamics.b2DebugDraw.e_centerOfMassBit=16;Box2D.Dynamics.b2DebugDraw.e_controllerBit=32});a.b2PaperDraw=function(){};a.prototype.b2PaperDraw=function(){};a.prototype.SetFlags=function(aY){if(aY===undefined){aY=0}};a.prototype.GetFlags=function(){};a.prototype.AppendFlags=function(aY){if(aY===undefined){aY=0}};a.prototype.ClearFlags=function(aY){if(aY===undefined){aY=0}};a.prototype.SetSprite=function(aY){};a.prototype.GetSprite=function(){};a.prototype.SetDrawScale=function(aY){if(aY===undefined){aY=0}};a.prototype.GetDrawScale=function(){};a.prototype.SetLineThickness=function(aY){if(aY===undefined){aY=0}};a.prototype.GetLineThickness=function(){};a.prototype.SetAlpha=function(aY){if(aY===undefined){aY=0}};a.prototype.GetXFormScale=function(){};a.prototype.DrawPolygon=function(aZ,a0,aY){if(a0===undefined){a0=0}};a.prototype.DrawSolidPolygon=function(aZ,a0,aY){if(a0===undefined){a0=0}};a.prototype.DrawCircle=function(aZ,aY,a0){if(aY===undefined){aY=0}};a.prototype.DrawSolidCircle=function(aZ,aY,a1,a0){if(aY===undefined){aY=0}};a.prototype.DrawSegment=function(a0,aZ,aY){};a.prototype.DrawTransform=function(aY){};Box2D.postDefs.push(function(){Box2D.Dynamics.b2PaperDraw.e_shapeBit=1;Box2D.Dynamics.b2PaperDraw.e_jointBit=2;Box2D.Dynamics.b2PaperDraw.e_aabbBit=4;Box2D.Dynamics.b2PaperDraw.e_pairBit=8;Box2D.Dynamics.b2PaperDraw.e_centerOfMassBit=16;Box2D.Dynamics.b2PaperDraw.e_controllerBit=32});E.b2DestructionListener=function(){};E.prototype.SayGoodbyeJoint=function(aY){};E.prototype.SayGoodbyeFixture=function(aY){};aA.b2FilterData=function(){this.categoryBits=1;this.maskBits=65535;this.groupIndex=0};aA.prototype.Copy=function(){var aY=new aA();aY.categoryBits=this.categoryBits;aY.maskBits=this.maskBits;aY.groupIndex=this.groupIndex;return aY};aM.b2Fixture=function(){this.m_filter=new aA()};aM.prototype.GetType=function(){return this.m_shape.GetType()};aM.prototype.GetShape=function(){return this.m_shape};aM.prototype.SetSensor=function(a1){if(this.m_isSensor==a1){return}this.m_isSensor=a1;if(this.m_body==null){return}var a0=this.m_body.GetContactList();while(a0){var aZ=a0.contact;var aY=aZ.GetFixtureA();var a2=aZ.GetFixtureB();if(aY==this||a2==this){aZ.SetSensor(aY.IsSensor()||a2.IsSensor())}a0=a0.next}};aM.prototype.IsSensor=function(){return this.m_isSensor};aM.prototype.SetFilterData=function(a0){this.m_filter=a0.Copy();if(this.m_body){return}var a1=this.m_body.GetContactList();while(a1){var aZ=a1.contact;var aY=aZ.GetFixtureA();var a2=aZ.GetFixtureB();if(aY==this||a2==this){aZ.FlagForFiltering()}a1=a1.next}};aM.prototype.GetFilterData=function(){return this.m_filter.Copy()};aM.prototype.GetBody=function(){return this.m_body};aM.prototype.GetNext=function(){return this.m_next};aM.prototype.GetUserData=function(){return this.m_userData};aM.prototype.SetUserData=function(aY){this.m_userData=aY};aM.prototype.TestPoint=function(aY){return this.m_shape.TestPoint(this.m_body.GetTransform(),aY)};aM.prototype.RayCast=function(aZ,aY){return this.m_shape.RayCast(aZ,aY,this.m_body.GetTransform())};aM.prototype.GetMassData=function(aY){if(aY===undefined){aY=null}if(aY==null){aY=new af()}this.m_shape.ComputeMass(aY,this.m_density);return aY};aM.prototype.SetDensity=function(aY){if(aY===undefined){aY=0}this.m_density=aY};aM.prototype.GetDensity=function(){return this.m_density};aM.prototype.GetFriction=function(){return this.m_friction};aM.prototype.SetFriction=function(aY){if(aY===undefined){aY=0}this.m_friction=aY};aM.prototype.GetRestitution=function(){return this.m_restitution};aM.prototype.SetRestitution=function(aY){if(aY===undefined){aY=0}this.m_restitution=aY};aM.prototype.GetAABB=function(){return this.m_aabb};aM.prototype.b2Fixture=function(){this.m_aabb=new ab();this.m_userData=null;this.m_body=null;this.m_next=null;this.m_shape=null;this.m_density=0;this.m_friction=0;this.m_restitution=0};aM.prototype.Create=function(aY,aZ,a0){this.m_userData=a0.userData;this.m_friction=a0.friction;this.m_restitution=a0.restitution;this.m_body=aY;this.m_next=null;this.m_filter=a0.filter.Copy();this.m_isSensor=a0.isSensor;this.m_shape=a0.shape.Copy();this.m_density=a0.density};aM.prototype.Destroy=function(){this.m_shape=null};aM.prototype.CreateProxy=function(aY,aZ){this.m_shape.ComputeAABB(this.m_aabb,aZ);this.m_proxy=aY.CreateProxy(this.m_aabb,this)};aM.prototype.DestroyProxy=function(aY){if(this.m_proxy==null){return}aY.DestroyProxy(this.m_proxy);this.m_proxy=null};aM.prototype.Synchronize=function(aZ,a3,a2){if(!this.m_proxy){return}var a0=new ab();var aY=new ab();this.m_shape.ComputeAABB(a0,a3);this.m_shape.ComputeAABB(aY,a2);this.m_aabb.Combine(a0,aY);var a1=aa.SubtractVV(a2.position,a3.position);aZ.MoveProxy(this.m_proxy,this.m_aabb,a1)};b.b2FixtureDef=function(){this.filter=new aA()};b.prototype.b2FixtureDef=function(){this.shape=null;this.userData=null;this.friction=0.2;this.restitution=0;this.density=0;this.filter.categoryBits=1;this.filter.maskBits=65535;this.filter.groupIndex=0;this.isSensor=false};aQ.b2Island=function(){};aQ.prototype.b2Island=function(){this.m_bodies=new Vector();this.m_contacts=new Vector();this.m_joints=new Vector()};aQ.prototype.Initialize=function(a4,a2,a1,aZ,a3,aY){if(a4===undefined){a4=0}if(a2===undefined){a2=0}if(a1===undefined){a1=0}var a0=0;this.m_bodyCapacity=a4;this.m_contactCapacity=a2;this.m_jointCapacity=a1;this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0;this.m_allocator=aZ;this.m_listener=a3;this.m_contactSolver=aY;for(a0=this.m_bodies.length;a0<a4;a0++){this.m_bodies[a0]=null}for(a0=this.m_contacts.length;a0<a2;a0++){this.m_contacts[a0]=null}for(a0=this.m_joints.length;a0<a1;a0++){this.m_joints[a0]=null}};aQ.prototype.Clear=function(){this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0};aQ.prototype.Solve=function(a0,be,a8){var a5=0;var a4=0;var bb;var a3;for(a5=0;a5<this.m_bodyCount;++a5){bb=this.m_bodies[a5];if(bb.GetType()!=H.b2_dynamicBody){continue}bb.m_linearVelocity.x+=a0.dt*(be.x+bb.m_invMass*bb.m_force.x);bb.m_linearVelocity.y+=a0.dt*(be.y+bb.m_invMass*bb.m_force.y);bb.m_angularVelocity+=a0.dt*bb.m_invI*bb.m_torque;bb.m_linearVelocity.Multiply(aa.Clamp(1-a0.dt*bb.m_linearDamping,0,1));bb.m_angularVelocity*=aa.Clamp(1-a0.dt*bb.m_angularDamping,0,1)}this.m_contactSolver.Initialize(a0,this.m_contacts,this.m_contactCount,this.m_allocator);var a1=this.m_contactSolver;a1.InitVelocityConstraints(a0);for(a5=0;a5<this.m_jointCount;++a5){a3=this.m_joints[a5];a3.InitVelocityConstraints(a0)}for(a5=0;a5<a0.velocityIterations;++a5){for(a4=0;a4<this.m_jointCount;++a4){a3=this.m_joints[a4];a3.SolveVelocityConstraints(a0)}a1.SolveVelocityConstraints()}for(a5=0;a5<this.m_jointCount;++a5){a3=this.m_joints[a5];a3.FinalizeVelocityConstraints()}a1.FinalizeVelocityConstraints();for(a5=0;a5<this.m_bodyCount;++a5){bb=this.m_bodies[a5];if(bb.GetType()==H.b2_staticBody){continue}var a9=a0.dt*bb.m_linearVelocity.x;var a7=a0.dt*bb.m_linearVelocity.y;if((a9*a9+a7*a7)>z.b2_maxTranslationSquared){bb.m_linearVelocity.Normalize();bb.m_linearVelocity.x*=z.b2_maxTranslation*a0.inv_dt;bb.m_linearVelocity.y*=z.b2_maxTranslation*a0.inv_dt}var bd=a0.dt*bb.m_angularVelocity;if(bd*bd>z.b2_maxRotationSquared){if(bb.m_angularVelocity<0){bb.m_angularVelocity=(-z.b2_maxRotation*a0.inv_dt)}else{bb.m_angularVelocity=z.b2_maxRotation*a0.inv_dt}}bb.m_sweep.c0.SetV(bb.m_sweep.c);bb.m_sweep.a0=bb.m_sweep.a;bb.m_sweep.c.x+=a0.dt*bb.m_linearVelocity.x;bb.m_sweep.c.y+=a0.dt*bb.m_linearVelocity.y;bb.m_sweep.a+=a0.dt*bb.m_angularVelocity;bb.SynchronizeTransform()}for(a5=0;a5<a0.positionIterations;++a5){var a6=a1.SolvePositionConstraints(z.b2_contactBaumgarte);var ba=true;for(a4=0;a4<this.m_jointCount;++a4){a3=this.m_joints[a4];var aZ=a3.SolvePositionConstraints(z.b2_contactBaumgarte);ba=ba&&aZ}if(a6&&ba){break}}this.Report(a1.m_constraints);if(a8){var a2=Number.MAX_VALUE;var aY=z.b2_linearSleepTolerance*z.b2_linearSleepTolerance;var bc=z.b2_angularSleepTolerance*z.b2_angularSleepTolerance;for(a5=0;a5<this.m_bodyCount;++a5){bb=this.m_bodies[a5];if(bb.GetType()==H.b2_staticBody){continue}if((bb.m_flags&H.e_allowSleepFlag)==0){bb.m_sleepTime=0;a2=0}if((bb.m_flags&H.e_allowSleepFlag)==0||bb.m_angularVelocity*bb.m_angularVelocity>bc||aa.Dot(bb.m_linearVelocity,bb.m_linearVelocity)>aY){bb.m_sleepTime=0;a2=0}else{bb.m_sleepTime+=a0.dt;a2=aa.Min(a2,bb.m_sleepTime)}}if(a2>=z.b2_timeToSleep){for(a5=0;a5<this.m_bodyCount;++a5){bb=this.m_bodies[a5];bb.SetAwake(false)}}}};aQ.prototype.SolveTOI=function(a1){var a2=0;var a0=0;this.m_contactSolver.Initialize(a1,this.m_contacts,this.m_contactCount,this.m_allocator);var aZ=this.m_contactSolver;for(a2=0;a2<this.m_jointCount;++a2){this.m_joints[a2].InitVelocityConstraints(a1)}for(a2=0;a2<a1.velocityIterations;++a2){aZ.SolveVelocityConstraints();for(a0=0;a0<this.m_jointCount;++a0){this.m_joints[a0].SolveVelocityConstraints(a1)}}for(a2=0;a2<this.m_bodyCount;++a2){var a7=this.m_bodies[a2];if(a7.GetType()==H.b2_staticBody){continue}var a5=a1.dt*a7.m_linearVelocity.x;var a4=a1.dt*a7.m_linearVelocity.y;if((a5*a5+a4*a4)>z.b2_maxTranslationSquared){a7.m_linearVelocity.Normalize();a7.m_linearVelocity.x*=z.b2_maxTranslation*a1.inv_dt;a7.m_linearVelocity.y*=z.b2_maxTranslation*a1.inv_dt}var a9=a1.dt*a7.m_angularVelocity;if(a9*a9>z.b2_maxRotationSquared){if(a7.m_angularVelocity<0){a7.m_angularVelocity=(-z.b2_maxRotation*a1.inv_dt)}else{a7.m_angularVelocity=z.b2_maxRotation*a1.inv_dt}}a7.m_sweep.c0.SetV(a7.m_sweep.c);a7.m_sweep.a0=a7.m_sweep.a;a7.m_sweep.c.x+=a1.dt*a7.m_linearVelocity.x;a7.m_sweep.c.y+=a1.dt*a7.m_linearVelocity.y;a7.m_sweep.a+=a1.dt*a7.m_angularVelocity;a7.SynchronizeTransform()}var a8=0.75;for(a2=0;a2<a1.positionIterations;++a2){var a3=aZ.SolvePositionConstraints(a8);var a6=true;for(a0=0;a0<this.m_jointCount;++a0){var aY=this.m_joints[a0].SolvePositionConstraints(z.b2_contactBaumgarte);a6=a6&&aY}if(a3&&a6){break}}this.Report(aZ.m_constraints)};aQ.prototype.Report=function(a2){if(this.m_listener==null){return}for(var aZ=0;aZ<this.m_contactCount;++aZ){var a1=this.m_contacts[aZ];var a0=a2[aZ];for(var aY=0;aY<a0.pointCount;++aY){aQ.s_impulse.normalImpulses[aY]=a0.points[aY].normalImpulse;aQ.s_impulse.tangentImpulses[aY]=a0.points[aY].tangentImpulse}this.m_listener.PostSolve(a1,aQ.s_impulse)}};aQ.prototype.AddBody=function(aY){aY.m_islandIndex=this.m_bodyCount;this.m_bodies[this.m_bodyCount++]=aY};aQ.prototype.AddContact=function(aY){this.m_contacts[this.m_contactCount++]=aY};aQ.prototype.AddJoint=function(aY){this.m_joints[this.m_jointCount++]=aY};Box2D.postDefs.push(function(){Box2D.Dynamics.b2Island.s_impulse=new ah()});v.b2TimeStep=function(){};v.prototype.Set=function(aY){this.dt=aY.dt;this.inv_dt=aY.inv_dt;this.positionIterations=aY.positionIterations;this.velocityIterations=aY.velocityIterations;this.warmStarting=aY.warmStarting};t.b2World=function(){this.s_stack=new Vector();this.m_contactManager=new C();this.m_contactSolver=new W();this.m_island=new aQ()};t.prototype.b2World=function(a0,aZ){this.m_destructionListener=null;this.m_debugDraw=null;this.m_bodyList=null;this.m_contactList=null;this.m_jointList=null;this.m_controllerList=null;this.m_bodyCount=0;this.m_contactCount=0;this.m_jointCount=0;this.m_controllerCount=0;t.m_warmStarting=true;t.m_continuousPhysics=true;this.m_allowSleep=aZ;this.m_gravity=a0;this.m_inv_dt0=0;this.m_contactManager.m_world=this;var aY=new o();this.m_groundBody=this.CreateBody(aY)};t.prototype.SetDestructionListener=function(aY){this.m_destructionListener=aY};t.prototype.SetContactFilter=function(aY){this.m_contactManager.m_contactFilter=aY};t.prototype.SetContactListener=function(aY){this.m_contactManager.m_contactListener=aY};t.prototype.SetDebugDraw=function(aY){this.m_debugDraw=aY};t.prototype.SetBroadPhase=function(aZ){var a0=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=aZ;for(var aY=this.m_bodyList;aY;aY=aY.m_next){for(var a1=aY.m_fixtureList;a1;a1=a1.m_next){a1.m_proxy=aZ.CreateProxy(a0.GetFatAABB(a1.m_proxy),a1)}}};t.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()};t.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()};t.prototype.CreateBody=function(aZ){if(this.IsLocked()==true){return null}var aY=new H(aZ,this);aY.m_prev=null;aY.m_next=this.m_bodyList;if(this.m_bodyList){this.m_bodyList.m_prev=aY}this.m_bodyList=aY;++this.m_bodyCount;return aY};t.prototype.DestroyBody=function(a6){if(this.IsLocked()==true){return}var a1=a6.m_jointList;while(a1){var a5=a1;a1=a1.next;if(this.m_destructionListener){this.m_destructionListener.SayGoodbyeJoint(a5.joint)}this.DestroyJoint(a5.joint)}var a3=a6.m_controllerList;while(a3){var aY=a3;a3=a3.nextController;aY.controller.RemoveBody(a6)}var aZ=a6.m_contactList;while(aZ){var a0=aZ;aZ=aZ.next;this.m_contactManager.Destroy(a0.contact)}a6.m_contactList=null;var a4=a6.m_fixtureList;while(a4){var a2=a4;a4=a4.m_next;if(this.m_destructionListener){this.m_destructionListener.SayGoodbyeFixture(a2)}a2.DestroyProxy(this.m_contactManager.m_broadPhase);a2.Destroy()}a6.m_fixtureList=null;a6.m_fixtureCount=0;if(a6.m_prev){a6.m_prev.m_next=a6.m_next}if(a6.m_next){a6.m_next.m_prev=a6.m_prev}if(a6==this.m_bodyList){this.m_bodyList=a6.m_next}--this.m_bodyCount};t.prototype.CreateJoint=function(a0){var aY=ae.Create(a0,null);aY.m_prev=null;aY.m_next=this.m_jointList;if(this.m_jointList){this.m_jointList.m_prev=aY}this.m_jointList=aY;++this.m_jointCount;aY.m_edgeA.joint=aY;aY.m_edgeA.other=aY.m_bodyB;aY.m_edgeA.prev=null;aY.m_edgeA.next=aY.m_bodyA.m_jointList;if(aY.m_bodyA.m_jointList){aY.m_bodyA.m_jointList.prev=aY.m_edgeA}aY.m_bodyA.m_jointList=aY.m_edgeA;aY.m_edgeB.joint=aY;aY.m_edgeB.other=aY.m_bodyA;aY.m_edgeB.prev=null;aY.m_edgeB.next=aY.m_bodyB.m_jointList;if(aY.m_bodyB.m_jointList){aY.m_bodyB.m_jointList.prev=aY.m_edgeB}aY.m_bodyB.m_jointList=aY.m_edgeB;var a2=a0.bodyA;var a1=a0.bodyB;if(a0.collideConnected==false){var aZ=a1.GetContactList();while(aZ){if(aZ.other==a2){aZ.contact.FlagForFiltering()}aZ=aZ.next}}return aY};t.prototype.DestroyJoint=function(aY){var a0=aY.m_collideConnected;if(aY.m_prev){aY.m_prev.m_next=aY.m_next}if(aY.m_next){aY.m_next.m_prev=aY.m_prev}if(aY==this.m_jointList){this.m_jointList=aY.m_next}var a2=aY.m_bodyA;var a1=aY.m_bodyB;a2.SetAwake(true);a1.SetAwake(true);if(aY.m_edgeA.prev){aY.m_edgeA.prev.next=aY.m_edgeA.next}if(aY.m_edgeA.next){aY.m_edgeA.next.prev=aY.m_edgeA.prev}if(aY.m_edgeA==a2.m_jointList){a2.m_jointList=aY.m_edgeA.next}aY.m_edgeA.prev=null;aY.m_edgeA.next=null;if(aY.m_edgeB.prev){aY.m_edgeB.prev.next=aY.m_edgeB.next}if(aY.m_edgeB.next){aY.m_edgeB.next.prev=aY.m_edgeB.prev}if(aY.m_edgeB==a1.m_jointList){a1.m_jointList=aY.m_edgeB.next}aY.m_edgeB.prev=null;aY.m_edgeB.next=null;ae.Destroy(aY,null);--this.m_jointCount;if(a0==false){var aZ=a1.GetContactList();while(aZ){if(aZ.other==a2){aZ.contact.FlagForFiltering()}aZ=aZ.next}}};t.prototype.AddController=function(aY){aY.m_next=this.m_controllerList;aY.m_prev=null;this.m_controllerList=aY;aY.m_world=this;this.m_controllerCount++;return aY};t.prototype.RemoveController=function(aY){if(aY.m_prev){aY.m_prev.m_next=aY.m_next}if(aY.m_next){aY.m_next.m_prev=aY.m_prev}if(this.m_controllerList==aY){this.m_controllerList=aY.m_next}this.m_controllerCount--};t.prototype.CreateController=function(aY){if(aY.m_world!=this){throw new Error("Controller can only be a member of one world")}aY.m_next=this.m_controllerList;aY.m_prev=null;if(this.m_controllerList){this.m_controllerList.m_prev=aY}this.m_controllerList=aY;++this.m_controllerCount;aY.m_world=this;return aY};t.prototype.DestroyController=function(aY){aY.Clear();if(aY.m_next){aY.m_next.m_prev=aY.m_prev}if(aY.m_prev){aY.m_prev.m_next=aY.m_next}if(aY==this.m_controllerList){this.m_controllerList=aY.m_next}--this.m_controllerCount};t.prototype.SetWarmStarting=function(aY){t.m_warmStarting=aY};t.prototype.SetContinuousPhysics=function(aY){t.m_continuousPhysics=aY};t.prototype.GetBodyCount=function(){return this.m_bodyCount};t.prototype.GetJointCount=function(){return this.m_jointCount};t.prototype.GetContactCount=function(){return this.m_contactCount};t.prototype.SetGravity=function(aY){this.m_gravity=aY};t.prototype.GetGravity=function(){return this.m_gravity};t.prototype.GetGroundBody=function(){return this.m_groundBody};t.prototype.Step=function(aZ,a1,a0){if(aZ===undefined){aZ=0}if(a1===undefined){a1=0}if(a0===undefined){a0=0}if(this.m_flags&t.e_newFixture){this.m_contactManager.FindNewContacts();this.m_flags&=~t.e_newFixture}this.m_flags|=t.e_locked;var aY=t.s_timestep2;aY.dt=aZ;aY.velocityIterations=a1;aY.positionIterations=a0;if(aZ>0){aY.inv_dt=1/aZ}else{aY.inv_dt=0}aY.dtRatio=this.m_inv_dt0*aZ;aY.warmStarting=t.m_warmStarting;this.m_contactManager.Collide();if(aY.dt>0){this.Solve(aY)}if(t.m_continuousPhysics&&aY.dt>0){this.SolveTOI(aY)}if(aY.dt>0){this.m_inv_dt0=aY.inv_dt}this.m_flags&=~t.e_locked};t.prototype.ClearForces=function(){for(var aY=this.m_bodyList;aY;aY=aY.m_next){aY.m_force.SetZero();aY.m_torque=0}};t.prototype.DrawDebugData=function(){if(this.m_debugDraw==null){return}this.m_debugDraw.m_sprite.graphics.clear();var a0=this.m_debugDraw.GetFlags();var ba=0;var bf;var bd;var a4;var a8;var bi;var bg=new aq;var bc=new aq;var bb=new aq;var a5;var a2=new ab();var aZ=new ab();var a6=[new aq(),new aq(),new aq(),new aq()];var a7=new am(0,0,0);if(a0&N.e_shapeBit){for(bf=this.m_bodyList;bf;bf=bf.m_next){a5=bf.m_xf;for(bd=bf.GetFixtureList();bd;bd=bd.m_next){a4=bd.GetShape();if(bf.IsActive()==false){a7.Set(0.5,0.5,0.3);this.DrawShape(a4,a5,a7)}else{if(bf.GetType()==H.b2_staticBody){a7.Set(0.5,0.9,0.5);this.DrawShape(a4,a5,a7)}else{if(bf.GetType()==H.b2_kinematicBody){a7.Set(0.5,0.5,0.9);this.DrawShape(a4,a5,a7)}else{if(bf.IsAwake()==false){a7.Set(0.6,0.6,0.6);this.DrawShape(a4,a5,a7)}else{a7.Set(0.9,0.7,0.7);this.DrawShape(a4,a5,a7)}}}}}}}if(a0&N.e_jointBit){for(a8=this.m_jointList;a8;a8=a8.m_next){this.DrawJoint(a8)}}if(a0&N.e_controllerBit){for(var be=this.m_controllerList;be;be=be.m_next){be.Draw(this.m_debugDraw)}}if(a0&N.e_pairBit){a7.Set(0.3,0.9,0.9);for(var a9=this.m_contactManager.m_contactList;a9;a9=a9.GetNext()){var bj=a9.GetFixtureA();var bh=a9.GetFixtureB();var a1=bj.GetAABB().GetCenter();var aY=bh.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(a1,aY,a7)}}if(a0&N.e_aabbBit){bi=this.m_contactManager.m_broadPhase;a6=[new aq(),new aq(),new aq(),new aq()];for(bf=this.m_bodyList;bf;bf=bf.GetNext()){if(bf.IsActive()==false){continue}for(bd=bf.GetFixtureList();bd;bd=bd.GetNext()){var a3=bi.GetFatAABB(bd.m_proxy);a6[0].Set(a3.lowerBound.x,a3.lowerBound.y);a6[1].Set(a3.upperBound.x,a3.lowerBound.y);a6[2].Set(a3.upperBound.x,a3.upperBound.y);a6[3].Set(a3.lowerBound.x,a3.upperBound.y);this.m_debugDraw.DrawPolygon(a6,4,a7)}}}if(a0&N.e_centerOfMassBit){for(bf=this.m_bodyList;bf;bf=bf.m_next){a5=t.s_xf;a5.R=bf.m_xf.R;a5.position=bf.GetWorldCenter();this.m_debugDraw.DrawTransform(a5)}}};t.prototype.DrawPaperData=function(){if(this.m_paperDraw==null){return}this.m_paperDraw.m_sprite.graphics.clear();var a0=this.m_paperDraw.GetFlags();var ba=0;var bf;var bd;var a4;var a8;var bi;var bg=new aq;var bc=new aq;var bb=new aq;var a5;var a2=new ab();var aZ=new ab();var a6=[new aq(),new aq(),new aq(),new aq()];var a7=new am(0,0,0);if(a0&a.e_shapeBit){for(bf=this.m_bodyList;bf;bf=bf.m_next){a5=bf.m_xf;for(bd=bf.GetFixtureList();bd;bd=bd.m_next){a4=bd.GetShape();if(bf.IsActive()==false){a7.Set(0.5,0.5,0.3);this.DrawShape(a4,a5,a7)}else{if(bf.GetType()==H.b2_staticBody){a7.Set(0.5,0.9,0.5);this.DrawShape(a4,a5,a7)}else{if(bf.GetType()==H.b2_kinematicBody){a7.Set(0.5,0.5,0.9);this.DrawShape(a4,a5,a7)}else{if(bf.IsAwake()==false){a7.Set(0.6,0.6,0.6);this.DrawShape(a4,a5,a7)}else{a7.Set(0.9,0.7,0.7);this.DrawShape(a4,a5,a7)}}}}}}}if(a0&a.e_jointBit){for(a8=this.m_jointList;a8;a8=a8.m_next){this.DrawJoint(a8)}}if(a0&a.e_controllerBit){for(var be=this.m_controllerList;be;be=be.m_next){be.Draw(this.m_paperDraw)}}if(a0&a.e_pairBit){a7.Set(0.3,0.9,0.9);for(var a9=this.m_contactManager.m_contactList;a9;a9=a9.GetNext()){var bj=a9.GetFixtureA();var bh=a9.GetFixtureB();var a1=bj.GetAABB().GetCenter();var aY=bh.GetAABB().GetCenter();this.m_paperDraw.DrawSegment(a1,aY,a7)}}if(a0&a.e_aabbBit){bi=this.m_contactManager.m_broadPhase;a6=[new aq(),new aq(),new aq(),new aq()];for(bf=this.m_bodyList;bf;bf=bf.GetNext()){if(bf.IsActive()==false){continue}for(bd=bf.GetFixtureList();bd;bd=bd.GetNext()){var a3=bi.GetFatAABB(bd.m_proxy);a6[0].Set(a3.lowerBound.x,a3.lowerBound.y);a6[1].Set(a3.upperBound.x,a3.lowerBound.y);a6[2].Set(a3.upperBound.x,a3.upperBound.y);a6[3].Set(a3.lowerBound.x,a3.upperBound.y);this.m_paperDraw.DrawPolygon(a6,4,a7)}}}if(a0&a.e_centerOfMassBit){for(bf=this.m_bodyList;bf;bf=bf.m_next){a5=t.s_xf;a5.R=bf.m_xf.R;a5.position=bf.GetWorldCenter();this.m_paperDraw.DrawTransform(a5)}}};t.prototype.QueryAABB=function(a2,aZ){var a1=this;var aY=a1.m_contactManager.m_broadPhase;function a0(a3){return a2(aY.GetUserData(a3))}aY.Query(a0,aZ)};t.prototype.QueryShape=function(a4,a0,a2){var a3=this;if(a2===undefined){a2=null}if(a2==null){a2=new g();a2.SetIdentity()}var aY=a3.m_contactManager.m_broadPhase;function a1(a5){var a6=(aY.GetUserData(a5) instanceof aM?aY.GetUserData(a5):null);if(at.TestOverlap(a0,a2,a6.GetShape(),a6.GetBody().GetTransform())){return a4(a6)}return true}var aZ=new ab();a0.ComputeAABB(aZ,a2);aY.Query(a1,aZ)};t.prototype.QueryPoint=function(a3,a2){var a1=this;var aY=a1.m_contactManager.m_broadPhase;function a0(a4){var a5=(aY.GetUserData(a4) instanceof aM?aY.GetUserData(a4):null);if(a5.TestPoint(a2)){return a3(a5)}return true}var aZ=new ab();aZ.lowerBound.Set(a2.x-z.b2_linearSlop,a2.y-z.b2_linearSlop);aZ.upperBound.Set(a2.x+z.b2_linearSlop,a2.y+z.b2_linearSlop);aY.Query(a0,aZ)};t.prototype.RayCast=function(a5,a4,a2){var a3=this;var aY=a3.m_contactManager.m_broadPhase;var a1=new n;function a0(a8,a9){var a7=aY.GetUserData(a9);var bb=(a7 instanceof aM?a7:null);var bc=bb.RayCast(a1,a8);if(bc){var ba=a1.fraction;var a6=new aq((1-ba)*a4.x+ba*a2.x,(1-ba)*a4.y+ba*a2.y);return a5(bb,a6,a1.normal,ba)}return a8.maxFraction}var aZ=new Y(a4,a2);aY.RayCast(a0,aZ)};t.prototype.RayCastOne=function(a2,aZ){var a1=this;var aY;function a0(a5,a3,a6,a4){if(a4===undefined){a4=0}aY=a5;return a4}a1.RayCast(a0,a2,aZ);return aY};t.prototype.RayCastAll=function(a2,a0){var a1=this;var aY=new Vector();function aZ(a5,a3,a6,a4){if(a4===undefined){a4=0}aY[aY.length]=a5;return 1}a1.RayCast(aZ,a2,a0);return aY};t.prototype.GetBodyList=function(){return this.m_bodyList};t.prototype.GetJointList=function(){return this.m_jointList};t.prototype.GetContactList=function(){return this.m_contactList};t.prototype.IsLocked=function(){return(this.m_flags&t.e_locked)>0};t.prototype.Solve=function(aZ){var a8;for(var a4=this.m_controllerList;a4;a4=a4.m_next){a4.Step(aZ)}var a5=this.m_island;a5.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(a8=this.m_bodyList;a8;a8=a8.m_next){a8.m_flags&=~H.e_islandFlag}for(var a7=this.m_contactList;a7;a7=a7.m_next){a7.m_flags&=~u.e_islandFlag}for(var a1=this.m_jointList;a1;a1=a1.m_next){a1.m_islandFlag=false}var bb=parseInt(this.m_bodyCount);var a9=this.s_stack;for(var a3=this.m_bodyList;a3;a3=a3.m_next){if(a3.m_flags&H.e_islandFlag){continue}if(a3.IsAwake()==false||a3.IsActive()==false){continue}if(a3.GetType()==H.b2_staticBody){continue}a5.Clear();var ba=0;a9[ba++]=a3;a3.m_flags|=H.e_islandFlag;while(ba>0){a8=a9[--ba];a5.AddBody(a8);if(a8.IsAwake()==false){a8.SetAwake(true)}if(a8.GetType()==H.b2_staticBody){continue}var a6;for(var aY=a8.m_contactList;aY;aY=aY.next){if(aY.contact.m_flags&u.e_islandFlag){continue}if(aY.contact.IsSensor()==true||aY.contact.IsEnabled()==false||aY.contact.IsTouching()==false){continue}a5.AddContact(aY.contact);aY.contact.m_flags|=u.e_islandFlag;a6=aY.other;if(a6.m_flags&H.e_islandFlag){continue}a9[ba++]=a6;a6.m_flags|=H.e_islandFlag}for(var a0=a8.m_jointList;a0;a0=a0.next){if(a0.joint.m_islandFlag==true){continue}a6=a0.other;if(a6.IsActive()==false){continue}a5.AddJoint(a0.joint);a0.joint.m_islandFlag=true;if(a6.m_flags&H.e_islandFlag){continue}a9[ba++]=a6;a6.m_flags|=H.e_islandFlag}}a5.Solve(aZ,this.m_gravity,this.m_allowSleep);for(var a2=0;a2<a5.m_bodyCount;++a2){a8=a5.m_bodies[a2];if(a8.GetType()==H.b2_staticBody){a8.m_flags&=~H.e_islandFlag}}}for(a2=0;a2<a9.length;++a2){if(!a9[a2]){break}a9[a2]=null}for(a8=this.m_bodyList;a8;a8=a8.m_next){if(a8.IsAwake()==false||a8.IsActive()==false){continue}if(a8.GetType()==H.b2_staticBody){continue}a8.SynchronizeFixtures()}this.m_contactManager.FindNewContacts()};t.prototype.SolveTOI=function(a0){var bg;var a3;var a1;var bj;var bi;var a6;var a9;var bd=this.m_island;bd.Initialize(this.m_bodyCount,z.b2_maxTOIContactsPerIsland,z.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var a7=t.s_queue;for(bg=this.m_bodyList;bg;bg=bg.m_next){bg.m_flags&=~H.e_islandFlag;bg.m_sweep.t0=0}var be;for(be=this.m_contactList;be;be=be.m_next){be.m_flags&=~(u.e_toiFlag|u.e_islandFlag)}for(a9=this.m_jointList;a9;a9=a9.m_next){a9.m_islandFlag=false}for(;;){var a2=null;var a4=1;for(be=this.m_contactList;be;be=be.m_next){if(be.IsSensor()==true||be.IsEnabled()==false||be.IsContinuous()==false){continue}var a8=1;if(be.m_flags&u.e_toiFlag){a8=be.m_toi}else{a3=be.m_fixtureA;a1=be.m_fixtureB;bj=a3.m_body;bi=a1.m_body;if((bj.GetType()!=H.b2_dynamicBody||bj.IsAwake()==false)&&(bi.GetType()!=H.b2_dynamicBody||bi.IsAwake()==false)){continue}var a5=bj.m_sweep.t0;if(bj.m_sweep.t0<bi.m_sweep.t0){a5=bi.m_sweep.t0;bj.m_sweep.Advance(a5)}else{if(bi.m_sweep.t0<bj.m_sweep.t0){a5=bj.m_sweep.t0;bi.m_sweep.Advance(a5)}}a8=be.ComputeTOI(bj.m_sweep,bi.m_sweep);z.b2Assert(0<=a8&&a8<=1);if(a8>0&&a8<1){a8=(1-a8)*a5+a8;if(a8>1){a8=1}}be.m_toi=a8;be.m_flags|=u.e_toiFlag}if(Number.MIN_VALUE<a8&&a8<a4){a2=be;a4=a8}}if(a2==null||1-100*Number.MIN_VALUE<a4){break}a3=a2.m_fixtureA;a1=a2.m_fixtureB;bj=a3.m_body;bi=a1.m_body;t.s_backupA.Set(bj.m_sweep);t.s_backupB.Set(bi.m_sweep);bj.Advance(a4);bi.Advance(a4);a2.Update(this.m_contactManager.m_contactListener);a2.m_flags&=~u.e_toiFlag;if(a2.IsSensor()==true||a2.IsEnabled()==false){bj.m_sweep.Set(t.s_backupA);bi.m_sweep.Set(t.s_backupB);bj.SynchronizeTransform();bi.SynchronizeTransform();continue}if(a2.IsTouching()==false){continue}var aZ=bj;if(aZ.GetType()!=H.b2_dynamicBody){aZ=bi}bd.Clear();var ba=0;var bc=0;a7[ba+bc++]=aZ;aZ.m_flags|=H.e_islandFlag;while(bc>0){bg=a7[ba++];--bc;bd.AddBody(bg);if(bg.IsAwake()==false){bg.SetAwake(true)}if(bg.GetType()!=H.b2_dynamicBody){continue}for(a6=bg.m_contactList;a6;a6=a6.next){if(bd.m_contactCount==bd.m_contactCapacity){break}if(a6.contact.m_flags&u.e_islandFlag){continue}if(a6.contact.IsSensor()==true||a6.contact.IsEnabled()==false||a6.contact.IsTouching()==false){continue}bd.AddContact(a6.contact);a6.contact.m_flags|=u.e_islandFlag;var aY=a6.other;if(aY.m_flags&H.e_islandFlag){continue}if(aY.GetType()!=H.b2_staticBody){aY.Advance(a4);aY.SetAwake(true)}a7[ba+bc]=aY;++bc;aY.m_flags|=H.e_islandFlag}for(var bf=bg.m_jointList;bf;bf=bf.next){if(bd.m_jointCount==bd.m_jointCapacity){continue}if(bf.joint.m_islandFlag==true){continue}aY=bf.other;if(aY.IsActive()==false){continue}bd.AddJoint(bf.joint);bf.joint.m_islandFlag=true;if(aY.m_flags&H.e_islandFlag){continue}if(aY.GetType()!=H.b2_staticBody){aY.Advance(a4);aY.SetAwake(true)}a7[ba+bc]=aY;++bc;aY.m_flags|=H.e_islandFlag}}var bh=t.s_timestep;bh.warmStarting=false;bh.dt=(1-a4)*a0.dt;bh.inv_dt=1/bh.dt;bh.dtRatio=0;bh.velocityIterations=a0.velocityIterations;bh.positionIterations=a0.positionIterations;bd.SolveTOI(bh);var bb=0;for(bb=0;bb<bd.m_bodyCount;++bb){bg=bd.m_bodies[bb];bg.m_flags&=~H.e_islandFlag;if(bg.IsAwake()==false){continue}if(bg.GetType()!=H.b2_dynamicBody){continue}bg.SynchronizeFixtures();for(a6=bg.m_contactList;a6;a6=a6.next){a6.contact.m_flags&=~u.e_toiFlag}}for(bb=0;bb<bd.m_contactCount;++bb){be=bd.m_contacts[bb];be.m_flags&=~(u.e_toiFlag|u.e_islandFlag)}for(bb=0;bb<bd.m_jointCount;++bb){a9=bd.m_joints[bb];a9.m_islandFlag=false}this.m_contactManager.FindNewContacts()}};t.prototype.DrawJoint=function(a2){var a6=a2.GetBodyA();var a5=a2.GetBodyB();var a4=a6.m_xf;var a3=a5.m_xf;var a0=a4.position;var aZ=a3.position;var ba=a2.GetAnchorA();var a9=a2.GetAnchorB();var a1=t.s_jointColor;switch(a2.m_type){case ae.e_distanceJoint:this.m_debugDraw.DrawSegment(ba,a9,a1);break;case ae.e_pulleyJoint:var aY=((a2 instanceof aX?a2:null));var a8=aY.GetGroundAnchorA();var a7=aY.GetGroundAnchorB();this.m_debugDraw.DrawSegment(a8,ba,a1);this.m_debugDraw.DrawSegment(a7,a9,a1);this.m_debugDraw.DrawSegment(a8,a7,a1);break;case ae.e_mouseJoint:this.m_debugDraw.DrawSegment(ba,a9,a1);break;default:if(a6!=this.m_groundBody){this.m_debugDraw.DrawSegment(a0,ba,a1)}this.m_debugDraw.DrawSegment(ba,a9,a1);if(a5!=this.m_groundBody){this.m_debugDraw.DrawSegment(aZ,a9,a1)}}};t.prototype.DrawShape=function(a8,a9,a4){switch(a8.m_type){case at.e_circleShape:var a1=((a8 instanceof aP?a8:null));var aZ=aa.MulX(a9,a1.m_p);var a6=a1.m_radius;var a3=a9.R.col1;this.m_debugDraw.DrawSolidCircle(aZ,a6,a3,a4);break;case at.e_polygonShape:var a5=0;var a0=((a8 instanceof aH?a8:null));var aY=parseInt(a0.GetVertexCount());var ba=a0.GetVertices();var a7=new Vector(aY);for(a5=0;a5<aY;++a5){a7[a5]=aa.MulX(a9,ba[a5])}this.m_debugDraw.DrawSolidPolygon(a7,aY,a4);break;case at.e_edgeShape:var a2=(a8 instanceof aI?a8:null);this.m_debugDraw.DrawSegment(aa.MulX(a9,a2.GetVertex1()),aa.MulX(a9,a2.GetVertex2()),a4);break}};Box2D.postDefs.push(function(){Box2D.Dynamics.b2World.s_timestep2=new v();Box2D.Dynamics.b2World.s_xf=new g();Box2D.Dynamics.b2World.s_backupA=new ar();Box2D.Dynamics.b2World.s_backupB=new ar();Box2D.Dynamics.b2World.s_timestep=new v();Box2D.Dynamics.b2World.s_queue=new Vector();Box2D.Dynamics.b2World.s_jointColor=new am(0.5,0.8,0.8);Box2D.Dynamics.b2World.e_newFixture=1;Box2D.Dynamics.b2World.e_locked=2})})();(function(){var aw=Box2D.Collision.Shapes.b2CircleShape,d=Box2D.Collision.Shapes.b2EdgeChainDef,ao=Box2D.Collision.Shapes.b2EdgeShape,S=Box2D.Collision.Shapes.b2MassData,an=Box2D.Collision.Shapes.b2PolygonShape,ab=Box2D.Collision.Shapes.b2Shape,e=Box2D.Dynamics.Contacts.b2CircleContact,r=Box2D.Dynamics.Contacts.b2Contact,E=Box2D.Dynamics.Contacts.b2ContactConstraint,K=Box2D.Dynamics.Contacts.b2ContactConstraintPoint,c=Box2D.Dynamics.Contacts.b2ContactEdge,ae=Box2D.Dynamics.Contacts.b2ContactFactory,j=Box2D.Dynamics.Contacts.b2ContactRegister,t=Box2D.Dynamics.Contacts.b2ContactResult,N=Box2D.Dynamics.Contacts.b2ContactSolver,az=Box2D.Dynamics.Contacts.b2EdgeAndCircleContact,o=Box2D.Dynamics.Contacts.b2NullContact,ad=Box2D.Dynamics.Contacts.b2PolyAndCircleContact,w=Box2D.Dynamics.Contacts.b2PolyAndEdgeContact,M=Box2D.Dynamics.Contacts.b2PolygonContact,ac=Box2D.Dynamics.Contacts.b2PositionSolverManifold,C=Box2D.Dynamics.b2Body,m=Box2D.Dynamics.b2BodyDef,V=Box2D.Dynamics.b2ContactFilter,U=Box2D.Dynamics.b2ContactImpulse,u=Box2D.Dynamics.b2ContactListener,y=Box2D.Dynamics.b2ContactManager,F=Box2D.Dynamics.b2DebugDraw,a=Box2D.Dynamics.b2PaperDraw,A=Box2D.Dynamics.b2DestructionListener,ai=Box2D.Dynamics.b2FilterData,at=Box2D.Dynamics.b2Fixture,b=Box2D.Dynamics.b2FixtureDef,ax=Box2D.Dynamics.b2Island,s=Box2D.Dynamics.b2TimeStep,q=Box2D.Dynamics.b2World,W=Box2D.Common.b2Color,au=Box2D.Common.b2internal,v=Box2D.Common.b2Settings,G=Box2D.Common.Math.b2Mat22,p=Box2D.Common.Math.b2Mat33,Q=Box2D.Common.Math.b2Math,aa=Box2D.Common.Math.b2Sweep,f=Box2D.Common.Math.b2Transform,Z=Box2D.Common.Math.b2Vec2,X=Box2D.Common.Math.b2Vec3,R=Box2D.Collision.b2AABB,ah=Box2D.Collision.b2Bound,av=Box2D.Collision.b2BoundValues,z=Box2D.Collision.b2Collision,B=Box2D.Collision.b2ContactID,T=Box2D.Collision.b2ContactPoint,ak=Box2D.Collision.b2Distance,g=Box2D.Collision.b2DistanceInput,n=Box2D.Collision.b2DistanceOutput,J=Box2D.Collision.b2DistanceProxy,k=Box2D.Collision.b2DynamicTree,ar=Box2D.Collision.b2DynamicTreeBroadPhase,ag=Box2D.Collision.b2DynamicTreeNode,H=Box2D.Collision.b2DynamicTreePair,I=Box2D.Collision.b2Manifold,D=Box2D.Collision.b2ManifoldPoint,L=Box2D.Collision.b2Point,O=Box2D.Collision.b2RayCastInput,l=Box2D.Collision.b2RayCastOutput,h=Box2D.Collision.b2Segment,aj=Box2D.Collision.b2SeparationFunction,aq=Box2D.Collision.b2Simplex,x=Box2D.Collision.b2SimplexCache,ay=Box2D.Collision.b2SimplexVertex,Y=Box2D.Collision.b2TimeOfImpact,am=Box2D.Collision.b2TOIInput,ap=Box2D.Collision.b2WorldManifold,al=Box2D.Collision.ClipVertex,P=Box2D.Collision.Features,af=Box2D.Collision.IBroadPhase;Box2D.inherit(e,Box2D.Dynamics.Contacts.b2Contact);e.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;e.b2CircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};e.Create=function(aA){return new e()};e.Destroy=function(aA,aB){};e.prototype.Reset=function(aA,aB){this.__super.Reset.call(this,aA,aB)};e.prototype.Evaluate=function(){var aB=this.m_fixtureA.GetBody();var aA=this.m_fixtureB.GetBody();z.CollideCircles(this.m_manifold,(this.m_fixtureA.GetShape() instanceof aw?this.m_fixtureA.GetShape():null),aB.m_xf,(this.m_fixtureB.GetShape() instanceof aw?this.m_fixtureB.GetShape():null),aA.m_xf)};r.b2Contact=function(){this.m_nodeA=new c();this.m_nodeB=new c();this.m_manifold=new I();this.m_oldManifold=new I()};r.prototype.GetManifold=function(){return this.m_manifold};r.prototype.GetWorldManifold=function(aD){var aE=this.m_fixtureA.GetBody();var aC=this.m_fixtureB.GetBody();var aB=this.m_fixtureA.GetShape();var aA=this.m_fixtureB.GetShape();aD.Initialize(this.m_manifold,aE.GetTransform(),aB.m_radius,aC.GetTransform(),aA.m_radius)};r.prototype.IsTouching=function(){return(this.m_flags&r.e_touchingFlag)==r.e_touchingFlag};r.prototype.IsContinuous=function(){return(this.m_flags&r.e_continuousFlag)==r.e_continuousFlag};r.prototype.SetSensor=function(aA){if(aA){this.m_flags|=r.e_sensorFlag}else{this.m_flags&=~r.e_sensorFlag}};r.prototype.IsSensor=function(){return(this.m_flags&r.e_sensorFlag)==r.e_sensorFlag};r.prototype.SetEnabled=function(aA){if(aA){this.m_flags|=r.e_enabledFlag}else{this.m_flags&=~r.e_enabledFlag}};r.prototype.IsEnabled=function(){return(this.m_flags&r.e_enabledFlag)==r.e_enabledFlag};r.prototype.GetNext=function(){return this.m_next};r.prototype.GetFixtureA=function(){return this.m_fixtureA};r.prototype.GetFixtureB=function(){return this.m_fixtureB};r.prototype.FlagForFiltering=function(){this.m_flags|=r.e_filterFlag};r.prototype.b2Contact=function(){};r.prototype.Reset=function(aA,aD){if(aA===undefined){aA=null}if(aD===undefined){aD=null}this.m_flags=r.e_enabledFlag;if(!aA||!aD){this.m_fixtureA=null;this.m_fixtureB=null;return}if(aA.IsSensor()||aD.IsSensor()){this.m_flags|=r.e_sensorFlag}var aC=aA.GetBody();var aB=aD.GetBody();if(aC.GetType()!=C.b2_dynamicBody||aC.IsBullet()||aB.GetType()!=C.b2_dynamicBody||aB.IsBullet()){this.m_flags|=r.e_continuousFlag}this.m_fixtureA=aA;this.m_fixtureB=aD;this.m_manifold.m_pointCount=0;this.m_prev=null;this.m_next=null;this.m_nodeA.contact=null;this.m_nodeA.prev=null;this.m_nodeA.next=null;this.m_nodeA.other=null;this.m_nodeB.contact=null;this.m_nodeB.prev=null;this.m_nodeB.next=null;this.m_nodeB.other=null};r.prototype.Update=function(aB){var aA=this.m_oldManifold;this.m_oldManifold=this.m_manifold;this.m_manifold=aA;this.m_flags|=r.e_enabledFlag;var aK=false;var aP=(this.m_flags&r.e_touchingFlag)==r.e_touchingFlag;var aF=this.m_fixtureA.m_body;var aD=this.m_fixtureB.m_body;var aM=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&r.e_sensorFlag){if(aM){var aE=this.m_fixtureA.GetShape();var aC=this.m_fixtureB.GetShape();var aN=aF.GetTransform();var aL=aD.GetTransform();aK=ab.TestOverlap(aE,aN,aC,aL)}this.m_manifold.m_pointCount=0}else{if(aF.GetType()!=C.b2_dynamicBody||aF.IsBullet()||aD.GetType()!=C.b2_dynamicBody||aD.IsBullet()){this.m_flags|=r.e_continuousFlag}else{this.m_flags&=~r.e_continuousFlag}if(aM){this.Evaluate();aK=this.m_manifold.m_pointCount>0;for(var aH=0;aH<this.m_manifold.m_pointCount;++aH){var aI=this.m_manifold.m_points[aH];aI.m_normalImpulse=0;aI.m_tangentImpulse=0;var aO=aI.m_id;for(var aG=0;aG<this.m_oldManifold.m_pointCount;++aG){var aJ=this.m_oldManifold.m_points[aG];if(aJ.m_id.key==aO.key){aI.m_normalImpulse=aJ.m_normalImpulse;aI.m_tangentImpulse=aJ.m_tangentImpulse;break}}}}else{this.m_manifold.m_pointCount=0}if(aK!=aP){aF.SetAwake(true);aD.SetAwake(true)}}if(aK){this.m_flags|=r.e_touchingFlag}else{this.m_flags&=~r.e_touchingFlag}if(aP==false&&aK==true){aB.BeginContact(this)}if(aP==true&&aK==false){aB.EndContact(this)}if((this.m_flags&r.e_sensorFlag)==0){aB.PreSolve(this,this.m_oldManifold)}};r.prototype.Evaluate=function(){};r.prototype.ComputeTOI=function(aB,aA){r.s_input.proxyA.Set(this.m_fixtureA.GetShape());r.s_input.proxyB.Set(this.m_fixtureB.GetShape());r.s_input.sweepA=aB;r.s_input.sweepB=aA;r.s_input.tolerance=v.b2_linearSlop;return Y.TimeOfImpact(r.s_input)};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2Contact.e_sensorFlag=1;Box2D.Dynamics.Contacts.b2Contact.e_continuousFlag=2;Box2D.Dynamics.Contacts.b2Contact.e_islandFlag=4;Box2D.Dynamics.Contacts.b2Contact.e_toiFlag=8;Box2D.Dynamics.Contacts.b2Contact.e_touchingFlag=16;Box2D.Dynamics.Contacts.b2Contact.e_enabledFlag=32;Box2D.Dynamics.Contacts.b2Contact.e_filterFlag=64;Box2D.Dynamics.Contacts.b2Contact.s_input=new am()});E.b2ContactConstraint=function(){this.localPlaneNormal=new Z();this.localPoint=new Z();this.normal=new Z();this.normalMass=new G();this.K=new G()};E.prototype.b2ContactConstraint=function(){this.points=new Vector(v.b2_maxManifoldPoints);for(var aA=0;aA<v.b2_maxManifoldPoints;aA++){this.points[aA]=new K()}};K.b2ContactConstraintPoint=function(){this.localPoint=new Z();this.rA=new Z();this.rB=new Z()};c.b2ContactEdge=function(){};ae.b2ContactFactory=function(){};ae.prototype.b2ContactFactory=function(aA){this.m_allocator=aA;this.InitializeRegisters()};ae.prototype.AddType=function(aC,aD,aB,aA){if(aB===undefined){aB=0}if(aA===undefined){aA=0}this.m_registers[aB][aA].createFcn=aC;this.m_registers[aB][aA].destroyFcn=aD;this.m_registers[aB][aA].primary=true;if(aB!=aA){this.m_registers[aA][aB].createFcn=aC;this.m_registers[aA][aB].destroyFcn=aD;this.m_registers[aA][aB].primary=false}};ae.prototype.InitializeRegisters=function(){this.m_registers=new Vector(ab.e_shapeTypeCount);for(var aB=0;aB<ab.e_shapeTypeCount;aB++){this.m_registers[aB]=new Vector(ab.e_shapeTypeCount);for(var aA=0;aA<ab.e_shapeTypeCount;aA++){this.m_registers[aB][aA]=new j()}}this.AddType(e.Create,e.Destroy,ab.e_circleShape,ab.e_circleShape);this.AddType(ad.Create,ad.Destroy,ab.e_polygonShape,ab.e_circleShape);this.AddType(M.Create,M.Destroy,ab.e_polygonShape,ab.e_polygonShape);this.AddType(az.Create,az.Destroy,ab.e_edgeShape,ab.e_circleShape);this.AddType(w.Create,w.Destroy,ab.e_polygonShape,ab.e_edgeShape)};ae.prototype.Create=function(aA,aG){var aC=parseInt(aA.GetType());var aB=parseInt(aG.GetType());var aE=this.m_registers[aC][aB];var aF;if(aE.pool){aF=aE.pool;aE.pool=aF.m_next;aE.poolCount--;aF.Reset(aA,aG);return aF}var aD=aE.createFcn;if(aD!=null){if(aE.primary){aF=aD(this.m_allocator);aF.Reset(aA,aG);return aF}else{aF=aD(this.m_allocator);aF.Reset(aG,aA);return aF}}else{return null}};ae.prototype.Destroy=function(aA){if(aA.m_manifold.m_pointCount>0){aA.m_fixtureA.m_body.SetAwake(true);aA.m_fixtureB.m_body.SetAwake(true)}var aC=parseInt(aA.m_fixtureA.GetType());var aB=parseInt(aA.m_fixtureB.GetType());var aD=this.m_registers[aC][aB];if(true){aD.poolCount++;aA.m_next=aD.pool;aD.pool=aA}var aE=aD.destroyFcn;aE(aA,this.m_allocator)};j.b2ContactRegister=function(){};t.b2ContactResult=function(){this.position=new Z();this.normal=new Z();this.id=new B()};N.b2ContactSolver=function(){this.m_step=new s();this.m_constraints=new Vector()};N.prototype.b2ContactSolver=function(){};N.prototype.Initialize=function(bg,a1,a2,aR){if(a2===undefined){a2=0}var aW;this.m_step.Set(bg);this.m_allocator=aR;var bv=0;var bk;var bp;this.m_constraintCount=a2;while(this.m_constraints.length<this.m_constraintCount){this.m_constraints[this.m_constraints.length]=new E()}for(bv=0;bv<a2;++bv){aW=a1[bv];var be=aW.m_fixtureA;var bc=aW.m_fixtureB;var aG=be.m_shape;var aE=bc.m_shape;var aY=aG.m_radius;var aX=aE.m_radius;var by=be.m_body;var bw=bc.m_body;var bb=aW.GetManifold();var a6=v.b2MixFriction(be.GetFriction(),bc.GetFriction());var aA=v.b2MixRestitution(be.GetRestitution(),bc.GetRestitution());var aL=by.m_linearVelocity.x;var aK=by.m_linearVelocity.y;var bt=bw.m_linearVelocity.x;var bs=bw.m_linearVelocity.y;var a8=by.m_angularVelocity;var a7=bw.m_angularVelocity;v.b2Assert(bb.m_pointCount>0);N.s_worldManifold.Initialize(bb,by.m_xf,aY,bw.m_xf,aX);var bm=N.s_worldManifold.m_normal.x;var bl=N.s_worldManifold.m_normal.y;var bh=this.m_constraints[bv];bh.bodyA=by;bh.bodyB=bw;bh.manifold=bb;bh.normal.x=bm;bh.normal.y=bl;bh.pointCount=bb.m_pointCount;bh.friction=a6;bh.restitution=aA;bh.localPlaneNormal.x=bb.m_localPlaneNormal.x;bh.localPlaneNormal.y=bb.m_localPlaneNormal.y;bh.localPoint.x=bb.m_localPoint.x;bh.localPoint.y=bb.m_localPoint.y;bh.radius=aY+aX;bh.type=bb.m_type;for(var bu=0;bu<bh.pointCount;++bu){var a9=bb.m_points[bu];var aC=bh.points[bu];aC.normalImpulse=a9.m_normalImpulse;aC.tangentImpulse=a9.m_tangentImpulse;aC.localPoint.SetV(a9.m_localPoint);var bj=aC.rA.x=N.s_worldManifold.m_points[bu].x-by.m_sweep.c.x;var bi=aC.rA.y=N.s_worldManifold.m_points[bu].y-by.m_sweep.c.y;var a0=aC.rB.x=N.s_worldManifold.m_points[bu].x-bw.m_sweep.c.x;var aZ=aC.rB.y=N.s_worldManifold.m_points[bu].y-bw.m_sweep.c.y;var aQ=bj*bl-bi*bm;var aN=a0*bl-aZ*bm;aQ*=aQ;aN*=aN;var ba=by.m_invMass+bw.m_invMass+by.m_invI*aQ+bw.m_invI*aN;aC.normalMass=1/ba;var aP=by.m_mass*by.m_invMass+bw.m_mass*bw.m_invMass;aP+=by.m_mass*by.m_invI*aQ+bw.m_mass*bw.m_invI*aN;aC.equalizedMass=1/aP;var bq=bl;var bo=(-bm);var aV=bj*bo-bi*bq;var aU=a0*bo-aZ*bq;aV*=aV;aU*=aU;var bx=by.m_invMass+bw.m_invMass+by.m_invI*aV+bw.m_invI*aU;aC.tangentMass=1/bx;aC.velocityBias=0;var aO=bt+((-a7*aZ))-aL-((-a8*bi));var aM=bs+(a7*a0)-aK-(a8*bj);var br=bh.normal.x*aO+bh.normal.y*aM;if(br<(-v.b2_velocityThreshold)){aC.velocityBias+=(-bh.restitution*br)}}if(bh.pointCount==2){var aJ=bh.points[0];var aI=bh.points[1];var bf=by.m_invMass;var aT=by.m_invI;var bd=bw.m_invMass;var aS=bw.m_invI;var a4=aJ.rA.x*bl-aJ.rA.y*bm;var a3=aJ.rB.x*bl-aJ.rB.y*bm;var aD=aI.rA.x*bl-aI.rA.y*bm;var aB=aI.rB.x*bl-aI.rB.y*bm;var aH=bf+bd+aT*a4*a4+aS*a3*a3;var bn=bf+bd+aT*aD*aD+aS*aB*aB;var aF=bf+bd+aT*a4*aD+aS*a3*aB;var a5=100;if(aH*aH<a5*(aH*bn-aF*aF)){bh.K.col1.Set(aH,aF);bh.K.col2.Set(aF,bn);bh.K.GetInverse(bh.normalMass)}else{bh.pointCount=1}}}};N.prototype.InitVelocityConstraints=function(aK){var aC;var aT;var aN;for(var aR=0;aR<this.m_constraintCount;++aR){var aU=this.m_constraints[aR];var aD=aU.bodyA;var aB=aU.bodyB;var aH=aD.m_invMass;var aW=aD.m_invI;var aF=aB.m_invMass;var aV=aB.m_invI;var aG=aU.normal.x;var aE=aU.normal.y;var aJ=aE;var aI=(-aG);var aP=0;var aQ=0;var aS=0;if(aK.warmStarting){aS=aU.pointCount;for(aQ=0;aQ<aS;++aQ){var aA=aU.points[aQ];aA.normalImpulse*=aK.dtRatio;aA.tangentImpulse*=aK.dtRatio;var aM=aA.normalImpulse*aG+aA.tangentImpulse*aJ;var aL=aA.normalImpulse*aE+aA.tangentImpulse*aI;aD.m_angularVelocity-=aW*(aA.rA.x*aL-aA.rA.y*aM);aD.m_linearVelocity.x-=aH*aM;aD.m_linearVelocity.y-=aH*aL;aB.m_angularVelocity+=aV*(aA.rB.x*aL-aA.rB.y*aM);aB.m_linearVelocity.x+=aF*aM;aB.m_linearVelocity.y+=aF*aL}}else{aS=aU.pointCount;for(aQ=0;aQ<aS;++aQ){var aO=aU.points[aQ];aO.normalImpulse=0;aO.tangentImpulse=0}}}};N.prototype.SolveVelocityConstraints=function(){var bi=0;var aB;var a6=0;var a5=0;var aM=0;var aK=0;var bu=0;var bt=0;var aL=0;var aJ=0;var bp=0;var bd=0;var bn=0;var bs=0;var br=0;var aR=0;var aQ=0;var be=0;var bc=0;var a2=0;var a0=0;var bg;var a7;for(var bj=0;bj<this.m_constraintCount;++bj){var bq=this.m_constraints[bj];var bw=bq.bodyA;var bv=bq.bodyB;var a1=bw.m_angularVelocity;var aZ=bv.m_angularVelocity;var bb=bw.m_linearVelocity;var ba=bv.m_linearVelocity;var a4=bw.m_invMass;var aI=bw.m_invI;var a3=bv.m_invMass;var aH=bv.m_invI;var a9=bq.normal.x;var a8=bq.normal.y;var bh=a8;var bf=(-a9);var aS=bq.friction;var aG=0;for(bi=0;bi<bq.pointCount;bi++){aB=bq.points[bi];bu=ba.x-aZ*aB.rB.y-bb.x+a1*aB.rA.y;bt=ba.y+aZ*aB.rB.x-bb.y-a1*aB.rA.x;aJ=bu*bh+bt*bf;bp=aB.tangentMass*(-aJ);bd=aS*aB.normalImpulse;bn=Q.Clamp(aB.tangentImpulse+bp,(-bd),bd);bp=bn-aB.tangentImpulse;bs=bp*bh;br=bp*bf;bb.x-=a4*bs;bb.y-=a4*br;a1-=aI*(aB.rA.x*br-aB.rA.y*bs);ba.x+=a3*bs;ba.y+=a3*br;aZ+=aH*(aB.rB.x*br-aB.rB.y*bs);aB.tangentImpulse=bn}var aP=parseInt(bq.pointCount);if(bq.pointCount==1){aB=bq.points[0];bu=ba.x+((-aZ*aB.rB.y))-bb.x-((-a1*aB.rA.y));bt=ba.y+(aZ*aB.rB.x)-bb.y-(a1*aB.rA.x);aL=bu*a9+bt*a8;bp=(-aB.normalMass*(aL-aB.velocityBias));bn=aB.normalImpulse+bp;bn=bn>0?bn:0;bp=bn-aB.normalImpulse;bs=bp*a9;br=bp*a8;bb.x-=a4*bs;bb.y-=a4*br;a1-=aI*(aB.rA.x*br-aB.rA.y*bs);ba.x+=a3*bs;ba.y+=a3*br;aZ+=aH*(aB.rB.x*br-aB.rB.y*bs);aB.normalImpulse=bn}else{var aW=bq.points[0];var aU=bq.points[1];var aO=aW.normalImpulse;var aN=aU.normalImpulse;var aV=ba.x-aZ*aW.rB.y-bb.x+a1*aW.rA.y;var aT=ba.y+aZ*aW.rB.x-bb.y-a1*aW.rA.x;var aF=ba.x-aZ*aU.rB.y-bb.x+a1*aU.rA.y;var aE=ba.y+aZ*aU.rB.x-bb.y-a1*aU.rA.x;var bo=aV*a9+aT*a8;var bm=aF*a9+aE*a8;var aD=bo-aW.velocityBias;var aC=bm-aU.velocityBias;bg=bq.K;aD-=bg.col1.x*aO+bg.col2.x*aN;aC-=bg.col1.y*aO+bg.col2.y*aN;var aA=0.001;for(;;){bg=bq.normalMass;var bl=(-(bg.col1.x*aD+bg.col2.x*aC));var bk=(-(bg.col1.y*aD+bg.col2.y*aC));if(bl>=0&&bk>=0){aR=bl-aO;aQ=bk-aN;be=aR*a9;bc=aR*a8;a2=aQ*a9;a0=aQ*a8;bb.x-=a4*(be+a2);bb.y-=a4*(bc+a0);a1-=aI*(aW.rA.x*bc-aW.rA.y*be+aU.rA.x*a0-aU.rA.y*a2);ba.x+=a3*(be+a2);ba.y+=a3*(bc+a0);aZ+=aH*(aW.rB.x*bc-aW.rB.y*be+aU.rB.x*a0-aU.rB.y*a2);aW.normalImpulse=bl;aU.normalImpulse=bk;break}bl=(-aW.normalMass*aD);bk=0;bo=0;bm=bq.K.col1.y*bl+aC;if(bl>=0&&bm>=0){aR=bl-aO;aQ=bk-aN;be=aR*a9;bc=aR*a8;a2=aQ*a9;a0=aQ*a8;bb.x-=a4*(be+a2);bb.y-=a4*(bc+a0);a1-=aI*(aW.rA.x*bc-aW.rA.y*be+aU.rA.x*a0-aU.rA.y*a2);ba.x+=a3*(be+a2);ba.y+=a3*(bc+a0);aZ+=aH*(aW.rB.x*bc-aW.rB.y*be+aU.rB.x*a0-aU.rB.y*a2);aW.normalImpulse=bl;aU.normalImpulse=bk;break}bl=0;bk=(-aU.normalMass*aC);bo=bq.K.col2.x*bk+aD;bm=0;if(bk>=0&&bo>=0){aR=bl-aO;aQ=bk-aN;be=aR*a9;bc=aR*a8;a2=aQ*a9;a0=aQ*a8;bb.x-=a4*(be+a2);bb.y-=a4*(bc+a0);a1-=aI*(aW.rA.x*bc-aW.rA.y*be+aU.rA.x*a0-aU.rA.y*a2);ba.x+=a3*(be+a2);ba.y+=a3*(bc+a0);aZ+=aH*(aW.rB.x*bc-aW.rB.y*be+aU.rB.x*a0-aU.rB.y*a2);aW.normalImpulse=bl;aU.normalImpulse=bk;break}bl=0;bk=0;bo=aD;bm=aC;if(bo>=0&&bm>=0){aR=bl-aO;aQ=bk-aN;be=aR*a9;bc=aR*a8;a2=aQ*a9;a0=aQ*a8;bb.x-=a4*(be+a2);bb.y-=a4*(bc+a0);a1-=aI*(aW.rA.x*bc-aW.rA.y*be+aU.rA.x*a0-aU.rA.y*a2);ba.x+=a3*(be+a2);ba.y+=a3*(bc+a0);aZ+=aH*(aW.rB.x*bc-aW.rB.y*be+aU.rB.x*a0-aU.rB.y*a2);aW.normalImpulse=bl;aU.normalImpulse=bk;break}break}}bw.m_angularVelocity=a1;bv.m_angularVelocity=aZ}};N.prototype.FinalizeVelocityConstraints=function(){for(var aD=0;aD<this.m_constraintCount;++aD){var aF=this.m_constraints[aD];var aA=aF.manifold;for(var aB=0;aB<aF.pointCount;++aB){var aE=aA.m_points[aB];var aC=aF.points[aB];aE.m_normalImpulse=aC.normalImpulse;aE.m_tangentImpulse=aC.tangentImpulse}}};N.prototype.SolvePositionConstraints=function(aR){if(aR===undefined){aR=0}var aI=0;for(var aS=0;aS<this.m_constraintCount;aS++){var aT=this.m_constraints[aS];var aC=aT.bodyA;var aB=aT.bodyB;var aE=aC.m_mass*aC.m_invMass;var aV=aC.m_mass*aC.m_invI;var aD=aB.m_mass*aB.m_invMass;var aU=aB.m_mass*aB.m_invI;N.s_psm.Initialize(aT);var aW=N.s_psm.m_normal;for(var aQ=0;aQ<aT.pointCount;aQ++){var aA=aT.points[aQ];var aP=N.s_psm.m_points[aQ];var aL=N.s_psm.m_separations[aQ];var aG=aP.x-aC.m_sweep.c.x;var aF=aP.y-aC.m_sweep.c.y;var aO=aP.x-aB.m_sweep.c.x;var aN=aP.y-aB.m_sweep.c.y;aI=aI<aL?aI:aL;var aM=Q.Clamp(aR*(aL+v.b2_linearSlop),(-v.b2_maxLinearCorrection),0);var aK=(-aA.equalizedMass*aM);var aJ=aK*aW.x;var aH=aK*aW.y;aC.m_sweep.c.x-=aE*aJ;aC.m_sweep.c.y-=aE*aH;aC.m_sweep.a-=aV*(aG*aH-aF*aJ);aC.SynchronizeTransform();aB.m_sweep.c.x+=aD*aJ;aB.m_sweep.c.y+=aD*aH;aB.m_sweep.a+=aU*(aO*aH-aN*aJ);aB.SynchronizeTransform()}}return aI>(-1.5*v.b2_linearSlop)};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2ContactSolver.s_worldManifold=new ap();Box2D.Dynamics.Contacts.b2ContactSolver.s_psm=new ac()});Box2D.inherit(az,Box2D.Dynamics.Contacts.b2Contact);az.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;az.b2EdgeAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};az.Create=function(aA){return new az()};az.Destroy=function(aA,aB){};az.prototype.Reset=function(aA,aB){this.__super.Reset.call(this,aA,aB)};az.prototype.Evaluate=function(){var aB=this.m_fixtureA.GetBody();var aA=this.m_fixtureB.GetBody();this.b2CollideEdgeAndCircle(this.m_manifold,(this.m_fixtureA.GetShape() instanceof ao?this.m_fixtureA.GetShape():null),aB.m_xf,(this.m_fixtureB.GetShape() instanceof aw?this.m_fixtureB.GetShape():null),aA.m_xf)};az.prototype.b2CollideEdgeAndCircle=function(aA,aD,aC,aE,aB){};Box2D.inherit(o,Box2D.Dynamics.Contacts.b2Contact);o.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;o.b2NullContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};o.prototype.b2NullContact=function(){this.__super.b2Contact.call(this)};o.prototype.Evaluate=function(){};Box2D.inherit(ad,Box2D.Dynamics.Contacts.b2Contact);ad.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;ad.b2PolyAndCircleContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};ad.Create=function(aA){return new ad()};ad.Destroy=function(aA,aB){};ad.prototype.Reset=function(aA,aB){this.__super.Reset.call(this,aA,aB);v.b2Assert(aA.GetType()==ab.e_polygonShape);v.b2Assert(aB.GetType()==ab.e_circleShape)};ad.prototype.Evaluate=function(){var aB=this.m_fixtureA.m_body;var aA=this.m_fixtureB.m_body;z.CollidePolygonAndCircle(this.m_manifold,(this.m_fixtureA.GetShape() instanceof an?this.m_fixtureA.GetShape():null),aB.m_xf,(this.m_fixtureB.GetShape() instanceof aw?this.m_fixtureB.GetShape():null),aA.m_xf)};Box2D.inherit(w,Box2D.Dynamics.Contacts.b2Contact);w.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;w.b2PolyAndEdgeContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};w.Create=function(aA){return new w()};w.Destroy=function(aA,aB){};w.prototype.Reset=function(aA,aB){this.__super.Reset.call(this,aA,aB);v.b2Assert(aA.GetType()==ab.e_polygonShape);v.b2Assert(aB.GetType()==ab.e_edgeShape)};w.prototype.Evaluate=function(){var aB=this.m_fixtureA.GetBody();var aA=this.m_fixtureB.GetBody();this.b2CollidePolyAndEdge(this.m_manifold,(this.m_fixtureA.GetShape() instanceof an?this.m_fixtureA.GetShape():null),aB.m_xf,(this.m_fixtureB.GetShape() instanceof ao?this.m_fixtureB.GetShape():null),aA.m_xf)};w.prototype.b2CollidePolyAndEdge=function(aA,aD,aC,aE,aB){};Box2D.inherit(M,Box2D.Dynamics.Contacts.b2Contact);M.prototype.__super=Box2D.Dynamics.Contacts.b2Contact.prototype;M.b2PolygonContact=function(){Box2D.Dynamics.Contacts.b2Contact.b2Contact.apply(this,arguments)};M.Create=function(aA){return new M()};M.Destroy=function(aA,aB){};M.prototype.Reset=function(aA,aB){this.__super.Reset.call(this,aA,aB)};M.prototype.Evaluate=function(){var aB=this.m_fixtureA.GetBody();var aA=this.m_fixtureB.GetBody();z.CollidePolygons(this.m_manifold,(this.m_fixtureA.GetShape() instanceof an?this.m_fixtureA.GetShape():null),aB.m_xf,(this.m_fixtureB.GetShape() instanceof an?this.m_fixtureB.GetShape():null),aA.m_xf)};ac.b2PositionSolverManifold=function(){};ac.prototype.b2PositionSolverManifold=function(){this.m_normal=new Z();this.m_separations=new Vector_a2j_Number(v.b2_maxManifoldPoints);this.m_points=new Vector(v.b2_maxManifoldPoints);for(var aA=0;aA<v.b2_maxManifoldPoints;aA++){this.m_points[aA]=new Z()}};ac.prototype.Initialize=function(aD){v.b2Assert(aD.pointCount>0);var aJ=0;var aK=0;var aI=0;var aO;var aP;var aC=0;var aB=0;switch(aD.type){case I.e_circles:aO=aD.bodyA.m_xf.R;aP=aD.localPoint;var aN=aD.bodyA.m_xf.position.x+(aO.col1.x*aP.x+aO.col2.x*aP.y);var aM=aD.bodyA.m_xf.position.y+(aO.col1.y*aP.x+aO.col2.y*aP.y);aO=aD.bodyB.m_xf.R;aP=aD.points[0].localPoint;var aG=aD.bodyB.m_xf.position.x+(aO.col1.x*aP.x+aO.col2.x*aP.y);var aE=aD.bodyB.m_xf.position.y+(aO.col1.y*aP.x+aO.col2.y*aP.y);var aH=aG-aN;var aF=aE-aM;var aA=aH*aH+aF*aF;if(aA>Number.MIN_VALUE*Number.MIN_VALUE){var aL=Math.sqrt(aA);this.m_normal.x=aH/aL;this.m_normal.y=aF/aL}else{this.m_normal.x=1;this.m_normal.y=0}this.m_points[0].x=0.5*(aN+aG);this.m_points[0].y=0.5*(aM+aE);this.m_separations[0]=aH*this.m_normal.x+aF*this.m_normal.y-aD.radius;break;case I.e_faceA:aO=aD.bodyA.m_xf.R;aP=aD.localPlaneNormal;this.m_normal.x=aO.col1.x*aP.x+aO.col2.x*aP.y;this.m_normal.y=aO.col1.y*aP.x+aO.col2.y*aP.y;aO=aD.bodyA.m_xf.R;aP=aD.localPoint;aC=aD.bodyA.m_xf.position.x+(aO.col1.x*aP.x+aO.col2.x*aP.y);aB=aD.bodyA.m_xf.position.y+(aO.col1.y*aP.x+aO.col2.y*aP.y);aO=aD.bodyB.m_xf.R;for(aJ=0;aJ<aD.pointCount;++aJ){aP=aD.points[aJ].localPoint;aK=aD.bodyB.m_xf.position.x+(aO.col1.x*aP.x+aO.col2.x*aP.y);aI=aD.bodyB.m_xf.position.y+(aO.col1.y*aP.x+aO.col2.y*aP.y);this.m_separations[aJ]=(aK-aC)*this.m_normal.x+(aI-aB)*this.m_normal.y-aD.radius;this.m_points[aJ].x=aK;this.m_points[aJ].y=aI}break;case I.e_faceB:aO=aD.bodyB.m_xf.R;aP=aD.localPlaneNormal;this.m_normal.x=aO.col1.x*aP.x+aO.col2.x*aP.y;this.m_normal.y=aO.col1.y*aP.x+aO.col2.y*aP.y;aO=aD.bodyB.m_xf.R;aP=aD.localPoint;aC=aD.bodyB.m_xf.position.x+(aO.col1.x*aP.x+aO.col2.x*aP.y);aB=aD.bodyB.m_xf.position.y+(aO.col1.y*aP.x+aO.col2.y*aP.y);aO=aD.bodyA.m_xf.R;for(aJ=0;aJ<aD.pointCount;++aJ){aP=aD.points[aJ].localPoint;aK=aD.bodyA.m_xf.position.x+(aO.col1.x*aP.x+aO.col2.x*aP.y);aI=aD.bodyA.m_xf.position.y+(aO.col1.y*aP.x+aO.col2.y*aP.y);this.m_separations[aJ]=(aK-aC)*this.m_normal.x+(aI-aB)*this.m_normal.y-aD.radius;this.m_points[aJ].Set(aK,aI)}this.m_normal.x*=(-1);this.m_normal.y*=(-1);break}};Box2D.postDefs.push(function(){Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointA=new Z();Box2D.Dynamics.Contacts.b2PositionSolverManifold.circlePointB=new Z()})})();(function(){var k=Box2D.Dynamics.b2Body,u=Box2D.Dynamics.b2BodyDef,G=Box2D.Dynamics.b2ContactFilter,t=Box2D.Dynamics.b2ContactImpulse,y=Box2D.Dynamics.b2ContactListener,B=Box2D.Dynamics.b2ContactManager,l=Box2D.Dynamics.b2DebugDraw,K=Box2D.Dynamics.b2PaperDraw,f=Box2D.Dynamics.b2DestructionListener,s=Box2D.Dynamics.b2FilterData,M=Box2D.Dynamics.b2Fixture,p=Box2D.Dynamics.b2FixtureDef,g=Box2D.Dynamics.b2Island,z=Box2D.Dynamics.b2TimeStep,m=Box2D.Dynamics.b2World,w=Box2D.Common.Math.b2Mat22,h=Box2D.Common.Math.b2Mat33,n=Box2D.Common.Math.b2Math,r=Box2D.Common.Math.b2Sweep,e=Box2D.Common.Math.b2Transform,E=Box2D.Common.Math.b2Vec2,D=Box2D.Common.Math.b2Vec3,q=Box2D.Common.b2Color,C=Box2D.Common.b2internal,d=Box2D.Common.b2Settings,x=Box2D.Collision.Shapes.b2CircleShape,I=Box2D.Collision.Shapes.b2EdgeChainDef,L=Box2D.Collision.Shapes.b2EdgeShape,A=Box2D.Collision.Shapes.b2MassData,o=Box2D.Collision.Shapes.b2PolygonShape,j=Box2D.Collision.Shapes.b2Shape,b=Box2D.Dynamics.Controllers.b2BuoyancyController,H=Box2D.Dynamics.Controllers.b2ConstantAccelController,a=Box2D.Dynamics.Controllers.b2ConstantForceController,J=Box2D.Dynamics.Controllers.b2Controller,c=Box2D.Dynamics.Controllers.b2ControllerEdge,v=Box2D.Dynamics.Controllers.b2GravityController,F=Box2D.Dynamics.Controllers.b2TensorDampingController;Box2D.inherit(b,Box2D.Dynamics.Controllers.b2Controller);b.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;b.b2BuoyancyController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.normal=new E(0,(-1));this.offset=0;this.density=0;this.velocity=new E(0,0);this.linearDrag=2;this.angularDrag=1;this.useDensity=false;this.useWorldGravity=true;this.gravity=null};b.prototype.Step=function(P){if(!this.m_bodyList){return}if(this.useWorldGravity){this.gravity=this.GetWorld().GetGravity().Copy()}for(var S=this.m_bodyList;S;S=S.nextBody){var U=S.body;if(U.IsAwake()==false){continue}var X=new E();var Z=new E();var O=0;var V=0;for(var Q=U.GetFixtureList();Q;Q=Q.GetNext()){var W=new E();var N=Q.GetShape().ComputeSubmergedArea(this.normal,this.offset,U.GetTransform(),W);O+=N;X.x+=N*W.x;X.y+=N*W.y;var R=0;if(this.useDensity){R=1}else{R=1}V+=N*R;Z.x+=N*W.x*R;Z.y+=N*W.y*R}X.x/=O;X.y/=O;Z.x/=V;Z.y/=V;if(O<Number.MIN_VALUE){continue}var T=this.gravity.GetNegative();T.Multiply(this.density*O);U.ApplyForce(T,Z);var Y=U.GetLinearVelocityFromWorldPoint(X);Y.Subtract(this.velocity);Y.Multiply((-this.linearDrag*O));U.ApplyForce(Y,X);U.ApplyTorque((-U.GetInertia()/U.GetMass()*O*U.GetAngularVelocity()*this.angularDrag))}};b.prototype.Draw=function(R){var O=1000;var Q=new E();var P=new E();Q.x=this.normal.x*this.offset+this.normal.y*O;Q.y=this.normal.y*this.offset-this.normal.x*O;P.x=this.normal.x*this.offset-this.normal.y*O;P.y=this.normal.y*this.offset+this.normal.x*O;var N=new q(0,0,1);R.DrawSegment(Q,P,N)};Box2D.inherit(H,Box2D.Dynamics.Controllers.b2Controller);H.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;H.b2ConstantAccelController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.A=new E(0,0)};H.prototype.Step=function(Q){var O=new E(this.A.x*Q.dt,this.A.y*Q.dt);for(var P=this.m_bodyList;P;P=P.nextBody){var N=P.body;if(!N.IsAwake()){continue}N.SetLinearVelocity(new E(N.GetLinearVelocity().x+O.x,N.GetLinearVelocity().y+O.y))}};Box2D.inherit(a,Box2D.Dynamics.Controllers.b2Controller);a.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;a.b2ConstantForceController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.F=new E(0,0)};a.prototype.Step=function(P){for(var O=this.m_bodyList;O;O=O.nextBody){var N=O.body;if(!N.IsAwake()){continue}N.ApplyForce(this.F,N.GetWorldCenter())}};J.b2Controller=function(){};J.prototype.Step=function(N){};J.prototype.Draw=function(N){};J.prototype.AddBody=function(N){var O=new c();O.controller=this;O.body=N;O.nextBody=this.m_bodyList;O.prevBody=null;this.m_bodyList=O;if(O.nextBody){O.nextBody.prevBody=O}this.m_bodyCount++;O.nextController=N.m_controllerList;O.prevController=null;N.m_controllerList=O;if(O.nextController){O.nextController.prevController=O}N.m_controllerCount++};J.prototype.RemoveBody=function(N){var O=N.m_controllerList;while(O&&O.controller!=this){O=O.nextController}if(O.prevBody){O.prevBody.nextBody=O.nextBody}if(O.nextBody){O.nextBody.prevBody=O.prevBody}if(O.nextController){O.nextController.prevController=O.prevController}if(O.prevController){O.prevController.nextController=O.nextController}if(this.m_bodyList==O){this.m_bodyList=O.nextBody}if(N.m_controllerList==O){N.m_controllerList=O.nextController}N.m_controllerCount--;this.m_bodyCount--};J.prototype.Clear=function(){while(this.m_bodyList){this.RemoveBody(this.m_bodyList.body)}};J.prototype.GetNext=function(){return this.m_next};J.prototype.GetWorld=function(){return this.m_world};J.prototype.GetBodyList=function(){return this.m_bodyList};c.b2ControllerEdge=function(){};Box2D.inherit(v,Box2D.Dynamics.Controllers.b2Controller);v.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;v.b2GravityController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.G=1;this.invSqr=true};v.prototype.Step=function(Q){var S=null;var N=null;var V=null;var O=0;var R=null;var Y=null;var U=null;var X=0;var W=0;var P=0;var T=null;if(this.invSqr){for(S=this.m_bodyList;S;S=S.nextBody){N=S.body;V=N.GetWorldCenter();O=N.GetMass();for(R=this.m_bodyList;R!=S;R=R.nextBody){Y=R.body;U=Y.GetWorldCenter();X=U.x-V.x;W=U.y-V.y;P=X*X+W*W;if(P<Number.MIN_VALUE){continue}T=new E(X,W);T.Multiply(this.G/P/Math.sqrt(P)*O*Y.GetMass());if(N.IsAwake()){N.ApplyForce(T,V)}T.Multiply((-1));if(Y.IsAwake()){Y.ApplyForce(T,U)}}}}else{for(S=this.m_bodyList;S;S=S.nextBody){N=S.body;V=N.GetWorldCenter();O=N.GetMass();for(R=this.m_bodyList;R!=S;R=R.nextBody){Y=R.body;U=Y.GetWorldCenter();X=U.x-V.x;W=U.y-V.y;P=X*X+W*W;if(P<Number.MIN_VALUE){continue}T=new E(X,W);T.Multiply(this.G/P*O*Y.GetMass());if(N.IsAwake()){N.ApplyForce(T,V)}T.Multiply((-1));if(Y.IsAwake()){Y.ApplyForce(T,U)}}}}};Box2D.inherit(F,Box2D.Dynamics.Controllers.b2Controller);F.prototype.__super=Box2D.Dynamics.Controllers.b2Controller.prototype;F.b2TensorDampingController=function(){Box2D.Dynamics.Controllers.b2Controller.b2Controller.apply(this,arguments);this.T=new w();this.maxTimestep=0};F.prototype.SetAxisAligned=function(O,N){if(O===undefined){O=0}if(N===undefined){N=0}this.T.col1.x=(-O);this.T.col1.y=0;this.T.col2.x=0;this.T.col2.y=(-N);if(O>0||N>0){this.maxTimestep=1/Math.max(O,N)}else{this.maxTimestep=0}};F.prototype.Step=function(R){var O=R.dt;if(O<=Number.MIN_VALUE){return}if(O>this.maxTimestep&&this.maxTimestep>0){O=this.maxTimestep}for(var Q=this.m_bodyList;Q;Q=Q.nextBody){var N=Q.body;if(!N.IsAwake()){continue}var P=N.GetWorldVector(n.MulMV(this.T,N.GetLocalVector(N.GetLinearVelocity())));N.SetLinearVelocity(new E(N.GetLinearVelocity().x+P.x*O,N.GetLinearVelocity().y+P.y*O))}}})();(function(){var w=Box2D.Common.b2Color,M=Box2D.Common.b2internal,c=Box2D.Common.b2Settings,H=Box2D.Common.Math.b2Mat22,m=Box2D.Common.Math.b2Mat33,t=Box2D.Common.Math.b2Math,x=Box2D.Common.Math.b2Sweep,k=Box2D.Common.Math.b2Transform,P=Box2D.Common.Math.b2Vec2,O=Box2D.Common.Math.b2Vec3,s=Box2D.Dynamics.Joints.b2DistanceJoint,S=Box2D.Dynamics.Joints.b2DistanceJointDef,b=Box2D.Dynamics.Joints.b2FrictionJoint,A=Box2D.Dynamics.Joints.b2FrictionJointDef,B=Box2D.Dynamics.Joints.b2GearJoint,C=Box2D.Dynamics.Joints.b2GearJointDef,N=Box2D.Dynamics.Joints.b2Jacobian,j=Box2D.Dynamics.Joints.b2Joint,I=Box2D.Dynamics.Joints.b2JointDef,Q=Box2D.Dynamics.Joints.b2JointEdge,n=Box2D.Dynamics.Joints.b2LineJoint,g=Box2D.Dynamics.Joints.b2LineJointDef,G=Box2D.Dynamics.Joints.b2MouseJoint,d=Box2D.Dynamics.Joints.b2MouseJointDef,o=Box2D.Dynamics.Joints.b2PrismaticJoint,v=Box2D.Dynamics.Joints.b2PrismaticJointDef,f=Box2D.Dynamics.Joints.b2PulleyJoint,T=Box2D.Dynamics.Joints.b2PulleyJointDef,F=Box2D.Dynamics.Joints.b2RevoluteJoint,a=Box2D.Dynamics.Joints.b2RevoluteJointDef,e=Box2D.Dynamics.Joints.b2WeldJoint,z=Box2D.Dynamics.Joints.b2WeldJointDef,p=Box2D.Dynamics.b2Body,E=Box2D.Dynamics.b2BodyDef,R=Box2D.Dynamics.b2ContactFilter,D=Box2D.Dynamics.b2ContactImpulse,J=Box2D.Dynamics.b2ContactListener,L=Box2D.Dynamics.b2ContactManager,r=Box2D.Dynamics.b2DebugDraw,U=Box2D.Dynamics.b2PaperDraw,h=Box2D.Dynamics.b2DestructionListener,y=Box2D.Dynamics.b2FilterData,V=Box2D.Dynamics.b2Fixture,u=Box2D.Dynamics.b2FixtureDef,l=Box2D.Dynamics.b2Island,K=Box2D.Dynamics.b2TimeStep,q=Box2D.Dynamics.b2World;Box2D.inherit(s,Box2D.Dynamics.Joints.b2Joint);s.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;s.b2DistanceJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_u=new P()};s.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};s.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};s.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*this.m_impulse*this.m_u.x,W*this.m_impulse*this.m_u.y)};s.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return 0};s.prototype.GetLength=function(){return this.m_length};s.prototype.SetLength=function(W){if(W===undefined){W=0}this.m_length=W};s.prototype.GetFrequency=function(){return this.m_frequencyHz};s.prototype.SetFrequency=function(W){if(W===undefined){W=0}this.m_frequencyHz=W};s.prototype.GetDampingRatio=function(){return this.m_dampingRatio};s.prototype.SetDampingRatio=function(W){if(W===undefined){W=0}this.m_dampingRatio=W};s.prototype.b2DistanceJoint=function(Y){this.__super.b2Joint.call(this,Y);var X;var W=0;var Z=0;this.m_localAnchor1.SetV(Y.localAnchorA);this.m_localAnchor2.SetV(Y.localAnchorB);this.m_length=Y.length;this.m_frequencyHz=Y.frequencyHz;this.m_dampingRatio=Y.dampingRatio;this.m_impulse=0;this.m_gamma=0;this.m_bias=0};s.prototype.InitVelocityConstraints=function(Z){var ad;var ag=0;var an=this.m_bodyA;var am=this.m_bodyB;ad=an.m_xf.R;var aj=this.m_localAnchor1.x-an.m_sweep.localCenter.x;var ai=this.m_localAnchor1.y-an.m_sweep.localCenter.y;ag=(ad.col1.x*aj+ad.col2.x*ai);ai=(ad.col1.y*aj+ad.col2.y*ai);aj=ag;ad=am.m_xf.R;var Y=this.m_localAnchor2.x-am.m_sweep.localCenter.x;var W=this.m_localAnchor2.y-am.m_sweep.localCenter.y;ag=(ad.col1.x*Y+ad.col2.x*W);W=(ad.col1.y*Y+ad.col2.y*W);Y=ag;this.m_u.x=am.m_sweep.c.x+Y-an.m_sweep.c.x-aj;this.m_u.y=am.m_sweep.c.y+W-an.m_sweep.c.y-ai;var X=Math.sqrt(this.m_u.x*this.m_u.x+this.m_u.y*this.m_u.y);if(X>c.b2_linearSlop){this.m_u.Multiply(1/X)}else{this.m_u.SetZero()}var ao=(aj*this.m_u.y-ai*this.m_u.x);var ab=(Y*this.m_u.y-W*this.m_u.x);var al=an.m_invMass+an.m_invI*ao*ao+am.m_invMass+am.m_invI*ab*ab;this.m_mass=al!=0?1/al:0;if(this.m_frequencyHz>0){var ae=X-this.m_length;var af=2*Math.PI*this.m_frequencyHz;var ak=2*this.m_mass*this.m_dampingRatio*af;var ah=this.m_mass*af*af;this.m_gamma=Z.dt*(ak+Z.dt*ah);this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;this.m_bias=ae*Z.dt*ah*this.m_gamma;this.m_mass=al+this.m_gamma;this.m_mass=this.m_mass!=0?1/this.m_mass:0}if(Z.warmStarting){this.m_impulse*=Z.dtRatio;var ac=this.m_impulse*this.m_u.x;var aa=this.m_impulse*this.m_u.y;an.m_linearVelocity.x-=an.m_invMass*ac;an.m_linearVelocity.y-=an.m_invMass*aa;an.m_angularVelocity-=an.m_invI*(aj*aa-ai*ac);am.m_linearVelocity.x+=am.m_invMass*ac;am.m_linearVelocity.y+=am.m_invMass*aa;am.m_angularVelocity+=am.m_invI*(Y*aa-W*ac)}else{this.m_impulse=0}};s.prototype.SolveVelocityConstraints=function(Z){var ah;var X=this.m_bodyA;var W=this.m_bodyB;ah=X.m_xf.R;var am=this.m_localAnchor1.x-X.m_sweep.localCenter.x;var al=this.m_localAnchor1.y-X.m_sweep.localCenter.y;var ak=(ah.col1.x*am+ah.col2.x*al);al=(ah.col1.y*am+ah.col2.y*al);am=ak;ah=W.m_xf.R;var af=this.m_localAnchor2.x-W.m_sweep.localCenter.x;var ae=this.m_localAnchor2.y-W.m_sweep.localCenter.y;ak=(ah.col1.x*af+ah.col2.x*ae);ae=(ah.col1.y*af+ah.col2.y*ae);af=ak;var aj=X.m_linearVelocity.x+((-X.m_angularVelocity*al));var ai=X.m_linearVelocity.y+(X.m_angularVelocity*am);var ad=W.m_linearVelocity.x+((-W.m_angularVelocity*ae));var ac=W.m_linearVelocity.y+(W.m_angularVelocity*af);var ag=(this.m_u.x*(ad-aj)+this.m_u.y*(ac-ai));var Y=(-this.m_mass*(ag+this.m_bias+this.m_gamma*this.m_impulse));this.m_impulse+=Y;var ab=Y*this.m_u.x;var aa=Y*this.m_u.y;X.m_linearVelocity.x-=X.m_invMass*ab;X.m_linearVelocity.y-=X.m_invMass*aa;X.m_angularVelocity-=X.m_invI*(am*aa-al*ab);W.m_linearVelocity.x+=W.m_invMass*ab;W.m_linearVelocity.y+=W.m_invMass*aa;W.m_angularVelocity+=W.m_invI*(af*aa-ae*ab)};s.prototype.SolvePositionConstraints=function(ai){if(ai===undefined){ai=0}var ah;if(this.m_frequencyHz>0){return true}var Y=this.m_bodyA;var W=this.m_bodyB;ah=Y.m_xf.R;var al=this.m_localAnchor1.x-Y.m_sweep.localCenter.x;var ak=this.m_localAnchor1.y-Y.m_sweep.localCenter.y;var aj=(ah.col1.x*al+ah.col2.x*ak);ak=(ah.col1.y*al+ah.col2.y*ak);al=aj;ah=W.m_xf.R;var ag=this.m_localAnchor2.x-W.m_sweep.localCenter.x;var af=this.m_localAnchor2.y-W.m_sweep.localCenter.y;aj=(ah.col1.x*ag+ah.col2.x*af);af=(ah.col1.y*ag+ah.col2.y*af);ag=aj;var ae=W.m_sweep.c.x+ag-Y.m_sweep.c.x-al;var ad=W.m_sweep.c.y+af-Y.m_sweep.c.y-ak;var aa=Math.sqrt(ae*ae+ad*ad);ae/=aa;ad/=aa;var X=aa-this.m_length;X=t.Clamp(X,(-c.b2_maxLinearCorrection),c.b2_maxLinearCorrection);var Z=(-this.m_mass*X);this.m_u.Set(ae,ad);var ac=Z*this.m_u.x;var ab=Z*this.m_u.y;Y.m_sweep.c.x-=Y.m_invMass*ac;Y.m_sweep.c.y-=Y.m_invMass*ab;Y.m_sweep.a-=Y.m_invI*(al*ab-ak*ac);W.m_sweep.c.x+=W.m_invMass*ac;W.m_sweep.c.y+=W.m_invMass*ab;W.m_sweep.a+=W.m_invI*(ag*ab-af*ac);Y.SynchronizeTransform();W.SynchronizeTransform();return t.Abs(X)<c.b2_linearSlop};Box2D.inherit(S,Box2D.Dynamics.Joints.b2JointDef);S.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;S.b2DistanceJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P()};S.prototype.b2DistanceJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_distanceJoint;this.length=1;this.frequencyHz=0;this.dampingRatio=0};S.prototype.Initialize=function(ab,aa,Z,X){this.bodyA=ab;this.bodyB=aa;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(Z));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(X));var Y=X.x-Z.x;var W=X.y-Z.y;this.length=Math.sqrt(Y*Y+W*W);this.frequencyHz=0;this.dampingRatio=0};Box2D.inherit(b,Box2D.Dynamics.Joints.b2Joint);b.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;b.b2FrictionJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new P();this.m_localAnchorB=new P();this.m_linearMass=new H();this.m_linearImpulse=new P()};b.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};b.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};b.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*this.m_linearImpulse.x,W*this.m_linearImpulse.y)};b.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return W*this.m_angularImpulse};b.prototype.SetMaxForce=function(W){if(W===undefined){W=0}this.m_maxForce=W};b.prototype.GetMaxForce=function(){return this.m_maxForce};b.prototype.SetMaxTorque=function(W){if(W===undefined){W=0}this.m_maxTorque=W};b.prototype.GetMaxTorque=function(){return this.m_maxTorque};b.prototype.b2FrictionJoint=function(W){this.__super.b2Joint.call(this,W);this.m_localAnchorA.SetV(W.localAnchorA);this.m_localAnchorB.SetV(W.localAnchorB);this.m_linearMass.SetZero();this.m_angularMass=0;this.m_linearImpulse.SetZero();this.m_angularImpulse=0;this.m_maxForce=W.maxForce;this.m_maxTorque=W.maxTorque};b.prototype.InitVelocityConstraints=function(Z){var ag;var ai=0;var X=this.m_bodyA;var W=this.m_bodyB;ag=X.m_xf.R;var ac=this.m_localAnchorA.x-X.m_sweep.localCenter.x;var ab=this.m_localAnchorA.y-X.m_sweep.localCenter.y;ai=(ag.col1.x*ac+ag.col2.x*ab);ab=(ag.col1.y*ac+ag.col2.y*ab);ac=ai;ag=W.m_xf.R;var ak=this.m_localAnchorB.x-W.m_sweep.localCenter.x;var aj=this.m_localAnchorB.y-W.m_sweep.localCenter.y;ai=(ag.col1.x*ak+ag.col2.x*aj);aj=(ag.col1.y*ak+ag.col2.y*aj);ak=ai;var aa=X.m_invMass;var Y=W.m_invMass;var af=X.m_invI;var ae=W.m_invI;var ah=new H();ah.col1.x=aa+Y;ah.col2.x=0;ah.col1.y=0;ah.col2.y=aa+Y;ah.col1.x+=af*ab*ab;ah.col2.x+=(-af*ac*ab);ah.col1.y+=(-af*ac*ab);ah.col2.y+=af*ac*ac;ah.col1.x+=ae*aj*aj;ah.col2.x+=(-ae*ak*aj);ah.col1.y+=(-ae*ak*aj);ah.col2.y+=ae*ak*ak;ah.GetInverse(this.m_linearMass);this.m_angularMass=af+ae;if(this.m_angularMass>0){this.m_angularMass=1/this.m_angularMass}if(Z.warmStarting){this.m_linearImpulse.x*=Z.dtRatio;this.m_linearImpulse.y*=Z.dtRatio;this.m_angularImpulse*=Z.dtRatio;var ad=this.m_linearImpulse;X.m_linearVelocity.x-=aa*ad.x;X.m_linearVelocity.y-=aa*ad.y;X.m_angularVelocity-=af*(ac*ad.y-ab*ad.x+this.m_angularImpulse);W.m_linearVelocity.x+=Y*ad.x;W.m_linearVelocity.y+=Y*ad.y;W.m_angularVelocity+=ae*(ak*ad.y-aj*ad.x+this.m_angularImpulse)}else{this.m_linearImpulse.SetZero();this.m_angularImpulse=0}};b.prototype.SolveVelocityConstraints=function(ad){var ai;var al=0;var av=this.m_bodyA;var au=this.m_bodyB;var at=av.m_linearVelocity;var Y=av.m_angularVelocity;var ar=au.m_linearVelocity;var X=au.m_angularVelocity;var aq=av.m_invMass;var ap=au.m_invMass;var ag=av.m_invI;var af=au.m_invI;ai=av.m_xf.R;var ae=this.m_localAnchorA.x-av.m_sweep.localCenter.x;var ac=this.m_localAnchorA.y-av.m_sweep.localCenter.y;al=(ai.col1.x*ae+ai.col2.x*ac);ac=(ai.col1.y*ae+ai.col2.y*ac);ae=al;ai=au.m_xf.R;var an=this.m_localAnchorB.x-au.m_sweep.localCenter.x;var am=this.m_localAnchorB.y-au.m_sweep.localCenter.y;al=(ai.col1.x*an+ai.col2.x*am);am=(ai.col1.y*an+ai.col2.y*am);an=al;var aj=0;var ak=X-Y;var ah=(-this.m_angularMass*ak);var aa=this.m_angularImpulse;aj=ad.dt*this.m_maxTorque;this.m_angularImpulse=t.Clamp(this.m_angularImpulse+ah,(-aj),aj);ah=this.m_angularImpulse-aa;Y-=ag*ah;X+=af*ah;var ab=ar.x-X*am-at.x+Y*ac;var Z=ar.y+X*an-at.y-Y*ae;var W=t.MulMV(this.m_linearMass,new P((-ab),(-Z)));var ao=this.m_linearImpulse.Copy();this.m_linearImpulse.Add(W);aj=ad.dt*this.m_maxForce;if(this.m_linearImpulse.LengthSquared()>aj*aj){this.m_linearImpulse.Normalize();this.m_linearImpulse.Multiply(aj)}W=t.SubtractVV(this.m_linearImpulse,ao);at.x-=aq*W.x;at.y-=aq*W.y;Y-=ag*(ae*W.y-ac*W.x);ar.x+=ap*W.x;ar.y+=ap*W.y;X+=af*(an*W.y-am*W.x);av.m_angularVelocity=Y;au.m_angularVelocity=X};b.prototype.SolvePositionConstraints=function(W){if(W===undefined){W=0}return true};Box2D.inherit(A,Box2D.Dynamics.Joints.b2JointDef);A.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;A.b2FrictionJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P()};A.prototype.b2FrictionJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_frictionJoint;this.maxForce=0;this.maxTorque=0};A.prototype.Initialize=function(Y,X,W){this.bodyA=Y;this.bodyB=X;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(W));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(W))};Box2D.inherit(B,Box2D.Dynamics.Joints.b2Joint);B.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;B.b2GearJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new P();this.m_groundAnchor2=new P();this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_J=new N()};B.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};B.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};B.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*this.m_impulse*this.m_J.linearB.x,W*this.m_impulse*this.m_J.linearB.y)};B.prototype.GetReactionTorque=function(aa){if(aa===undefined){aa=0}var Y=this.m_bodyB.m_xf.R;var ac=this.m_localAnchor1.x-this.m_bodyB.m_sweep.localCenter.x;var ab=this.m_localAnchor1.y-this.m_bodyB.m_sweep.localCenter.y;var W=Y.col1.x*ac+Y.col2.x*ab;ab=Y.col1.y*ac+Y.col2.y*ab;ac=W;var Z=this.m_impulse*this.m_J.linearB.x;var X=this.m_impulse*this.m_J.linearB.y;return aa*(this.m_impulse*this.m_J.angularB-ac*X+ab*Z)};B.prototype.GetRatio=function(){return this.m_ratio};B.prototype.SetRatio=function(W){if(W===undefined){W=0}this.m_ratio=W};B.prototype.b2GearJoint=function(Y){this.__super.b2Joint.call(this,Y);var X=parseInt(Y.joint1.m_type);var W=parseInt(Y.joint2.m_type);this.m_revolute1=null;this.m_prismatic1=null;this.m_revolute2=null;this.m_prismatic2=null;var aa=0;var Z=0;this.m_ground1=Y.joint1.GetBodyA();this.m_bodyA=Y.joint1.GetBodyB();if(X==j.e_revoluteJoint){this.m_revolute1=(Y.joint1 instanceof F?Y.joint1:null);this.m_groundAnchor1.SetV(this.m_revolute1.m_localAnchor1);this.m_localAnchor1.SetV(this.m_revolute1.m_localAnchor2);aa=this.m_revolute1.GetJointAngle()}else{this.m_prismatic1=(Y.joint1 instanceof o?Y.joint1:null);this.m_groundAnchor1.SetV(this.m_prismatic1.m_localAnchor1);this.m_localAnchor1.SetV(this.m_prismatic1.m_localAnchor2);aa=this.m_prismatic1.GetJointTranslation()}this.m_ground2=Y.joint2.GetBodyA();this.m_bodyB=Y.joint2.GetBodyB();if(W==j.e_revoluteJoint){this.m_revolute2=(Y.joint2 instanceof F?Y.joint2:null);this.m_groundAnchor2.SetV(this.m_revolute2.m_localAnchor1);this.m_localAnchor2.SetV(this.m_revolute2.m_localAnchor2);Z=this.m_revolute2.GetJointAngle()}else{this.m_prismatic2=(Y.joint2 instanceof o?Y.joint2:null);this.m_groundAnchor2.SetV(this.m_prismatic2.m_localAnchor1);this.m_localAnchor2.SetV(this.m_prismatic2.m_localAnchor2);Z=this.m_prismatic2.GetJointTranslation()}this.m_ratio=Y.ratio;this.m_constant=aa+this.m_ratio*Z;this.m_impulse=0};B.prototype.InitVelocityConstraints=function(Z){var X=this.m_ground1;var aj=this.m_ground2;var Y=this.m_bodyA;var W=this.m_bodyB;var ag=0;var ae=0;var ab=0;var aa=0;var ac;var ai;var af=0;var ah=0;var ad=0;this.m_J.SetZero();if(this.m_revolute1){this.m_J.angularA=(-1);ad+=Y.m_invI}else{ac=X.m_xf.R;ai=this.m_prismatic1.m_localXAxis1;ag=ac.col1.x*ai.x+ac.col2.x*ai.y;ae=ac.col1.y*ai.x+ac.col2.y*ai.y;ac=Y.m_xf.R;ab=this.m_localAnchor1.x-Y.m_sweep.localCenter.x;aa=this.m_localAnchor1.y-Y.m_sweep.localCenter.y;ah=ac.col1.x*ab+ac.col2.x*aa;aa=ac.col1.y*ab+ac.col2.y*aa;ab=ah;af=ab*ae-aa*ag;this.m_J.linearA.Set((-ag),(-ae));this.m_J.angularA=(-af);ad+=Y.m_invMass+Y.m_invI*af*af}if(this.m_revolute2){this.m_J.angularB=(-this.m_ratio);ad+=this.m_ratio*this.m_ratio*W.m_invI}else{ac=aj.m_xf.R;ai=this.m_prismatic2.m_localXAxis1;ag=ac.col1.x*ai.x+ac.col2.x*ai.y;ae=ac.col1.y*ai.x+ac.col2.y*ai.y;ac=W.m_xf.R;ab=this.m_localAnchor2.x-W.m_sweep.localCenter.x;aa=this.m_localAnchor2.y-W.m_sweep.localCenter.y;ah=ac.col1.x*ab+ac.col2.x*aa;aa=ac.col1.y*ab+ac.col2.y*aa;ab=ah;af=ab*ae-aa*ag;this.m_J.linearB.Set((-this.m_ratio*ag),(-this.m_ratio*ae));this.m_J.angularB=(-this.m_ratio*af);ad+=this.m_ratio*this.m_ratio*(W.m_invMass+W.m_invI*af*af)}this.m_mass=ad>0?1/ad:0;if(Z.warmStarting){Y.m_linearVelocity.x+=Y.m_invMass*this.m_impulse*this.m_J.linearA.x;Y.m_linearVelocity.y+=Y.m_invMass*this.m_impulse*this.m_J.linearA.y;Y.m_angularVelocity+=Y.m_invI*this.m_impulse*this.m_J.angularA;W.m_linearVelocity.x+=W.m_invMass*this.m_impulse*this.m_J.linearB.x;W.m_linearVelocity.y+=W.m_invMass*this.m_impulse*this.m_J.linearB.y;W.m_angularVelocity+=W.m_invI*this.m_impulse*this.m_J.angularB}else{this.m_impulse=0}};B.prototype.SolveVelocityConstraints=function(W){var Z=this.m_bodyA;var Y=this.m_bodyB;var aa=this.m_J.Compute(Z.m_linearVelocity,Z.m_angularVelocity,Y.m_linearVelocity,Y.m_angularVelocity);var X=(-this.m_mass*aa);this.m_impulse+=X;Z.m_linearVelocity.x+=Z.m_invMass*X*this.m_J.linearA.x;Z.m_linearVelocity.y+=Z.m_invMass*X*this.m_J.linearA.y;Z.m_angularVelocity+=Z.m_invI*X*this.m_J.angularA;Y.m_linearVelocity.x+=Y.m_invMass*X*this.m_J.linearB.x;Y.m_linearVelocity.y+=Y.m_invMass*X*this.m_J.linearB.y;Y.m_angularVelocity+=Y.m_invI*X*this.m_J.angularB};B.prototype.SolvePositionConstraints=function(W){if(W===undefined){W=0}var ad=0;var ac=this.m_bodyA;var Z=this.m_bodyB;var ab=0;var Y=0;if(this.m_revolute1){ab=this.m_revolute1.GetJointAngle()}else{ab=this.m_prismatic1.GetJointTranslation()}if(this.m_revolute2){Y=this.m_revolute2.GetJointAngle()}else{Y=this.m_prismatic2.GetJointTranslation()}var aa=this.m_constant-(ab+this.m_ratio*Y);var X=(-this.m_mass*aa);ac.m_sweep.c.x+=ac.m_invMass*X*this.m_J.linearA.x;ac.m_sweep.c.y+=ac.m_invMass*X*this.m_J.linearA.y;ac.m_sweep.a+=ac.m_invI*X*this.m_J.angularA;Z.m_sweep.c.x+=Z.m_invMass*X*this.m_J.linearB.x;Z.m_sweep.c.y+=Z.m_invMass*X*this.m_J.linearB.y;Z.m_sweep.a+=Z.m_invI*X*this.m_J.angularB;ac.SynchronizeTransform();Z.SynchronizeTransform();return ad<c.b2_linearSlop};Box2D.inherit(C,Box2D.Dynamics.Joints.b2JointDef);C.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;C.b2GearJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments)};C.prototype.b2GearJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_gearJoint;this.joint1=null;this.joint2=null;this.ratio=1};N.b2Jacobian=function(){this.linearA=new P();this.linearB=new P()};N.prototype.SetZero=function(){this.linearA.SetZero();this.angularA=0;this.linearB.SetZero();this.angularB=0};N.prototype.Set=function(Z,X,Y,W){if(X===undefined){X=0}if(W===undefined){W=0}this.linearA.SetV(Z);this.angularA=X;this.linearB.SetV(Y);this.angularB=W};N.prototype.Compute=function(Z,X,Y,W){if(X===undefined){X=0}if(W===undefined){W=0}return(this.linearA.x*Z.x+this.linearA.y*Z.y)+this.angularA*X+(this.linearB.x*Y.x+this.linearB.y*Y.y)+this.angularB*W};j.b2Joint=function(){this.m_edgeA=new Q();this.m_edgeB=new Q();this.m_localCenterA=new P();this.m_localCenterB=new P()};j.prototype.GetType=function(){return this.m_type};j.prototype.GetAnchorA=function(){return null};j.prototype.GetAnchorB=function(){return null};j.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return null};j.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return 0};j.prototype.GetBodyA=function(){return this.m_bodyA};j.prototype.GetBodyB=function(){return this.m_bodyB};j.prototype.GetNext=function(){return this.m_next};j.prototype.GetUserData=function(){return this.m_userData};j.prototype.SetUserData=function(W){this.m_userData=W};j.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()};j.Create=function(X,W){var Y=null;switch(X.type){case j.e_distanceJoint:Y=new s((X instanceof S?X:null));break;case j.e_mouseJoint:Y=new G((X instanceof d?X:null));break;case j.e_prismaticJoint:Y=new o((X instanceof v?X:null));break;case j.e_revoluteJoint:Y=new F((X instanceof a?X:null));break;case j.e_pulleyJoint:Y=new f((X instanceof T?X:null));break;case j.e_gearJoint:Y=new B((X instanceof C?X:null));break;case j.e_lineJoint:Y=new n((X instanceof g?X:null));break;case j.e_weldJoint:Y=new e((X instanceof z?X:null));break;case j.e_frictionJoint:Y=new b((X instanceof A?X:null));break;default:break}return Y};j.Destroy=function(X,W){};j.prototype.b2Joint=function(W){c.b2Assert(W.bodyA!=W.bodyB);this.m_type=W.type;this.m_prev=null;this.m_next=null;this.m_bodyA=W.bodyA;this.m_bodyB=W.bodyB;this.m_collideConnected=W.collideConnected;this.m_islandFlag=false;this.m_userData=W.userData};j.prototype.InitVelocityConstraints=function(W){};j.prototype.SolveVelocityConstraints=function(W){};j.prototype.FinalizeVelocityConstraints=function(){};j.prototype.SolvePositionConstraints=function(W){if(W===undefined){W=0}return false};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2Joint.e_unknownJoint=0;Box2D.Dynamics.Joints.b2Joint.e_revoluteJoint=1;Box2D.Dynamics.Joints.b2Joint.e_prismaticJoint=2;Box2D.Dynamics.Joints.b2Joint.e_distanceJoint=3;Box2D.Dynamics.Joints.b2Joint.e_pulleyJoint=4;Box2D.Dynamics.Joints.b2Joint.e_mouseJoint=5;Box2D.Dynamics.Joints.b2Joint.e_gearJoint=6;Box2D.Dynamics.Joints.b2Joint.e_lineJoint=7;Box2D.Dynamics.Joints.b2Joint.e_weldJoint=8;Box2D.Dynamics.Joints.b2Joint.e_frictionJoint=9;Box2D.Dynamics.Joints.b2Joint.e_inactiveLimit=0;Box2D.Dynamics.Joints.b2Joint.e_atLowerLimit=1;Box2D.Dynamics.Joints.b2Joint.e_atUpperLimit=2;Box2D.Dynamics.Joints.b2Joint.e_equalLimits=3});I.b2JointDef=function(){};I.prototype.b2JointDef=function(){this.type=j.e_unknownJoint;this.userData=null;this.bodyA=null;this.bodyB=null;this.collideConnected=false};Q.b2JointEdge=function(){};Box2D.inherit(n,Box2D.Dynamics.Joints.b2Joint);n.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;n.b2LineJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_localXAxis1=new P();this.m_localYAxis1=new P();this.m_axis=new P();this.m_perp=new P();this.m_K=new H();this.m_impulse=new P()};n.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};n.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};n.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x),W*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y))};n.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return W*this.m_impulse.y};n.prototype.GetJointTranslation=function(){var Y=this.m_bodyA;var X=this.m_bodyB;var ac;var ae=Y.GetWorldPoint(this.m_localAnchor1);var ad=X.GetWorldPoint(this.m_localAnchor2);var ab=ad.x-ae.x;var aa=ad.y-ae.y;var Z=Y.GetWorldVector(this.m_localXAxis1);var W=Z.x*ab+Z.y*aa;return W};n.prototype.GetJointSpeed=function(){var ap=this.m_bodyA;var ao=this.m_bodyB;var af;af=ap.m_xf.R;var an=this.m_localAnchor1.x-ap.m_sweep.localCenter.x;var am=this.m_localAnchor1.y-ap.m_sweep.localCenter.y;var ai=(af.col1.x*an+af.col2.x*am);am=(af.col1.y*an+af.col2.y*am);an=ai;af=ao.m_xf.R;var ae=this.m_localAnchor2.x-ao.m_sweep.localCenter.x;var ad=this.m_localAnchor2.y-ao.m_sweep.localCenter.y;ai=(af.col1.x*ae+af.col2.x*ad);ad=(af.col1.y*ae+af.col2.y*ad);ae=ai;var al=ap.m_sweep.c.x+an;var aj=ap.m_sweep.c.y+am;var Y=ao.m_sweep.c.x+ae;var W=ao.m_sweep.c.y+ad;var ac=Y-al;var ab=W-aj;var aa=ap.GetWorldVector(this.m_localXAxis1);var Z=ap.m_linearVelocity;var X=ao.m_linearVelocity;var ah=ap.m_angularVelocity;var ag=ao.m_angularVelocity;var ak=(ac*((-ah*aa.y))+ab*(ah*aa.x))+(aa.x*(((X.x+((-ag*ad)))-Z.x)-((-ah*am)))+aa.y*(((X.y+(ag*ae))-Z.y)-(ah*an)));return ak};n.prototype.IsLimitEnabled=function(){return this.m_enableLimit};n.prototype.EnableLimit=function(W){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableLimit=W};n.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};n.prototype.GetUpperLimit=function(){return this.m_upperTranslation};n.prototype.SetLimits=function(W,X){if(W===undefined){W=0}if(X===undefined){X=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_lowerTranslation=W;this.m_upperTranslation=X};n.prototype.IsMotorEnabled=function(){return this.m_enableMotor};n.prototype.EnableMotor=function(W){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableMotor=W};n.prototype.SetMotorSpeed=function(W){if(W===undefined){W=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=W};n.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};n.prototype.SetMaxMotorForce=function(W){if(W===undefined){W=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_maxMotorForce=W};n.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce};n.prototype.GetMotorForce=function(){return this.m_motorImpulse};n.prototype.b2LineJoint=function(Y){this.__super.b2Joint.call(this,Y);var X;var W=0;var Z=0;this.m_localAnchor1.SetV(Y.localAnchorA);this.m_localAnchor2.SetV(Y.localAnchorB);this.m_localXAxis1.SetV(Y.localAxisA);this.m_localYAxis1.x=(-this.m_localXAxis1.y);this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_impulse.SetZero();this.m_motorMass=0;this.m_motorImpulse=0;this.m_lowerTranslation=Y.lowerTranslation;this.m_upperTranslation=Y.upperTranslation;this.m_maxMotorForce=Y.maxMotorForce;this.m_motorSpeed=Y.motorSpeed;this.m_enableLimit=Y.enableLimit;this.m_enableMotor=Y.enableMotor;this.m_limitState=j.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};n.prototype.InitVelocityConstraints=function(ae){var ar=this.m_bodyA;var aq=this.m_bodyB;var ah;var ai=0;this.m_localCenterA.SetV(ar.GetLocalCenter());this.m_localCenterB.SetV(aq.GetLocalCenter());var Z=ar.GetTransform();var X=aq.GetTransform();ah=ar.m_xf.R;var ap=this.m_localAnchor1.x-this.m_localCenterA.x;var an=this.m_localAnchor1.y-this.m_localCenterA.y;ai=(ah.col1.x*ap+ah.col2.x*an);an=(ah.col1.y*ap+ah.col2.y*an);ap=ai;ah=aq.m_xf.R;var ad=this.m_localAnchor2.x-this.m_localCenterB.x;var ac=this.m_localAnchor2.y-this.m_localCenterB.y;ai=(ah.col1.x*ad+ah.col2.x*ac);ac=(ah.col1.y*ad+ah.col2.y*ac);ad=ai;var ab=aq.m_sweep.c.x+ad-ar.m_sweep.c.x-ap;var aa=aq.m_sweep.c.y+ac-ar.m_sweep.c.y-an;this.m_invMassA=ar.m_invMass;this.m_invMassB=aq.m_invMass;this.m_invIA=ar.m_invI;this.m_invIB=aq.m_invI;this.m_axis.SetV(t.MulMV(Z.R,this.m_localXAxis1));this.m_a1=(ab+ap)*this.m_axis.y-(aa+an)*this.m_axis.x;this.m_a2=ad*this.m_axis.y-ac*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;this.m_motorMass=this.m_motorMass>Number.MIN_VALUE?1/this.m_motorMass:0;this.m_perp.SetV(t.MulMV(Z.R,this.m_localYAxis1));this.m_s1=(ab+ap)*this.m_perp.y-(aa+an)*this.m_perp.x;this.m_s2=ad*this.m_perp.y-ac*this.m_perp.x;var Y=this.m_invMassA;var W=this.m_invMassB;var ak=this.m_invIA;var aj=this.m_invIB;this.m_K.col1.x=Y+W+ak*this.m_s1*this.m_s1+aj*this.m_s2*this.m_s2;this.m_K.col1.y=ak*this.m_s1*this.m_a1+aj*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=Y+W+ak*this.m_a1*this.m_a1+aj*this.m_a2*this.m_a2;if(this.m_enableLimit){var ao=this.m_axis.x*ab+this.m_axis.y*aa;if(t.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*c.b2_linearSlop){this.m_limitState=j.e_equalLimits}else{if(ao<=this.m_lowerTranslation){if(this.m_limitState!=j.e_atLowerLimit){this.m_limitState=j.e_atLowerLimit;this.m_impulse.y=0}}else{if(ao>=this.m_upperTranslation){if(this.m_limitState!=j.e_atUpperLimit){this.m_limitState=j.e_atUpperLimit;this.m_impulse.y=0}}else{this.m_limitState=j.e_inactiveLimit;this.m_impulse.y=0}}}}else{this.m_limitState=j.e_inactiveLimit}if(this.m_enableMotor==false){this.m_motorImpulse=0}if(ae.warmStarting){this.m_impulse.x*=ae.dtRatio;this.m_impulse.y*=ae.dtRatio;this.m_motorImpulse*=ae.dtRatio;var ag=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.x;var af=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.y)*this.m_axis.y;var am=this.m_impulse.x*this.m_s1+(this.m_motorImpulse+this.m_impulse.y)*this.m_a1;var al=this.m_impulse.x*this.m_s2+(this.m_motorImpulse+this.m_impulse.y)*this.m_a2;ar.m_linearVelocity.x-=this.m_invMassA*ag;ar.m_linearVelocity.y-=this.m_invMassA*af;ar.m_angularVelocity-=this.m_invIA*am;aq.m_linearVelocity.x+=this.m_invMassB*ag;aq.m_linearVelocity.y+=this.m_invMassB*af;aq.m_angularVelocity+=this.m_invIB*al}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};n.prototype.SolveVelocityConstraints=function(ac){var ar=this.m_bodyA;var ap=this.m_bodyB;var aa=ar.m_linearVelocity;var ah=ar.m_angularVelocity;var Z=ap.m_linearVelocity;var ag=ap.m_angularVelocity;var ae=0;var ad=0;var am=0;var al=0;if(this.m_enableMotor&&this.m_limitState!=j.e_equalLimits){var aj=this.m_axis.x*(Z.x-aa.x)+this.m_axis.y*(Z.y-aa.y)+this.m_a2*ag-this.m_a1*ah;var af=this.m_motorMass*(this.m_motorSpeed-aj);var ab=this.m_motorImpulse;var ai=ac.dt*this.m_maxMotorForce;this.m_motorImpulse=t.Clamp(this.m_motorImpulse+af,(-ai),ai);af=this.m_motorImpulse-ab;ae=af*this.m_axis.x;ad=af*this.m_axis.y;am=af*this.m_a1;al=af*this.m_a2;aa.x-=this.m_invMassA*ae;aa.y-=this.m_invMassA*ad;ah-=this.m_invIA*am;Z.x+=this.m_invMassB*ae;Z.y+=this.m_invMassB*ad;ag+=this.m_invIB*al}var Y=this.m_perp.x*(Z.x-aa.x)+this.m_perp.y*(Z.y-aa.y)+this.m_s2*ag-this.m_s1*ah;if(this.m_enableLimit&&this.m_limitState!=j.e_inactiveLimit){var X=this.m_axis.x*(Z.x-aa.x)+this.m_axis.y*(Z.y-aa.y)+this.m_a2*ag-this.m_a1*ah;var ak=this.m_impulse.Copy();var an=this.m_K.Solve(new P(),(-Y),(-X));this.m_impulse.Add(an);if(this.m_limitState==j.e_atLowerLimit){this.m_impulse.y=t.Max(this.m_impulse.y,0)}else{if(this.m_limitState==j.e_atUpperLimit){this.m_impulse.y=t.Min(this.m_impulse.y,0)}}var ao=(-Y)-(this.m_impulse.y-ak.y)*this.m_K.col2.x;var W=0;if(this.m_K.col1.x!=0){W=ao/this.m_K.col1.x+ak.x}else{W=ak.x}this.m_impulse.x=W;an.x=this.m_impulse.x-ak.x;an.y=this.m_impulse.y-ak.y;ae=an.x*this.m_perp.x+an.y*this.m_axis.x;ad=an.x*this.m_perp.y+an.y*this.m_axis.y;am=an.x*this.m_s1+an.y*this.m_a1;al=an.x*this.m_s2+an.y*this.m_a2;aa.x-=this.m_invMassA*ae;aa.y-=this.m_invMassA*ad;ah-=this.m_invIA*am;Z.x+=this.m_invMassB*ae;Z.y+=this.m_invMassB*ad;ag+=this.m_invIB*al}else{var aq=0;if(this.m_K.col1.x!=0){aq=((-Y))/this.m_K.col1.x}else{aq=0}this.m_impulse.x+=aq;ae=aq*this.m_perp.x;ad=aq*this.m_perp.y;am=aq*this.m_s1;al=aq*this.m_s2;aa.x-=this.m_invMassA*ae;aa.y-=this.m_invMassA*ad;ah-=this.m_invIA*am;Z.x+=this.m_invMassB*ae;Z.y+=this.m_invMassB*ad;ag+=this.m_invIB*al}ar.m_linearVelocity.SetV(aa);ar.m_angularVelocity=ah;ap.m_linearVelocity.SetV(Z);ap.m_angularVelocity=ag};n.prototype.SolvePositionConstraints=function(ah){if(ah===undefined){ah=0}var W=0;var at=0;var af=this.m_bodyA;var ae=this.m_bodyB;var aa=af.m_sweep.c;var ax=af.m_sweep.a;var Z=ae.m_sweep.c;var aw=ae.m_sweep.a;var ay;var ad=0;var aE=0;var aD=0;var ac=0;var ab=0;var Y=0;var ag=0;var aA=false;var am=0;var ar=H.FromAngle(ax);var aq=H.FromAngle(aw);ay=ar;var aC=this.m_localAnchor1.x-this.m_localCenterA.x;var aB=this.m_localAnchor1.y-this.m_localCenterA.y;ad=(ay.col1.x*aC+ay.col2.x*aB);aB=(ay.col1.y*aC+ay.col2.y*aB);aC=ad;ay=aq;var al=this.m_localAnchor2.x-this.m_localCenterB.x;var ak=this.m_localAnchor2.y-this.m_localCenterB.y;ad=(ay.col1.x*al+ay.col2.x*ak);ak=(ay.col1.y*al+ay.col2.y*ak);al=ad;var aj=Z.x+al-aa.x-aC;var ai=Z.y+ak-aa.y-aB;if(this.m_enableLimit){this.m_axis=t.MulMV(ar,this.m_localXAxis1);this.m_a1=(aj+aC)*this.m_axis.y-(ai+aB)*this.m_axis.x;this.m_a2=al*this.m_axis.y-ak*this.m_axis.x;var az=this.m_axis.x*aj+this.m_axis.y*ai;if(t.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*c.b2_linearSlop){am=t.Clamp(az,(-c.b2_maxLinearCorrection),c.b2_maxLinearCorrection);Y=t.Abs(az);aA=true}else{if(az<=this.m_lowerTranslation){am=t.Clamp(az-this.m_lowerTranslation+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);Y=this.m_lowerTranslation-az;aA=true}else{if(az>=this.m_upperTranslation){am=t.Clamp(az-this.m_upperTranslation+c.b2_linearSlop,0,c.b2_maxLinearCorrection);Y=az-this.m_upperTranslation;aA=true}}}}this.m_perp=t.MulMV(ar,this.m_localYAxis1);this.m_s1=(aj+aC)*this.m_perp.y-(ai+aB)*this.m_perp.x;this.m_s2=al*this.m_perp.y-ak*this.m_perp.x;var au=new P();var an=this.m_perp.x*aj+this.m_perp.y*ai;Y=t.Max(Y,t.Abs(an));ag=0;if(aA){aE=this.m_invMassA;aD=this.m_invMassB;ac=this.m_invIA;ab=this.m_invIB;this.m_K.col1.x=aE+aD+ac*this.m_s1*this.m_s1+ab*this.m_s2*this.m_s2;this.m_K.col1.y=ac*this.m_s1*this.m_a1+ab*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=aE+aD+ac*this.m_a1*this.m_a1+ab*this.m_a2*this.m_a2;this.m_K.Solve(au,(-an),(-am))}else{aE=this.m_invMassA;aD=this.m_invMassB;ac=this.m_invIA;ab=this.m_invIB;var X=aE+aD+ac*this.m_s1*this.m_s1+ab*this.m_s2*this.m_s2;var av=0;if(X!=0){av=((-an))/X}else{av=0}au.x=av;au.y=0}var aG=au.x*this.m_perp.x+au.y*this.m_axis.x;var aF=au.x*this.m_perp.y+au.y*this.m_axis.y;var ap=au.x*this.m_s1+au.y*this.m_a1;var ao=au.x*this.m_s2+au.y*this.m_a2;aa.x-=this.m_invMassA*aG;aa.y-=this.m_invMassA*aF;ax-=this.m_invIA*ap;Z.x+=this.m_invMassB*aG;Z.y+=this.m_invMassB*aF;aw+=this.m_invIB*ao;af.m_sweep.a=ax;ae.m_sweep.a=aw;af.SynchronizeTransform();ae.SynchronizeTransform();return Y<=c.b2_linearSlop&&ag<=c.b2_angularSlop};Box2D.inherit(g,Box2D.Dynamics.Joints.b2JointDef);g.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;g.b2LineJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P();this.localAxisA=new P()};g.prototype.b2LineJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_lineJoint;this.localAxisA.Set(1,0);this.enableLimit=false;this.lowerTranslation=0;this.upperTranslation=0;this.enableMotor=false;this.maxMotorForce=0;this.motorSpeed=0};g.prototype.Initialize=function(Z,Y,W,X){this.bodyA=Z;this.bodyB=Y;this.localAnchorA=this.bodyA.GetLocalPoint(W);this.localAnchorB=this.bodyB.GetLocalPoint(W);this.localAxisA=this.bodyA.GetLocalVector(X)};Box2D.inherit(G,Box2D.Dynamics.Joints.b2Joint);G.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;G.b2MouseJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new H();this.K1=new H();this.K2=new H();this.m_localAnchor=new P();this.m_target=new P();this.m_impulse=new P();this.m_mass=new H();this.m_C=new P()};G.prototype.GetAnchorA=function(){return this.m_target};G.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor)};G.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*this.m_impulse.x,W*this.m_impulse.y)};G.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return 0};G.prototype.GetTarget=function(){return this.m_target};G.prototype.SetTarget=function(W){if(this.m_bodyB.IsAwake()==false){this.m_bodyB.SetAwake(true)}this.m_target=W};G.prototype.GetMaxForce=function(){return this.m_maxForce};G.prototype.SetMaxForce=function(W){if(W===undefined){W=0}this.m_maxForce=W};G.prototype.GetFrequency=function(){return this.m_frequencyHz};G.prototype.SetFrequency=function(W){if(W===undefined){W=0}this.m_frequencyHz=W};G.prototype.GetDampingRatio=function(){return this.m_dampingRatio};G.prototype.SetDampingRatio=function(W){if(W===undefined){W=0}this.m_dampingRatio=W};G.prototype.b2MouseJoint=function(Y){this.__super.b2Joint.call(this,Y);this.m_target.SetV(Y.target);var W=this.m_target.x-this.m_bodyB.m_xf.position.x;var Z=this.m_target.y-this.m_bodyB.m_xf.position.y;var X=this.m_bodyB.m_xf.R;this.m_localAnchor.x=(W*X.col1.x+Z*X.col1.y);this.m_localAnchor.y=(W*X.col2.x+Z*X.col2.y);this.m_maxForce=Y.maxForce;this.m_impulse.SetZero();this.m_frequencyHz=Y.frequencyHz;this.m_dampingRatio=Y.dampingRatio;this.m_beta=0;this.m_gamma=0};G.prototype.InitVelocityConstraints=function(W){var af=this.m_bodyB;var ad=af.GetMass();var ah=2*Math.PI*this.m_frequencyHz;var ac=2*ad*this.m_dampingRatio*ah;var Z=ad*ah*ah;this.m_gamma=W.dt*(ac+W.dt*Z);this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0;this.m_beta=W.dt*Z*this.m_gamma;var ae;ae=af.m_xf.R;var ab=this.m_localAnchor.x-af.m_sweep.localCenter.x;var aa=this.m_localAnchor.y-af.m_sweep.localCenter.y;var ag=(ae.col1.x*ab+ae.col2.x*aa);aa=(ae.col1.y*ab+ae.col2.y*aa);ab=ag;var Y=af.m_invMass;var X=af.m_invI;this.K1.col1.x=Y;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=Y;this.K2.col1.x=X*aa*aa;this.K2.col2.x=(-X*ab*aa);this.K2.col1.y=(-X*ab*aa);this.K2.col2.y=X*ab*ab;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.col1.x+=this.m_gamma;this.K.col2.y+=this.m_gamma;this.K.GetInverse(this.m_mass);this.m_C.x=af.m_sweep.c.x+ab-this.m_target.x;this.m_C.y=af.m_sweep.c.y+aa-this.m_target.y;af.m_angularVelocity*=0.98;this.m_impulse.x*=W.dtRatio;this.m_impulse.y*=W.dtRatio;af.m_linearVelocity.x+=Y*this.m_impulse.x;af.m_linearVelocity.y+=Y*this.m_impulse.y;af.m_angularVelocity+=X*(ab*this.m_impulse.y-aa*this.m_impulse.x)};G.prototype.SolveVelocityConstraints=function(Z){var ag=this.m_bodyB;var af;var ai=0;var ah=0;af=ag.m_xf.R;var ad=this.m_localAnchor.x-ag.m_sweep.localCenter.x;var ab=this.m_localAnchor.y-ag.m_sweep.localCenter.y;ai=(af.col1.x*ad+af.col2.x*ab);ab=(af.col1.y*ad+af.col2.y*ab);ad=ai;var W=ag.m_linearVelocity.x+((-ag.m_angularVelocity*ab));var aj=ag.m_linearVelocity.y+(ag.m_angularVelocity*ad);af=this.m_mass;ai=W+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x;ah=aj+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var aa=(-(af.col1.x*ai+af.col2.x*ah));var Y=(-(af.col1.y*ai+af.col2.y*ah));var ae=this.m_impulse.x;var ac=this.m_impulse.y;this.m_impulse.x+=aa;this.m_impulse.y+=Y;var X=Z.dt*this.m_maxForce;if(this.m_impulse.LengthSquared()>X*X){this.m_impulse.Multiply(X/this.m_impulse.Length())}aa=this.m_impulse.x-ae;Y=this.m_impulse.y-ac;ag.m_linearVelocity.x+=ag.m_invMass*aa;ag.m_linearVelocity.y+=ag.m_invMass*Y;ag.m_angularVelocity+=ag.m_invI*(ad*Y-ab*aa)};G.prototype.SolvePositionConstraints=function(W){if(W===undefined){W=0}return true};Box2D.inherit(d,Box2D.Dynamics.Joints.b2JointDef);d.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;d.b2MouseJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.target=new P()};d.prototype.b2MouseJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_mouseJoint;this.maxForce=0;this.frequencyHz=5;this.dampingRatio=0.7};Box2D.inherit(o,Box2D.Dynamics.Joints.b2Joint);o.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;o.b2PrismaticJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_localXAxis1=new P();this.m_localYAxis1=new P();this.m_axis=new P();this.m_perp=new P();this.m_K=new m();this.m_impulse=new O()};o.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};o.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};o.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),W*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))};o.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return W*this.m_impulse.y};o.prototype.GetJointTranslation=function(){var Y=this.m_bodyA;var X=this.m_bodyB;var ac;var ae=Y.GetWorldPoint(this.m_localAnchor1);var ad=X.GetWorldPoint(this.m_localAnchor2);var ab=ad.x-ae.x;var aa=ad.y-ae.y;var Z=Y.GetWorldVector(this.m_localXAxis1);var W=Z.x*ab+Z.y*aa;return W};o.prototype.GetJointSpeed=function(){var ap=this.m_bodyA;var ao=this.m_bodyB;var af;af=ap.m_xf.R;var an=this.m_localAnchor1.x-ap.m_sweep.localCenter.x;var am=this.m_localAnchor1.y-ap.m_sweep.localCenter.y;var ai=(af.col1.x*an+af.col2.x*am);am=(af.col1.y*an+af.col2.y*am);an=ai;af=ao.m_xf.R;var ae=this.m_localAnchor2.x-ao.m_sweep.localCenter.x;var ad=this.m_localAnchor2.y-ao.m_sweep.localCenter.y;ai=(af.col1.x*ae+af.col2.x*ad);ad=(af.col1.y*ae+af.col2.y*ad);ae=ai;var al=ap.m_sweep.c.x+an;var aj=ap.m_sweep.c.y+am;var Y=ao.m_sweep.c.x+ae;var W=ao.m_sweep.c.y+ad;var ac=Y-al;var ab=W-aj;var aa=ap.GetWorldVector(this.m_localXAxis1);var Z=ap.m_linearVelocity;var X=ao.m_linearVelocity;var ah=ap.m_angularVelocity;var ag=ao.m_angularVelocity;var ak=(ac*((-ah*aa.y))+ab*(ah*aa.x))+(aa.x*(((X.x+((-ag*ad)))-Z.x)-((-ah*am)))+aa.y*(((X.y+(ag*ae))-Z.y)-(ah*an)));return ak};o.prototype.IsLimitEnabled=function(){return this.m_enableLimit};o.prototype.EnableLimit=function(W){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableLimit=W};o.prototype.GetLowerLimit=function(){return this.m_lowerTranslation};o.prototype.GetUpperLimit=function(){return this.m_upperTranslation};o.prototype.SetLimits=function(W,X){if(W===undefined){W=0}if(X===undefined){X=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_lowerTranslation=W;this.m_upperTranslation=X};o.prototype.IsMotorEnabled=function(){return this.m_enableMotor};o.prototype.EnableMotor=function(W){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_enableMotor=W};o.prototype.SetMotorSpeed=function(W){if(W===undefined){W=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=W};o.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};o.prototype.SetMaxMotorForce=function(W){if(W===undefined){W=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_maxMotorForce=W};o.prototype.GetMotorForce=function(){return this.m_motorImpulse};o.prototype.b2PrismaticJoint=function(Y){this.__super.b2Joint.call(this,Y);var X;var W=0;var Z=0;this.m_localAnchor1.SetV(Y.localAnchorA);this.m_localAnchor2.SetV(Y.localAnchorB);this.m_localXAxis1.SetV(Y.localAxisA);this.m_localYAxis1.x=(-this.m_localXAxis1.y);this.m_localYAxis1.y=this.m_localXAxis1.x;this.m_refAngle=Y.referenceAngle;this.m_impulse.SetZero();this.m_motorMass=0;this.m_motorImpulse=0;this.m_lowerTranslation=Y.lowerTranslation;this.m_upperTranslation=Y.upperTranslation;this.m_maxMotorForce=Y.maxMotorForce;this.m_motorSpeed=Y.motorSpeed;this.m_enableLimit=Y.enableLimit;this.m_enableMotor=Y.enableMotor;this.m_limitState=j.e_inactiveLimit;this.m_axis.SetZero();this.m_perp.SetZero()};o.prototype.InitVelocityConstraints=function(ae){var ar=this.m_bodyA;var aq=this.m_bodyB;var ah;var ai=0;this.m_localCenterA.SetV(ar.GetLocalCenter());this.m_localCenterB.SetV(aq.GetLocalCenter());var Z=ar.GetTransform();var X=aq.GetTransform();ah=ar.m_xf.R;var ap=this.m_localAnchor1.x-this.m_localCenterA.x;var an=this.m_localAnchor1.y-this.m_localCenterA.y;ai=(ah.col1.x*ap+ah.col2.x*an);an=(ah.col1.y*ap+ah.col2.y*an);ap=ai;ah=aq.m_xf.R;var ad=this.m_localAnchor2.x-this.m_localCenterB.x;var ac=this.m_localAnchor2.y-this.m_localCenterB.y;ai=(ah.col1.x*ad+ah.col2.x*ac);ac=(ah.col1.y*ad+ah.col2.y*ac);ad=ai;var ab=aq.m_sweep.c.x+ad-ar.m_sweep.c.x-ap;var aa=aq.m_sweep.c.y+ac-ar.m_sweep.c.y-an;this.m_invMassA=ar.m_invMass;this.m_invMassB=aq.m_invMass;this.m_invIA=ar.m_invI;this.m_invIB=aq.m_invI;this.m_axis.SetV(t.MulMV(Z.R,this.m_localXAxis1));this.m_a1=(ab+ap)*this.m_axis.y-(aa+an)*this.m_axis.x;this.m_a2=ad*this.m_axis.y-ac*this.m_axis.x;this.m_motorMass=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_a1*this.m_a1+this.m_invIB*this.m_a2*this.m_a2;if(this.m_motorMass>Number.MIN_VALUE){this.m_motorMass=1/this.m_motorMass}this.m_perp.SetV(t.MulMV(Z.R,this.m_localYAxis1));this.m_s1=(ab+ap)*this.m_perp.y-(aa+an)*this.m_perp.x;this.m_s2=ad*this.m_perp.y-ac*this.m_perp.x;var Y=this.m_invMassA;var W=this.m_invMassB;var ak=this.m_invIA;var aj=this.m_invIB;this.m_K.col1.x=Y+W+ak*this.m_s1*this.m_s1+aj*this.m_s2*this.m_s2;this.m_K.col1.y=ak*this.m_s1+aj*this.m_s2;this.m_K.col1.z=ak*this.m_s1*this.m_a1+aj*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=ak+aj;this.m_K.col2.z=ak*this.m_a1+aj*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=Y+W+ak*this.m_a1*this.m_a1+aj*this.m_a2*this.m_a2;if(this.m_enableLimit){var ao=this.m_axis.x*ab+this.m_axis.y*aa;if(t.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*c.b2_linearSlop){this.m_limitState=j.e_equalLimits}else{if(ao<=this.m_lowerTranslation){if(this.m_limitState!=j.e_atLowerLimit){this.m_limitState=j.e_atLowerLimit;this.m_impulse.z=0}}else{if(ao>=this.m_upperTranslation){if(this.m_limitState!=j.e_atUpperLimit){this.m_limitState=j.e_atUpperLimit;this.m_impulse.z=0}}else{this.m_limitState=j.e_inactiveLimit;this.m_impulse.z=0}}}}else{this.m_limitState=j.e_inactiveLimit}if(this.m_enableMotor==false){this.m_motorImpulse=0}if(ae.warmStarting){this.m_impulse.x*=ae.dtRatio;this.m_impulse.y*=ae.dtRatio;this.m_motorImpulse*=ae.dtRatio;var ag=this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x;var af=this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y;var am=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1;var al=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;ar.m_linearVelocity.x-=this.m_invMassA*ag;ar.m_linearVelocity.y-=this.m_invMassA*af;ar.m_angularVelocity-=this.m_invIA*am;aq.m_linearVelocity.x+=this.m_invMassB*ag;aq.m_linearVelocity.y+=this.m_invMassB*af;aq.m_angularVelocity+=this.m_invIB*al}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};o.prototype.SolveVelocityConstraints=function(ab){var au=this.m_bodyA;var ar=this.m_bodyB;var Z=au.m_linearVelocity;var ah=au.m_angularVelocity;var Y=ar.m_linearVelocity;var af=ar.m_angularVelocity;var ad=0;var ac=0;var ap=0;var ao=0;if(this.m_enableMotor&&this.m_limitState!=j.e_equalLimits){var ak=this.m_axis.x*(Y.x-Z.x)+this.m_axis.y*(Y.y-Z.y)+this.m_a2*af-this.m_a1*ah;var ae=this.m_motorMass*(this.m_motorSpeed-ak);var aa=this.m_motorImpulse;var aj=ab.dt*this.m_maxMotorForce;this.m_motorImpulse=t.Clamp(this.m_motorImpulse+ae,(-aj),aj);ae=this.m_motorImpulse-aa;ad=ae*this.m_axis.x;ac=ae*this.m_axis.y;ap=ae*this.m_a1;ao=ae*this.m_a2;Z.x-=this.m_invMassA*ad;Z.y-=this.m_invMassA*ac;ah-=this.m_invIA*ap;Y.x+=this.m_invMassB*ad;Y.y+=this.m_invMassB*ac;af+=this.m_invIB*ao}var an=this.m_perp.x*(Y.x-Z.x)+this.m_perp.y*(Y.y-Z.y)+this.m_s2*af-this.m_s1*ah;var am=af-ah;if(this.m_enableLimit&&this.m_limitState!=j.e_inactiveLimit){var X=this.m_axis.x*(Y.x-Z.x)+this.m_axis.y*(Y.y-Z.y)+this.m_a2*af-this.m_a1*ah;var al=this.m_impulse.Copy();var aq=this.m_K.Solve33(new O(),(-an),(-am),(-X));this.m_impulse.Add(aq);if(this.m_limitState==j.e_atLowerLimit){this.m_impulse.z=t.Max(this.m_impulse.z,0)}else{if(this.m_limitState==j.e_atUpperLimit){this.m_impulse.z=t.Min(this.m_impulse.z,0)}}var ai=(-an)-(this.m_impulse.z-al.z)*this.m_K.col3.x;var ag=(-am)-(this.m_impulse.z-al.z)*this.m_K.col3.y;var W=this.m_K.Solve22(new P(),ai,ag);W.x+=al.x;W.y+=al.y;this.m_impulse.x=W.x;this.m_impulse.y=W.y;aq.x=this.m_impulse.x-al.x;aq.y=this.m_impulse.y-al.y;aq.z=this.m_impulse.z-al.z;ad=aq.x*this.m_perp.x+aq.z*this.m_axis.x;ac=aq.x*this.m_perp.y+aq.z*this.m_axis.y;ap=aq.x*this.m_s1+aq.y+aq.z*this.m_a1;ao=aq.x*this.m_s2+aq.y+aq.z*this.m_a2;Z.x-=this.m_invMassA*ad;Z.y-=this.m_invMassA*ac;ah-=this.m_invIA*ap;Y.x+=this.m_invMassB*ad;Y.y+=this.m_invMassB*ac;af+=this.m_invIB*ao}else{var at=this.m_K.Solve22(new P(),(-an),(-am));this.m_impulse.x+=at.x;this.m_impulse.y+=at.y;ad=at.x*this.m_perp.x;ac=at.x*this.m_perp.y;ap=at.x*this.m_s1+at.y;ao=at.x*this.m_s2+at.y;Z.x-=this.m_invMassA*ad;Z.y-=this.m_invMassA*ac;ah-=this.m_invIA*ap;Y.x+=this.m_invMassB*ad;Y.y+=this.m_invMassB*ac;af+=this.m_invIB*ao}au.m_linearVelocity.SetV(Z);au.m_angularVelocity=ah;ar.m_linearVelocity.SetV(Y);ar.m_angularVelocity=af};o.prototype.SolvePositionConstraints=function(ak){if(ak===undefined){ak=0}var W=0;var av=0;var ai=this.m_bodyA;var ag=this.m_bodyB;var ab=ai.m_sweep.c;var aA=ai.m_sweep.a;var aa=ag.m_sweep.c;var az=ag.m_sweep.a;var aB;var ae=0;var aH=0;var aG=0;var ad=0;var ac=0;var Z=0;var aj=0;var aD=false;var ap=0;var au=H.FromAngle(aA);var at=H.FromAngle(az);aB=au;var aF=this.m_localAnchor1.x-this.m_localCenterA.x;var aE=this.m_localAnchor1.y-this.m_localCenterA.y;ae=(aB.col1.x*aF+aB.col2.x*aE);aE=(aB.col1.y*aF+aB.col2.y*aE);aF=ae;aB=at;var ao=this.m_localAnchor2.x-this.m_localCenterB.x;var an=this.m_localAnchor2.y-this.m_localCenterB.y;ae=(aB.col1.x*ao+aB.col2.x*an);an=(aB.col1.y*ao+aB.col2.y*an);ao=ae;var am=aa.x+ao-ab.x-aF;var al=aa.y+an-ab.y-aE;if(this.m_enableLimit){this.m_axis=t.MulMV(au,this.m_localXAxis1);this.m_a1=(am+aF)*this.m_axis.y-(al+aE)*this.m_axis.x;this.m_a2=ao*this.m_axis.y-an*this.m_axis.x;var aC=this.m_axis.x*am+this.m_axis.y*al;if(t.Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*c.b2_linearSlop){ap=t.Clamp(aC,(-c.b2_maxLinearCorrection),c.b2_maxLinearCorrection);Z=t.Abs(aC);aD=true}else{if(aC<=this.m_lowerTranslation){ap=t.Clamp(aC-this.m_lowerTranslation+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);Z=this.m_lowerTranslation-aC;aD=true}else{if(aC>=this.m_upperTranslation){ap=t.Clamp(aC-this.m_upperTranslation+c.b2_linearSlop,0,c.b2_maxLinearCorrection);Z=aC-this.m_upperTranslation;aD=true}}}}this.m_perp=t.MulMV(au,this.m_localYAxis1);this.m_s1=(am+aF)*this.m_perp.y-(al+aE)*this.m_perp.x;this.m_s2=ao*this.m_perp.y-an*this.m_perp.x;var ax=new O();var ah=this.m_perp.x*am+this.m_perp.y*al;var af=az-aA-this.m_refAngle;Z=t.Max(Z,t.Abs(ah));aj=t.Abs(af);if(aD){aH=this.m_invMassA;aG=this.m_invMassB;ad=this.m_invIA;ac=this.m_invIB;this.m_K.col1.x=aH+aG+ad*this.m_s1*this.m_s1+ac*this.m_s2*this.m_s2;this.m_K.col1.y=ad*this.m_s1+ac*this.m_s2;this.m_K.col1.z=ad*this.m_s1*this.m_a1+ac*this.m_s2*this.m_a2;this.m_K.col2.x=this.m_K.col1.y;this.m_K.col2.y=ad+ac;this.m_K.col2.z=ad*this.m_a1+ac*this.m_a2;this.m_K.col3.x=this.m_K.col1.z;this.m_K.col3.y=this.m_K.col2.z;this.m_K.col3.z=aH+aG+ad*this.m_a1*this.m_a1+ac*this.m_a2*this.m_a2;this.m_K.Solve33(ax,(-ah),(-af),(-ap))}else{aH=this.m_invMassA;aG=this.m_invMassB;ad=this.m_invIA;ac=this.m_invIB;var Y=aH+aG+ad*this.m_s1*this.m_s1+ac*this.m_s2*this.m_s2;var X=ad*this.m_s1+ac*this.m_s2;var aw=ad+ac;this.m_K.col1.Set(Y,X,0);this.m_K.col2.Set(X,aw,0);var ay=this.m_K.Solve22(new P(),(-ah),(-af));ax.x=ay.x;ax.y=ay.y;ax.z=0}var aJ=ax.x*this.m_perp.x+ax.z*this.m_axis.x;var aI=ax.x*this.m_perp.y+ax.z*this.m_axis.y;var ar=ax.x*this.m_s1+ax.y+ax.z*this.m_a1;var aq=ax.x*this.m_s2+ax.y+ax.z*this.m_a2;ab.x-=this.m_invMassA*aJ;ab.y-=this.m_invMassA*aI;aA-=this.m_invIA*ar;aa.x+=this.m_invMassB*aJ;aa.y+=this.m_invMassB*aI;az+=this.m_invIB*aq;ai.m_sweep.a=aA;ag.m_sweep.a=az;ai.SynchronizeTransform();ag.SynchronizeTransform();return Z<=c.b2_linearSlop&&aj<=c.b2_angularSlop};Box2D.inherit(v,Box2D.Dynamics.Joints.b2JointDef);v.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;v.b2PrismaticJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P();this.localAxisA=new P()};v.prototype.b2PrismaticJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_prismaticJoint;this.localAxisA.Set(1,0);this.referenceAngle=0;this.enableLimit=false;this.lowerTranslation=0;this.upperTranslation=0;this.enableMotor=false;this.maxMotorForce=0;this.motorSpeed=0};v.prototype.Initialize=function(Z,Y,W,X){this.bodyA=Z;this.bodyB=Y;this.localAnchorA=this.bodyA.GetLocalPoint(W);this.localAnchorB=this.bodyB.GetLocalPoint(W);this.localAxisA=this.bodyA.GetLocalVector(X);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(f,Box2D.Dynamics.Joints.b2Joint);f.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;f.b2PulleyJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_groundAnchor1=new P();this.m_groundAnchor2=new P();this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_u1=new P();this.m_u2=new P()};f.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};f.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};f.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*this.m_impulse*this.m_u2.x,W*this.m_impulse*this.m_u2.y)};f.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return 0};f.prototype.GetGroundAnchorA=function(){var W=this.m_ground.m_xf.position.Copy();W.Add(this.m_groundAnchor1);return W};f.prototype.GetGroundAnchorB=function(){var W=this.m_ground.m_xf.position.Copy();W.Add(this.m_groundAnchor2);return W};f.prototype.GetLength1=function(){var Z=this.m_bodyA.GetWorldPoint(this.m_localAnchor1);var aa=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x;var Y=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y;var X=Z.x-aa;var W=Z.y-Y;return Math.sqrt(X*X+W*W)};f.prototype.GetLength2=function(){var Z=this.m_bodyB.GetWorldPoint(this.m_localAnchor2);var aa=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x;var Y=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;var X=Z.x-aa;var W=Z.y-Y;return Math.sqrt(X*X+W*W)};f.prototype.GetRatio=function(){return this.m_ratio};f.prototype.b2PulleyJoint=function(Y){this.__super.b2Joint.call(this,Y);var X;var W=0;var Z=0;this.m_ground=this.m_bodyA.m_world.m_groundBody;this.m_groundAnchor1.x=Y.groundAnchorA.x-this.m_ground.m_xf.position.x;this.m_groundAnchor1.y=Y.groundAnchorA.y-this.m_ground.m_xf.position.y;this.m_groundAnchor2.x=Y.groundAnchorB.x-this.m_ground.m_xf.position.x;this.m_groundAnchor2.y=Y.groundAnchorB.y-this.m_ground.m_xf.position.y;this.m_localAnchor1.SetV(Y.localAnchorA);this.m_localAnchor2.SetV(Y.localAnchorB);this.m_ratio=Y.ratio;this.m_constant=Y.lengthA+this.m_ratio*Y.lengthB;this.m_maxLength1=t.Min(Y.maxLengthA,this.m_constant-this.m_ratio*f.b2_minPulleyLength);this.m_maxLength2=t.Min(Y.maxLengthB,(this.m_constant-f.b2_minPulleyLength)/this.m_ratio);this.m_impulse=0;this.m_limitImpulse1=0;this.m_limitImpulse2=0};f.prototype.InitVelocityConstraints=function(ac){var aw=this.m_bodyA;var av=this.m_bodyB;var ag;ag=aw.m_xf.R;var at=this.m_localAnchor1.x-aw.m_sweep.localCenter.x;var ar=this.m_localAnchor1.y-aw.m_sweep.localCenter.y;var am=(ag.col1.x*at+ag.col2.x*ar);ar=(ag.col1.y*at+ag.col2.y*ar);at=am;ag=av.m_xf.R;var ab=this.m_localAnchor2.x-av.m_sweep.localCenter.x;var aa=this.m_localAnchor2.y-av.m_sweep.localCenter.y;am=(ag.col1.x*ab+ag.col2.x*aa);aa=(ag.col1.y*ab+ag.col2.y*aa);ab=am;var aq=aw.m_sweep.c.x+at;var ao=aw.m_sweep.c.y+ar;var Z=av.m_sweep.c.x+ab;var Y=av.m_sweep.c.y+aa;var ah=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x;var af=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y;var ap=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x;var an=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;this.m_u1.Set(aq-ah,ao-af);this.m_u2.Set(Z-ap,Y-an);var al=this.m_u1.Length();var ak=this.m_u2.Length();if(al>c.b2_linearSlop){this.m_u1.Multiply(1/al)}else{this.m_u1.SetZero()}if(ak>c.b2_linearSlop){this.m_u2.Multiply(1/ak)}else{this.m_u2.SetZero()}var aj=this.m_constant-al-this.m_ratio*ak;if(aj>0){this.m_state=j.e_inactiveLimit;this.m_impulse=0}else{this.m_state=j.e_atUpperLimit}if(al<this.m_maxLength1){this.m_limitState1=j.e_inactiveLimit;this.m_limitImpulse1=0}else{this.m_limitState1=j.e_atUpperLimit}if(ak<this.m_maxLength2){this.m_limitState2=j.e_inactiveLimit;this.m_limitImpulse2=0}else{this.m_limitState2=j.e_atUpperLimit}var au=at*this.m_u1.y-ar*this.m_u1.x;var ai=ab*this.m_u2.y-aa*this.m_u2.x;this.m_limitMass1=aw.m_invMass+aw.m_invI*au*au;this.m_limitMass2=av.m_invMass+av.m_invI*ai*ai;this.m_pulleyMass=this.m_limitMass1+this.m_ratio*this.m_ratio*this.m_limitMass2;this.m_limitMass1=1/this.m_limitMass1;this.m_limitMass2=1/this.m_limitMass2;this.m_pulleyMass=1/this.m_pulleyMass;if(ac.warmStarting){this.m_impulse*=ac.dtRatio;this.m_limitImpulse1*=ac.dtRatio;this.m_limitImpulse2*=ac.dtRatio;var X=((-this.m_impulse)-this.m_limitImpulse1)*this.m_u1.x;var W=((-this.m_impulse)-this.m_limitImpulse1)*this.m_u1.y;var ae=((-this.m_ratio*this.m_impulse)-this.m_limitImpulse2)*this.m_u2.x;var ad=((-this.m_ratio*this.m_impulse)-this.m_limitImpulse2)*this.m_u2.y;aw.m_linearVelocity.x+=aw.m_invMass*X;aw.m_linearVelocity.y+=aw.m_invMass*W;aw.m_angularVelocity+=aw.m_invI*(at*W-ar*X);av.m_linearVelocity.x+=av.m_invMass*ae;av.m_linearVelocity.y+=av.m_invMass*ad;av.m_angularVelocity+=av.m_invI*(ab*ad-aa*ae)}else{this.m_impulse=0;this.m_limitImpulse1=0;this.m_limitImpulse2=0}};f.prototype.SolveVelocityConstraints=function(ad){var ap=this.m_bodyA;var ao=this.m_bodyB;var ai;ai=ap.m_xf.R;var an=this.m_localAnchor1.x-ap.m_sweep.localCenter.x;var am=this.m_localAnchor1.y-ap.m_sweep.localCenter.y;var al=(ai.col1.x*an+ai.col2.x*am);am=(ai.col1.y*an+ai.col2.y*am);an=al;ai=ao.m_xf.R;var ab=this.m_localAnchor2.x-ao.m_sweep.localCenter.x;var aa=this.m_localAnchor2.y-ao.m_sweep.localCenter.y;al=(ai.col1.x*ab+ai.col2.x*aa);aa=(ai.col1.y*ab+ai.col2.y*aa);ab=al;var Z=0;var X=0;var aj=0;var ag=0;var Y=0;var W=0;var ah=0;var af=0;var ak=0;var ae=0;var ac=0;if(this.m_state==j.e_atUpperLimit){Z=ap.m_linearVelocity.x+((-ap.m_angularVelocity*am));X=ap.m_linearVelocity.y+(ap.m_angularVelocity*an);aj=ao.m_linearVelocity.x+((-ao.m_angularVelocity*aa));ag=ao.m_linearVelocity.y+(ao.m_angularVelocity*ab);ak=(-(this.m_u1.x*Z+this.m_u1.y*X))-this.m_ratio*(this.m_u2.x*aj+this.m_u2.y*ag);ae=this.m_pulleyMass*((-ak));ac=this.m_impulse;this.m_impulse=t.Max(0,this.m_impulse+ae);ae=this.m_impulse-ac;Y=(-ae*this.m_u1.x);W=(-ae*this.m_u1.y);ah=(-this.m_ratio*ae*this.m_u2.x);af=(-this.m_ratio*ae*this.m_u2.y);ap.m_linearVelocity.x+=ap.m_invMass*Y;ap.m_linearVelocity.y+=ap.m_invMass*W;ap.m_angularVelocity+=ap.m_invI*(an*W-am*Y);ao.m_linearVelocity.x+=ao.m_invMass*ah;ao.m_linearVelocity.y+=ao.m_invMass*af;ao.m_angularVelocity+=ao.m_invI*(ab*af-aa*ah)}if(this.m_limitState1==j.e_atUpperLimit){Z=ap.m_linearVelocity.x+((-ap.m_angularVelocity*am));X=ap.m_linearVelocity.y+(ap.m_angularVelocity*an);ak=(-(this.m_u1.x*Z+this.m_u1.y*X));ae=(-this.m_limitMass1*ak);ac=this.m_limitImpulse1;this.m_limitImpulse1=t.Max(0,this.m_limitImpulse1+ae);ae=this.m_limitImpulse1-ac;Y=(-ae*this.m_u1.x);W=(-ae*this.m_u1.y);ap.m_linearVelocity.x+=ap.m_invMass*Y;ap.m_linearVelocity.y+=ap.m_invMass*W;ap.m_angularVelocity+=ap.m_invI*(an*W-am*Y)}if(this.m_limitState2==j.e_atUpperLimit){aj=ao.m_linearVelocity.x+((-ao.m_angularVelocity*aa));ag=ao.m_linearVelocity.y+(ao.m_angularVelocity*ab);ak=(-(this.m_u2.x*aj+this.m_u2.y*ag));ae=(-this.m_limitMass2*ak);ac=this.m_limitImpulse2;this.m_limitImpulse2=t.Max(0,this.m_limitImpulse2+ae);ae=this.m_limitImpulse2-ac;ah=(-ae*this.m_u2.x);af=(-ae*this.m_u2.y);ao.m_linearVelocity.x+=ao.m_invMass*ah;ao.m_linearVelocity.y+=ao.m_invMass*af;ao.m_angularVelocity+=ao.m_invI*(ab*af-aa*ah)}};f.prototype.SolvePositionConstraints=function(am){if(am===undefined){am=0}var au=this.m_bodyA;var at=this.m_bodyB;var ae;var af=this.m_ground.m_xf.position.x+this.m_groundAnchor1.x;var ad=this.m_ground.m_xf.position.y+this.m_groundAnchor1.y;var an=this.m_ground.m_xf.position.x+this.m_groundAnchor2.x;var ak=this.m_ground.m_xf.position.y+this.m_groundAnchor2.y;var ar=0;var aq=0;var Z=0;var Y=0;var ao=0;var al=0;var X=0;var W=0;var ai=0;var ah=0;var ag=0;var ac=0;var ab=0;var ap=0;var aj=0;var aa=0;if(this.m_state==j.e_atUpperLimit){ae=au.m_xf.R;ar=this.m_localAnchor1.x-au.m_sweep.localCenter.x;aq=this.m_localAnchor1.y-au.m_sweep.localCenter.y;aj=(ae.col1.x*ar+ae.col2.x*aq);aq=(ae.col1.y*ar+ae.col2.y*aq);ar=aj;ae=at.m_xf.R;Z=this.m_localAnchor2.x-at.m_sweep.localCenter.x;Y=this.m_localAnchor2.y-at.m_sweep.localCenter.y;aj=(ae.col1.x*Z+ae.col2.x*Y);Y=(ae.col1.y*Z+ae.col2.y*Y);Z=aj;ao=au.m_sweep.c.x+ar;al=au.m_sweep.c.y+aq;X=at.m_sweep.c.x+Z;W=at.m_sweep.c.y+Y;this.m_u1.Set(ao-af,al-ad);this.m_u2.Set(X-an,W-ak);ai=this.m_u1.Length();ah=this.m_u2.Length();if(ai>c.b2_linearSlop){this.m_u1.Multiply(1/ai)}else{this.m_u1.SetZero()}if(ah>c.b2_linearSlop){this.m_u2.Multiply(1/ah)}else{this.m_u2.SetZero()}ag=this.m_constant-ai-this.m_ratio*ah;aa=t.Max(aa,(-ag));ag=t.Clamp(ag+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);ac=(-this.m_pulleyMass*ag);ao=(-ac*this.m_u1.x);al=(-ac*this.m_u1.y);X=(-this.m_ratio*ac*this.m_u2.x);W=(-this.m_ratio*ac*this.m_u2.y);au.m_sweep.c.x+=au.m_invMass*ao;au.m_sweep.c.y+=au.m_invMass*al;au.m_sweep.a+=au.m_invI*(ar*al-aq*ao);at.m_sweep.c.x+=at.m_invMass*X;at.m_sweep.c.y+=at.m_invMass*W;at.m_sweep.a+=at.m_invI*(Z*W-Y*X);au.SynchronizeTransform();at.SynchronizeTransform()}if(this.m_limitState1==j.e_atUpperLimit){ae=au.m_xf.R;ar=this.m_localAnchor1.x-au.m_sweep.localCenter.x;aq=this.m_localAnchor1.y-au.m_sweep.localCenter.y;aj=(ae.col1.x*ar+ae.col2.x*aq);aq=(ae.col1.y*ar+ae.col2.y*aq);ar=aj;ao=au.m_sweep.c.x+ar;al=au.m_sweep.c.y+aq;this.m_u1.Set(ao-af,al-ad);ai=this.m_u1.Length();if(ai>c.b2_linearSlop){this.m_u1.x*=1/ai;this.m_u1.y*=1/ai}else{this.m_u1.SetZero()}ag=this.m_maxLength1-ai;aa=t.Max(aa,(-ag));ag=t.Clamp(ag+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);ac=(-this.m_limitMass1*ag);ao=(-ac*this.m_u1.x);al=(-ac*this.m_u1.y);au.m_sweep.c.x+=au.m_invMass*ao;au.m_sweep.c.y+=au.m_invMass*al;au.m_sweep.a+=au.m_invI*(ar*al-aq*ao);au.SynchronizeTransform()}if(this.m_limitState2==j.e_atUpperLimit){ae=at.m_xf.R;Z=this.m_localAnchor2.x-at.m_sweep.localCenter.x;Y=this.m_localAnchor2.y-at.m_sweep.localCenter.y;aj=(ae.col1.x*Z+ae.col2.x*Y);Y=(ae.col1.y*Z+ae.col2.y*Y);Z=aj;X=at.m_sweep.c.x+Z;W=at.m_sweep.c.y+Y;this.m_u2.Set(X-an,W-ak);ah=this.m_u2.Length();if(ah>c.b2_linearSlop){this.m_u2.x*=1/ah;this.m_u2.y*=1/ah}else{this.m_u2.SetZero()}ag=this.m_maxLength2-ah;aa=t.Max(aa,(-ag));ag=t.Clamp(ag+c.b2_linearSlop,(-c.b2_maxLinearCorrection),0);ac=(-this.m_limitMass2*ag);X=(-ac*this.m_u2.x);W=(-ac*this.m_u2.y);at.m_sweep.c.x+=at.m_invMass*X;at.m_sweep.c.y+=at.m_invMass*W;at.m_sweep.a+=at.m_invI*(Z*W-Y*X);at.SynchronizeTransform()}return aa<c.b2_linearSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2PulleyJoint.b2_minPulleyLength=2});Box2D.inherit(T,Box2D.Dynamics.Joints.b2JointDef);T.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;T.b2PulleyJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.groundAnchorA=new P();this.groundAnchorB=new P();this.localAnchorA=new P();this.localAnchorB=new P()};T.prototype.b2PulleyJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_pulleyJoint;this.groundAnchorA.Set((-1),1);this.groundAnchorB.Set(1,1);this.localAnchorA.Set((-1),0);this.localAnchorB.Set(1,0);this.lengthA=0;this.maxLengthA=0;this.lengthB=0;this.maxLengthB=0;this.ratio=1;this.collideConnected=true};T.prototype.Initialize=function(Z,W,ag,ae,ab,aa,X){if(X===undefined){X=0}this.bodyA=Z;this.bodyB=W;this.groundAnchorA.SetV(ag);this.groundAnchorB.SetV(ae);this.localAnchorA=this.bodyA.GetLocalPoint(ab);this.localAnchorB=this.bodyB.GetLocalPoint(aa);var ah=ab.x-ag.x;var af=ab.y-ag.y;this.lengthA=Math.sqrt(ah*ah+af*af);var ad=aa.x-ae.x;var ac=aa.y-ae.y;this.lengthB=Math.sqrt(ad*ad+ac*ac);this.ratio=X;var Y=this.lengthA+this.ratio*this.lengthB;this.maxLengthA=Y-this.ratio*f.b2_minPulleyLength;this.maxLengthB=(Y-f.b2_minPulleyLength)/this.ratio};Box2D.inherit(F,Box2D.Dynamics.Joints.b2Joint);F.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;F.b2RevoluteJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.K=new H();this.K1=new H();this.K2=new H();this.K3=new H();this.impulse3=new O();this.impulse2=new P();this.reduced=new P();this.m_localAnchor1=new P();this.m_localAnchor2=new P();this.m_impulse=new O();this.m_mass=new m()};F.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchor1)};F.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchor2)};F.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*this.m_impulse.x,W*this.m_impulse.y)};F.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return W*this.m_impulse.z};F.prototype.GetJointAngle=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle};F.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity};F.prototype.IsLimitEnabled=function(){return this.m_enableLimit};F.prototype.EnableLimit=function(W){this.m_enableLimit=W};F.prototype.GetLowerLimit=function(){return this.m_lowerAngle};F.prototype.GetUpperLimit=function(){return this.m_upperAngle};F.prototype.SetLimits=function(W,X){if(W===undefined){W=0}if(X===undefined){X=0}this.m_lowerAngle=W;this.m_upperAngle=X};F.prototype.IsMotorEnabled=function(){this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);return this.m_enableMotor};F.prototype.EnableMotor=function(W){this.m_enableMotor=W};F.prototype.SetMotorSpeed=function(W){if(W===undefined){W=0}this.m_bodyA.SetAwake(true);this.m_bodyB.SetAwake(true);this.m_motorSpeed=W};F.prototype.GetMotorSpeed=function(){return this.m_motorSpeed};F.prototype.SetMaxMotorTorque=function(W){if(W===undefined){W=0}this.m_maxMotorTorque=W};F.prototype.GetMotorTorque=function(){return this.m_maxMotorTorque};F.prototype.b2RevoluteJoint=function(W){this.__super.b2Joint.call(this,W);this.m_localAnchor1.SetV(W.localAnchorA);this.m_localAnchor2.SetV(W.localAnchorB);this.m_referenceAngle=W.referenceAngle;this.m_impulse.SetZero();this.m_motorImpulse=0;this.m_lowerAngle=W.lowerAngle;this.m_upperAngle=W.upperAngle;this.m_maxMotorTorque=W.maxMotorTorque;this.m_motorSpeed=W.motorSpeed;this.m_enableLimit=W.enableLimit;this.m_enableMotor=W.enableMotor;this.m_limitState=j.e_inactiveLimit};F.prototype.InitVelocityConstraints=function(Z){var X=this.m_bodyA;var W=this.m_bodyB;var ag;var ah=0;if(this.m_enableMotor||this.m_enableLimit){}ag=X.m_xf.R;var ak=this.m_localAnchor1.x-X.m_sweep.localCenter.x;var ai=this.m_localAnchor1.y-X.m_sweep.localCenter.y;ah=(ag.col1.x*ak+ag.col2.x*ai);ai=(ag.col1.y*ak+ag.col2.y*ai);ak=ah;ag=W.m_xf.R;var af=this.m_localAnchor2.x-W.m_sweep.localCenter.x;var ae=this.m_localAnchor2.y-W.m_sweep.localCenter.y;ah=(ag.col1.x*af+ag.col2.x*ae);ae=(ag.col1.y*af+ag.col2.y*ae);af=ah;var al=X.m_invMass;var aj=W.m_invMass;var ad=X.m_invI;var ab=W.m_invI;this.m_mass.col1.x=al+aj+ai*ai*ad+ae*ae*ab;this.m_mass.col2.x=(-ai*ak*ad)-ae*af*ab;this.m_mass.col3.x=(-ai*ad)-ae*ab;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=al+aj+ak*ak*ad+af*af*ab;this.m_mass.col3.y=ak*ad+af*ab;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=ad+ab;this.m_motorMass=1/(ad+ab);if(this.m_enableMotor==false){this.m_motorImpulse=0}if(this.m_enableLimit){var Y=W.m_sweep.a-X.m_sweep.a-this.m_referenceAngle;if(t.Abs(this.m_upperAngle-this.m_lowerAngle)<2*c.b2_angularSlop){this.m_limitState=j.e_equalLimits}else{if(Y<=this.m_lowerAngle){if(this.m_limitState!=j.e_atLowerLimit){this.m_impulse.z=0}this.m_limitState=j.e_atLowerLimit}else{if(Y>=this.m_upperAngle){if(this.m_limitState!=j.e_atUpperLimit){this.m_impulse.z=0}this.m_limitState=j.e_atUpperLimit}else{this.m_limitState=j.e_inactiveLimit;this.m_impulse.z=0}}}}else{this.m_limitState=j.e_inactiveLimit}if(Z.warmStarting){this.m_impulse.x*=Z.dtRatio;this.m_impulse.y*=Z.dtRatio;this.m_motorImpulse*=Z.dtRatio;var ac=this.m_impulse.x;var aa=this.m_impulse.y;X.m_linearVelocity.x-=al*ac;X.m_linearVelocity.y-=al*aa;X.m_angularVelocity-=ad*((ak*aa-ai*ac)+this.m_motorImpulse+this.m_impulse.z);W.m_linearVelocity.x+=aj*ac;W.m_linearVelocity.y+=aj*aa;W.m_angularVelocity+=ab*((af*aa-ae*ac)+this.m_motorImpulse+this.m_impulse.z)}else{this.m_impulse.SetZero();this.m_motorImpulse=0}};F.prototype.SolveVelocityConstraints=function(ag){var ax=this.m_bodyA;var aw=this.m_bodyB;var ai;var an=0;var av=0;var au=0;var at=0;var ac=0;var ab=0;var aa=ax.m_linearVelocity;var ak=ax.m_angularVelocity;var Z=aw.m_linearVelocity;var aj=aw.m_angularVelocity;var Y=ax.m_invMass;var W=aw.m_invMass;var ap=ax.m_invI;var ao=aw.m_invI;if(this.m_enableMotor&&this.m_limitState!=j.e_equalLimits){var am=aj-ak-this.m_motorSpeed;var ah=this.m_motorMass*((-am));var ae=this.m_motorImpulse;var al=ag.dt*this.m_maxMotorTorque;this.m_motorImpulse=t.Clamp(this.m_motorImpulse+ah,(-al),al);ah=this.m_motorImpulse-ae;ak-=ap*ah;aj+=ao*ah}if(this.m_enableLimit&&this.m_limitState!=j.e_inactiveLimit){ai=ax.m_xf.R;au=this.m_localAnchor1.x-ax.m_sweep.localCenter.x;at=this.m_localAnchor1.y-ax.m_sweep.localCenter.y;an=(ai.col1.x*au+ai.col2.x*at);at=(ai.col1.y*au+ai.col2.y*at);au=an;ai=aw.m_xf.R;ac=this.m_localAnchor2.x-aw.m_sweep.localCenter.x;ab=this.m_localAnchor2.y-aw.m_sweep.localCenter.y;an=(ai.col1.x*ac+ai.col2.x*ab);ab=(ai.col1.y*ac+ai.col2.y*ab);ac=an;var ar=Z.x+((-aj*ab))-aa.x-((-ak*at));var aq=Z.y+(aj*ac)-aa.y-(ak*au);var X=aj-ak;this.m_mass.Solve33(this.impulse3,(-ar),(-aq),(-X));if(this.m_limitState==j.e_equalLimits){this.m_impulse.Add(this.impulse3)}else{if(this.m_limitState==j.e_atLowerLimit){av=this.m_impulse.z+this.impulse3.z;if(av<0){this.m_mass.Solve22(this.reduced,(-ar),(-aq));this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=(-this.m_impulse.z);this.m_impulse.x+=this.reduced.x;this.m_impulse.y+=this.reduced.y;this.m_impulse.z=0}}else{if(this.m_limitState==j.e_atUpperLimit){av=this.m_impulse.z+this.impulse3.z;if(av>0){this.m_mass.Solve22(this.reduced,(-ar),(-aq));this.impulse3.x=this.reduced.x;this.impulse3.y=this.reduced.y;this.impulse3.z=(-this.m_impulse.z);this.m_impulse.x+=this.reduced.x;this.m_impulse.y+=this.reduced.y;this.m_impulse.z=0}}}}aa.x-=Y*this.impulse3.x;aa.y-=Y*this.impulse3.y;ak-=ap*(au*this.impulse3.y-at*this.impulse3.x+this.impulse3.z);Z.x+=W*this.impulse3.x;Z.y+=W*this.impulse3.y;aj+=ao*(ac*this.impulse3.y-ab*this.impulse3.x+this.impulse3.z)}else{ai=ax.m_xf.R;au=this.m_localAnchor1.x-ax.m_sweep.localCenter.x;at=this.m_localAnchor1.y-ax.m_sweep.localCenter.y;an=(ai.col1.x*au+ai.col2.x*at);at=(ai.col1.y*au+ai.col2.y*at);au=an;ai=aw.m_xf.R;ac=this.m_localAnchor2.x-aw.m_sweep.localCenter.x;ab=this.m_localAnchor2.y-aw.m_sweep.localCenter.y;an=(ai.col1.x*ac+ai.col2.x*ab);ab=(ai.col1.y*ac+ai.col2.y*ab);ac=an;var af=Z.x+((-aj*ab))-aa.x-((-ak*at));var ad=Z.y+(aj*ac)-aa.y-(ak*au);this.m_mass.Solve22(this.impulse2,(-af),(-ad));this.m_impulse.x+=this.impulse2.x;this.m_impulse.y+=this.impulse2.y;aa.x-=Y*this.impulse2.x;aa.y-=Y*this.impulse2.y;ak-=ap*(au*this.impulse2.y-at*this.impulse2.x);Z.x+=W*this.impulse2.x;Z.y+=W*this.impulse2.y;aj+=ao*(ac*this.impulse2.y-ab*this.impulse2.x)}ax.m_linearVelocity.SetV(aa);ax.m_angularVelocity=ak;aw.m_linearVelocity.SetV(Z);aw.m_angularVelocity=aj};F.prototype.SolvePositionConstraints=function(aq){if(aq===undefined){aq=0}var ap=0;var aj=0;var af;var aB=this.m_bodyA;var aA=this.m_bodyB;var au=0;var ag=0;var al=0;var X=0;var W=0;if(this.m_enableLimit&&this.m_limitState!=j.e_inactiveLimit){var ar=aA.m_sweep.a-aB.m_sweep.a-this.m_referenceAngle;var am=0;if(this.m_limitState==j.e_equalLimits){aj=t.Clamp(ar-this.m_lowerAngle,(-c.b2_maxAngularCorrection),c.b2_maxAngularCorrection);am=(-this.m_motorMass*aj);au=t.Abs(aj)}else{if(this.m_limitState==j.e_atLowerLimit){aj=ar-this.m_lowerAngle;au=(-aj);aj=t.Clamp(aj+c.b2_angularSlop,(-c.b2_maxAngularCorrection),0);am=(-this.m_motorMass*aj)}else{if(this.m_limitState==j.e_atUpperLimit){aj=ar-this.m_upperAngle;au=aj;aj=t.Clamp(aj-c.b2_angularSlop,0,c.b2_maxAngularCorrection);am=(-this.m_motorMass*aj)}}}aB.m_sweep.a-=aB.m_invI*am;aA.m_sweep.a+=aA.m_invI*am;aB.SynchronizeTransform();aA.SynchronizeTransform()}af=aB.m_xf.R;var av=this.m_localAnchor1.x-aB.m_sweep.localCenter.x;var at=this.m_localAnchor1.y-aB.m_sweep.localCenter.y;al=(af.col1.x*av+af.col2.x*at);at=(af.col1.y*av+af.col2.y*at);av=al;af=aA.m_xf.R;var aa=this.m_localAnchor2.x-aA.m_sweep.localCenter.x;var Z=this.m_localAnchor2.y-aA.m_sweep.localCenter.y;al=(af.col1.x*aa+af.col2.x*Z);Z=(af.col1.y*aa+af.col2.y*Z);aa=al;var ay=aA.m_sweep.c.x+aa-aB.m_sweep.c.x-av;var aw=aA.m_sweep.c.y+Z-aB.m_sweep.c.y-at;var ae=ay*ay+aw*aw;var ad=Math.sqrt(ae);ag=ad;var ai=aB.m_invMass;var ah=aA.m_invMass;var ac=aB.m_invI;var ab=aA.m_invI;var Y=10*c.b2_linearSlop;if(ae>Y*Y){var az=ay/ad;var ax=aw/ad;var ao=ai+ah;var an=1/ao;X=an*((-ay));W=an*((-aw));var ak=0.5;aB.m_sweep.c.x-=ak*ai*X;aB.m_sweep.c.y-=ak*ai*W;aA.m_sweep.c.x+=ak*ah*X;aA.m_sweep.c.y+=ak*ah*W;ay=aA.m_sweep.c.x+aa-aB.m_sweep.c.x-av;aw=aA.m_sweep.c.y+Z-aB.m_sweep.c.y-at}this.K1.col1.x=ai+ah;this.K1.col2.x=0;this.K1.col1.y=0;this.K1.col2.y=ai+ah;this.K2.col1.x=ac*at*at;this.K2.col2.x=(-ac*av*at);this.K2.col1.y=(-ac*av*at);this.K2.col2.y=ac*av*av;this.K3.col1.x=ab*Z*Z;this.K3.col2.x=(-ab*aa*Z);this.K3.col1.y=(-ab*aa*Z);this.K3.col2.y=ab*aa*aa;this.K.SetM(this.K1);this.K.AddM(this.K2);this.K.AddM(this.K3);this.K.Solve(F.tImpulse,(-ay),(-aw));X=F.tImpulse.x;W=F.tImpulse.y;aB.m_sweep.c.x-=aB.m_invMass*X;aB.m_sweep.c.y-=aB.m_invMass*W;aB.m_sweep.a-=aB.m_invI*(av*W-at*X);aA.m_sweep.c.x+=aA.m_invMass*X;aA.m_sweep.c.y+=aA.m_invMass*W;aA.m_sweep.a+=aA.m_invI*(aa*W-Z*X);aB.SynchronizeTransform();aA.SynchronizeTransform();return ag<=c.b2_linearSlop&&au<=c.b2_angularSlop};Box2D.postDefs.push(function(){Box2D.Dynamics.Joints.b2RevoluteJoint.tImpulse=new P()});Box2D.inherit(a,Box2D.Dynamics.Joints.b2JointDef);a.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;a.b2RevoluteJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P()};a.prototype.b2RevoluteJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_revoluteJoint;this.localAnchorA.Set(0,0);this.localAnchorB.Set(0,0);this.referenceAngle=0;this.lowerAngle=0;this.upperAngle=0;this.maxMotorTorque=0;this.motorSpeed=0;this.enableLimit=false;this.enableMotor=false};a.prototype.Initialize=function(Y,X,W){this.bodyA=Y;this.bodyB=X;this.localAnchorA=this.bodyA.GetLocalPoint(W);this.localAnchorB=this.bodyB.GetLocalPoint(W);this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()};Box2D.inherit(e,Box2D.Dynamics.Joints.b2Joint);e.prototype.__super=Box2D.Dynamics.Joints.b2Joint.prototype;e.b2WeldJoint=function(){Box2D.Dynamics.Joints.b2Joint.b2Joint.apply(this,arguments);this.m_localAnchorA=new P();this.m_localAnchorB=new P();this.m_impulse=new O();this.m_mass=new m()};e.prototype.GetAnchorA=function(){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA)};e.prototype.GetAnchorB=function(){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB)};e.prototype.GetReactionForce=function(W){if(W===undefined){W=0}return new P(W*this.m_impulse.x,W*this.m_impulse.y)};e.prototype.GetReactionTorque=function(W){if(W===undefined){W=0}return W*this.m_impulse.z};e.prototype.b2WeldJoint=function(W){this.__super.b2Joint.call(this,W);this.m_localAnchorA.SetV(W.localAnchorA);this.m_localAnchorB.SetV(W.localAnchorB);this.m_referenceAngle=W.referenceAngle;this.m_impulse.SetZero();this.m_mass=new m()};e.prototype.InitVelocityConstraints=function(Z){var af;var ag=0;var X=this.m_bodyA;var W=this.m_bodyB;af=X.m_xf.R;var ac=this.m_localAnchorA.x-X.m_sweep.localCenter.x;var ab=this.m_localAnchorA.y-X.m_sweep.localCenter.y;ag=(af.col1.x*ac+af.col2.x*ab);ab=(af.col1.y*ac+af.col2.y*ab);ac=ag;af=W.m_xf.R;var ai=this.m_localAnchorB.x-W.m_sweep.localCenter.x;var ah=this.m_localAnchorB.y-W.m_sweep.localCenter.y;ag=(af.col1.x*ai+af.col2.x*ah);ah=(af.col1.y*ai+af.col2.y*ah);ai=ag;var aa=X.m_invMass;var Y=W.m_invMass;var ae=X.m_invI;var ad=W.m_invI;this.m_mass.col1.x=aa+Y+ab*ab*ae+ah*ah*ad;this.m_mass.col2.x=(-ab*ac*ae)-ah*ai*ad;this.m_mass.col3.x=(-ab*ae)-ah*ad;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=aa+Y+ac*ac*ae+ai*ai*ad;this.m_mass.col3.y=ac*ae+ai*ad;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=ae+ad;if(Z.warmStarting){this.m_impulse.x*=Z.dtRatio;this.m_impulse.y*=Z.dtRatio;this.m_impulse.z*=Z.dtRatio;X.m_linearVelocity.x-=aa*this.m_impulse.x;X.m_linearVelocity.y-=aa*this.m_impulse.y;X.m_angularVelocity-=ae*(ac*this.m_impulse.y-ab*this.m_impulse.x+this.m_impulse.z);W.m_linearVelocity.x+=Y*this.m_impulse.x;W.m_linearVelocity.y+=Y*this.m_impulse.y;W.m_angularVelocity+=ad*(ai*this.m_impulse.y-ah*this.m_impulse.x+this.m_impulse.z)}else{this.m_impulse.SetZero()}};e.prototype.SolveVelocityConstraints=function(aa){var af;var ag=0;var aq=this.m_bodyA;var ap=this.m_bodyB;var ao=aq.m_linearVelocity;var Y=aq.m_angularVelocity;var an=ap.m_linearVelocity;var X=ap.m_angularVelocity;var ak=aq.m_invMass;var aj=ap.m_invMass;var ad=aq.m_invI;var ac=ap.m_invI;af=aq.m_xf.R;var ab=this.m_localAnchorA.x-aq.m_sweep.localCenter.x;var Z=this.m_localAnchorA.y-aq.m_sweep.localCenter.y;ag=(af.col1.x*ab+af.col2.x*Z);Z=(af.col1.y*ab+af.col2.y*Z);ab=ag;af=ap.m_xf.R;var ai=this.m_localAnchorB.x-ap.m_sweep.localCenter.x;var ah=this.m_localAnchorB.y-ap.m_sweep.localCenter.y;ag=(af.col1.x*ai+af.col2.x*ah);ah=(af.col1.y*ai+af.col2.y*ah);ai=ag;var am=an.x-X*ah-ao.x+Y*Z;var al=an.y+X*ai-ao.y-Y*ab;var W=X-Y;var ae=new O();this.m_mass.Solve33(ae,(-am),(-al),(-W));this.m_impulse.Add(ae);ao.x-=ak*ae.x;ao.y-=ak*ae.y;Y-=ad*(ab*ae.y-Z*ae.x+ae.z);an.x+=aj*ae.x;an.y+=aj*ae.y;X+=ac*(ai*ae.y-ah*ae.x+ae.z);aq.m_angularVelocity=Y;ap.m_angularVelocity=X};e.prototype.SolvePositionConstraints=function(ak){if(ak===undefined){ak=0}var ad;var ae=0;var ap=this.m_bodyA;var ao=this.m_bodyB;ad=ap.m_xf.R;var Y=this.m_localAnchorA.x-ap.m_sweep.localCenter.x;var X=this.m_localAnchorA.y-ap.m_sweep.localCenter.y;ae=(ad.col1.x*Y+ad.col2.x*X);X=(ad.col1.y*Y+ad.col2.y*X);Y=ae;ad=ao.m_xf.R;var ag=this.m_localAnchorB.x-ao.m_sweep.localCenter.x;var af=this.m_localAnchorB.y-ao.m_sweep.localCenter.y;ae=(ad.col1.x*ag+ad.col2.x*af);af=(ad.col1.y*ag+ad.col2.y*af);ag=ae;var ai=ap.m_invMass;var ah=ao.m_invMass;var aa=ap.m_invI;var Z=ao.m_invI;var an=ao.m_sweep.c.x+ag-ap.m_sweep.c.x-Y;var am=ao.m_sweep.c.y+af-ap.m_sweep.c.y-X;var aj=ao.m_sweep.a-ap.m_sweep.a-this.m_referenceAngle;var W=10*c.b2_linearSlop;var ac=Math.sqrt(an*an+am*am);var al=t.Abs(aj);if(ac>W){aa*=1;Z*=1}this.m_mass.col1.x=ai+ah+X*X*aa+af*af*Z;this.m_mass.col2.x=(-X*Y*aa)-af*ag*Z;this.m_mass.col3.x=(-X*aa)-af*Z;this.m_mass.col1.y=this.m_mass.col2.x;this.m_mass.col2.y=ai+ah+Y*Y*aa+ag*ag*Z;this.m_mass.col3.y=Y*aa+ag*Z;this.m_mass.col1.z=this.m_mass.col3.x;this.m_mass.col2.z=this.m_mass.col3.y;this.m_mass.col3.z=aa+Z;var ab=new O();this.m_mass.Solve33(ab,(-an),(-am),(-aj));ap.m_sweep.c.x-=ai*ab.x;ap.m_sweep.c.y-=ai*ab.y;ap.m_sweep.a-=aa*(Y*ab.y-X*ab.x+ab.z);ao.m_sweep.c.x+=ah*ab.x;ao.m_sweep.c.y+=ah*ab.y;ao.m_sweep.a+=Z*(ag*ab.y-af*ab.x+ab.z);ap.SynchronizeTransform();ao.SynchronizeTransform();return ac<=c.b2_linearSlop&&al<=c.b2_angularSlop};Box2D.inherit(z,Box2D.Dynamics.Joints.b2JointDef);z.prototype.__super=Box2D.Dynamics.Joints.b2JointDef.prototype;z.b2WeldJointDef=function(){Box2D.Dynamics.Joints.b2JointDef.b2JointDef.apply(this,arguments);this.localAnchorA=new P();this.localAnchorB=new P()};z.prototype.b2WeldJointDef=function(){this.__super.b2JointDef.call(this);this.type=j.e_weldJoint;this.referenceAngle=0};z.prototype.Initialize=function(Y,X,W){this.bodyA=Y;this.bodyB=X;this.localAnchorA.SetV(this.bodyA.GetLocalPoint(W));this.localAnchorB.SetV(this.bodyB.GetLocalPoint(W));this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}})();(function(){var a=Box2D.Dynamics.b2DebugDraw;a.b2DebugDraw=function(){this.m_drawScale=1;this.m_lineThickness=1;this.m_alpha=1;this.m_fillAlpha=1;this.m_xformScale=1;var b=this;this.m_sprite={graphics:{clear:function(){b.m_ctx.clearRect(0,0,b.m_ctx.canvas.width,b.m_ctx.canvas.height)}}}};a.prototype._color=function(b,c){return"rgba("+((b&16711680)>>16)+","+((b&65280)>>8)+","+(b&255)+","+c+")"};a.prototype.b2DebugDraw=function(){this.m_drawFlags=0};a.prototype.SetFlags=function(b){if(b===undefined){b=0}this.m_drawFlags=b};a.prototype.GetFlags=function(){return this.m_drawFlags};a.prototype.AppendFlags=function(b){if(b===undefined){b=0}this.m_drawFlags|=b};a.prototype.ClearFlags=function(b){if(b===undefined){b=0}this.m_drawFlags&=~b};a.prototype.SetSprite=function(b){this.m_ctx=b};a.prototype.GetSprite=function(){return this.m_ctx};a.prototype.SetDrawScale=function(b){if(b===undefined){b=0}this.m_drawScale=b};a.prototype.GetDrawScale=function(){return this.m_drawScale};a.prototype.SetLineThickness=function(b){if(b===undefined){b=0}this.m_lineThickness=b;this.m_ctx.strokeWidth=b};a.prototype.GetLineThickness=function(){return this.m_lineThickness};a.prototype.SetAlpha=function(b){if(b===undefined){b=0}this.m_alpha=b};a.prototype.GetAlpha=function(){return this.m_alpha};a.prototype.SetFillAlpha=function(b){if(b===undefined){b=0}this.m_fillAlpha=b};a.prototype.GetFillAlpha=function(){return this.m_fillAlpha};a.prototype.SetXFormScale=function(b){if(b===undefined){b=0}this.m_xformScale=b};a.prototype.GetXFormScale=function(){return this.m_xformScale};a.prototype.DrawPolygon=function(c,f,b){if(!f){return}var e=this.m_ctx;var g=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(b.color,this.m_alpha);e.moveTo(c[0].x*g,c[0].y*g);for(var d=1;d<f;d++){e.lineTo(c[d].x*g,c[d].y*g)}e.lineTo(c[0].x*g,c[0].y*g);e.closePath();e.stroke()};a.prototype.DrawSolidPolygon=function(c,f,b){if(!f){return}var e=this.m_ctx;var g=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(b.color,this.m_alpha);e.fillStyle=this._color(b.color,this.m_fillAlpha);e.moveTo(c[0].x*g,c[0].y*g);for(var d=1;d<f;d++){e.lineTo(c[d].x*g,c[d].y*g)}e.lineTo(c[0].x*g,c[0].y*g);e.closePath();e.fill();e.stroke()};a.prototype.DrawCircle=function(c,b,d){if(!b){return}var e=this.m_ctx;var f=this.m_drawScale;e.beginPath();e.strokeStyle=this._color(d.color,this.m_alpha);e.arc(c.x*f,c.y*f,b*f,0,Math.PI*2,true);e.closePath();e.stroke()};a.prototype.DrawSolidCircle=function(d,c,g,e){if(!c){return}var f=this.m_ctx,h=this.m_drawScale,b=d.x*h,j=d.y*h;f.moveTo(0,0);f.beginPath();f.strokeStyle=this._color(e.color,this.m_alpha);f.fillStyle=this._color(e.color,this.m_fillAlpha);f.arc(b,j,c*h,0,Math.PI*2,true);f.moveTo(b,j);f.lineTo((d.x+g.x*c)*h,(d.y+g.y*c)*h);f.closePath();f.fill();f.stroke()};a.prototype.DrawSegment=function(f,e,b){var c=this.m_ctx,d=this.m_drawScale;c.strokeStyle=this._color(b.color,this.m_alpha);c.beginPath();c.moveTo(f.x*d,f.y*d);c.lineTo(e.x*d,e.y*d);c.closePath();c.stroke()};a.prototype.DrawTransform=function(c){var b=this.m_ctx,d=this.m_drawScale;b.beginPath();b.strokeStyle=this._color(16711680,this.m_alpha);b.moveTo(c.position.x*d,c.position.y*d);b.lineTo((c.position.x+this.m_xformScale*c.R.col1.x)*d,(c.position.y+this.m_xformScale*c.R.col1.y)*d);b.strokeStyle=this._color(65280,this.m_alpha);b.moveTo(c.position.x*d,c.position.y*d);b.lineTo((c.position.x+this.m_xformScale*c.R.col2.x)*d,(c.position.y+this.m_xformScale*c.R.col2.y)*d);b.closePath();b.stroke()}})();(function(){var a=Box2D.Dynamics.b2PaperDraw;a.b2PaperDraw=function(){this.m_drawScale=1;this.m_lineThickness=1;this.m_alpha=1;this.m_fillAlpha=1;this.m_xformScale=1;var b=this;this.m_sprite={graphics:{clear:function(){b.m_ctx.clearRect(0,0,b.m_ctx.canvas.width,b.m_ctx.canvas.height)}}}};a.prototype.b2PaperDraw=function(){this.m_drawFlags=0};a.prototype.SetFlags=function(b){if(b===undefined){b=0}this.m_drawFlags=b};a.prototype.GetFlags=function(){return this.m_drawFlags};a.prototype.AppendFlags=function(b){if(b===undefined){b=0}this.m_drawFlags|=b};a.prototype.ClearFlags=function(b){if(b===undefined){b=0}this.m_drawFlags&=~b};a.prototype.SetSprite=function(b){this.m_ctx=b};a.prototype.GetSprite=function(){return this.m_ctx};a.prototype.SetDrawScale=function(b){if(b===undefined){b=0}this.m_drawScale=b};a.prototype.GetDrawScale=function(){return this.m_drawScale};a.prototype.SetLineThickness=function(b){if(b===undefined){b=0}this.m_lineThickness=b;this.m_ctx.strokeWidth=b};a.prototype.GetLineThickness=function(){return this.m_lineThickness};a.prototype.SetXFormScale=function(b){if(b===undefined){b=0}this.m_xformScale=b};a.prototype.GetXFormScale=function(){return this.m_xformScale};a.prototype.DrawPolygon=function(c,f,b){if(!f){return}var g=this.m_drawScale;var e=new Path();for(var d=0;d<f;d++){e.add(new Point(c[d].x*g,c[d].y*g))}e.fillColor=null;e.strokeColor=b;e.closed=true};a.prototype.DrawSolidPolygon=function(c,f,b){if(!f){return}var g=this.m_drawScale;var e=new Path();for(var d=0;d<f;d++){e.add(new Point(c[d].x*g,c[d].y*g))}e.fillColor=b;e.strokeColor=b;e.closed=true};a.prototype.DrawCircle=function(c,b,d){if(!b){return}var f=this.m_drawScale;var e=new Path.Circle(new Point(c.x*f,c.y*f),b);e.strokeColor=d;e.fillColor=null};a.prototype.DrawSolidCircle=function(c,b,f,d){if(!b){return}var g=this.m_drawScale;var e=new Path.Circle(new Point(c.x*g,c.y*g),b);e.strokeColor=d;e.fillColor=d};a.prototype.DrawSegment=function(f,e,b){var d=this.m_drawScale;var c=new Path.Line(new Point(f.x*d,f.y*d),new Point(e.x*d,e.y*d));c.strokeColor=b;c.fillColor=null};a.prototype.DrawTransform=function(b){var c=this.m_drawScale}})();var i;for(i=0;i<Box2D.postDefs.length;++i){Box2D.postDefs[i]()}delete Box2D.postDefs;